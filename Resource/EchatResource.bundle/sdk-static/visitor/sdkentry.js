!function(e){function t(t){for(var o,a,s=t[0],l=t[1],c=t[2],u=0,f=[];u<s.length;u++)a=s[u],Object.prototype.hasOwnProperty.call(i,a)&&i[a]&&f.push(i[a][0]),i[a]=0;for(o in l)Object.prototype.hasOwnProperty.call(l,o)&&(e[o]=l[o]);for(d&&d(t);f.length;)f.shift()();return r.push.apply(r,c||[]),n()}function n(){for(var e,t=0;t<r.length;t++){for(var n=r[t],o=!0,a=1;a<n.length;a++){var l=n[a];0!==i[l]&&(o=!1)}o&&(r.splice(t--,1),e=s(s.s=n[0]))}return e}var o={},a={3:0},i={3:0},r=[];function s(t){if(o[t])return o[t].exports;var n=o[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.e=function(e){var t=[];a[e]?t.push(a[e]):0!==a[e]&&{1:1}[e]&&t.push(a[e]=new Promise((function(t,n){for(var o=({1:"emoji"}[e]||e)+".css",i=s.p+o,r=document.getElementsByTagName("link"),l=0;l<r.length;l++){var c=(d=r[l]).getAttribute("data-href")||d.getAttribute("href");if("stylesheet"===d.rel&&(c===o||c===i))return t()}var u=document.getElementsByTagName("style");for(l=0;l<u.length;l++){var d;if((c=(d=u[l]).getAttribute("data-href"))===o||c===i)return t()}var f=document.createElement("link");f.rel="stylesheet",f.type="text/css",f.onload=t,f.onerror=function(t){var o=t&&t.target&&t.target.src||i,r=new Error("Loading CSS chunk "+e+" failed.\n("+o+")");r.code="CSS_CHUNK_LOAD_FAILED",r.request=o,delete a[e],f.parentNode.removeChild(f),n(r)},f.href=i,document.getElementsByTagName("head")[0].appendChild(f)})).then((function(){a[e]=0})));var n=i[e];if(0!==n)if(n)t.push(n[2]);else{var o=new Promise((function(t,o){n=i[e]=[t,o]}));t.push(n[2]=o);var r,l=document.createElement("script");l.charset="utf-8",l.timeout=120,s.nc&&l.setAttribute("nonce",s.nc),l.src=function(e){return s.p+""+({1:"emoji"}[e]||e)+".chunk.js"}(e);var c=new Error;r=function(t){l.onerror=l.onload=null,clearTimeout(u);var n=i[e];if(0!==n){if(n){var o=t&&("load"===t.type?"missing":t.type),a=t&&t.target&&t.target.src;c.message="Loading chunk "+e+" failed.\n("+o+": "+a+")",c.name="ChunkLoadError",c.type=o,c.request=a,n[1](c)}i[e]=void 0}};var u=setTimeout((function(){r({type:"timeout",target:l})}),12e4);l.onerror=l.onload=r,document.head.appendChild(l)}return Promise.all(t)},s.m=e,s.c=o,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)s.d(n,o,function(t){return e[t]}.bind(null,o));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="../",s.oe=function(e){throw console.error(e),e};var l=window.webpackJsonp=window.webpackJsonp||[],c=l.push.bind(l);l.push=t,l=l.slice();for(var u=0;u<l.length;u++)t(l[u]);var d=c;r.push([202,0,4]),n()}({104:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.checkBlockSendQuestionOld=C,t.default=void 0,t.getAnswerItem=w,t.handleMsgRobotPre=k,t.isCurrentRobot=I,t.unBlockSendQuestionOld=x,n(26),n(63),n(69),n(3),n(71),n(87),n(50),n(22),n(11),n(10);var o=f(n(4)),a=f(n(8)),i=n(16),r=f(n(105)),s=f(n(108)),l=f(n(72)),c=f(n(55)),u=f(n(106)),d=n(107);function f(e){return e&&e.__esModule?e:{default:e}}var p,h,m,g,v,y=!1,b=null;function S(){var e=a.default.getStatusData();return 2==e.chatStatus&&e.talkType==o.default.Constants.talkTypeRobot}function T(){o.default.publish("changeDom",{name:"#inputSuggest",cls:"hide",html:" "})}function w(e){return e.mixedMessage?e.mixedMessage:e.knowledgeAnswerList?e.knowledgeAnswerList[0]:void 0}function k(e){if(1!=e.isForward||207==e.result)return I(e)}function I(e){var t=a.default.getStatusData();if(2==t.chatStatus&&t.talkType==o.default.Constants.talkTypeRobot&&e.talkId==t.talkId)return!0}function C(){return y}function x(){b&&clearTimeout(b),y=!1}m=function(){var e,t,n,o=a.default.getMsgList(),i=a.default.getStatusData().talkId;for(n=o.length-1;n>=0;n--)if(t=(e=o[n]).data.mt,e.data.talkId==i)12001==t&&c.default.updateMsg(e);else if(e.data.talkId&&e.data.talkId!=i)break},v=function(e){a.default.setConfigs({enableStreamingRendering:"1"==e.enableStreamingRendering,hasInputAssociation:"1"==e.enableInputAssociate}),$("#inputLengthTip").html(lanRes.inputLengthTip1+Math.min(a.default.getConfig("inputMaxLength"),a.default.getConfig("maxRobotLength"))+lanRes.inputLengthTip2),o.default.publish("clearSendingMsg","robot"),o.default.queryParams.autoPop&&delete o.default.queryParams.autoPop,o.default.queryParams.autoChat&&delete o.default.queryParams.autoChat,g&&g(),o.default.unSubscribe("_sendQuestion"),o.default.subscribe("_sendQuestion",(function(e,t){if((0,d.isStreamGenerating)(!0)||C())return!1;var n={et:130,docId:t.docId,originDocId:t.originDocId,content:t.content};(0,s.default)(n),T()})),o.default.publish("__setTitle",a.default.getRobotInfo().name)},g=function(){g=null;function e(e,t){var n=function(e,t){var n=(0,i.getMsgByDom)(e);if(n){var o=n.allExtra.h5Extra||{},a=o.feedback,r=o.feedbackSubitem;if(!(t&&r||!t&&a))return n}}(e,t);if(n&&2==a.default.getStatusByKey("chatStatus")&&a.default.getStatusByKey("talkType")==o.default.Constants.talkTypeRobot&&n.talkId==a.default.getStatusByKey("talkId")){var r=w(n),s=$(e).parents(".robot-feedback"),c=$(e).attr("type")||void 0,u=t?$(e).text():void 0,d=r.docId,f=r.queryId,p=r.robotDetailId,h=r.searchId,m=r.originQuestion;o.default.publish("sendMessage",{et:133,feedBack:c,feedBackSubitem:u,docId:d,queryId:f,robotDetailId:p,searchId:h,originQuestion:m}),o.default.publish("setExtraMessage",n,{feedback:c,feedbackSubitem:u}),t?(s.addClass("robot-feedback-sub-had"),$(e.parentNode).addClass("feedback-sub-sel"+c)):(s.addClass("robot-feedback-had robot-feedback-had"+c),$(e).addClass("feedback-btn-"+(1==c?"solve":"unsolve")+"-sel")),l.default.scrollToElement($(e).parents(".msgli").attr("id"))}}$("#list_msg").on("tap",".common-ques-li",(function(e){o.default.publish("_sendQuestion",{docId:$(this).attr("did"),content:unescape($(this).attr("ques"))})})),$("#robotToStaffWord").on("tap",(function(){S()&&o.default.publish("sendMessage",{et:131}),r.default.input.inputBlur()})),$("#inputSuggest").on("tap",".ipt-list-li",(function(e){if(!(0,i.handleNetwork)()&&(r.default.input.setInput(unescape($(this).attr("ques"))),S())){o.default.publish("_sendQuestion",{docId:$(this).attr("did"),content:unescape($(this).attr("ques"))});r.default.input.getInput(!0)}})),$("#list_msg").on("tap",".question-list-li",(function(e){var t=(0,i.getMsgByDom)(this);if(t){var n=w(t),a=n.docId,r=n.relateKnowledges&&n.relateKnowledges.length?n.relateKnowledges:n.suggestions,s=$(this).attr("index"),l=r[parseInt(s)];o.default.publish("_sendQuestion",{docId:l.docId,originDocId:a,content:l.question})}})),$("#list_his").on("tap",".feedback-btn-unsolve",(function(t){e(this)})).on("tap",".feedback-btn-solve",(function(t){e(this)})).on("tap",".feedback-sub-content",(function(t){e(this,!0)}))},h=function(){var e;return o.default.subscribe("__visitorSendMsg",T),function(){var t=r.default.input.getInput(!1);t||T(),!t||p==t&&e==t||(p=t,(0,s.default)({et:132,content:p})),e=t}},o.default.subscribe("sendRobotQuestion",(function(e,t){(0,d.checkEnableStreamInput)()||(y=!0,b&&clearTimeout(b),b=setTimeout(x,3e3))})),o.default.subscribe("getMsgRobot",(function(e,t){if(k(t)){var n,i,r,s,l,c,f,h,m,g,v=t.knowledgeAnswerList||[],y="",b=!1,S=0;if(4!=t.type)return 3==t.type?((0,d.checkEnableStreamInput)()?(0,d.removeFakeAnswer)(t):x(),void(204==t.result||205==t.result?(a.default.setVisitorInfo({robotToHumanKey:t.robotToHumanKey}),o.default.triggerEventOnPoint("registChat",{robotToHumanKey:t.robotToHumanKey})):207==t.result&&o.default.publish("changeDom",{name:"#robotToStaff",removeCls:"hide"}))):void 0;if(!u.default.getInput(!1))return;for(r=t.segWords,l=0;l<v.length;l++){if(i=(n=v[l]).question,b=!1,i==p){l++,S=1,y='<div class="ipt-list"><a class="ipt-list-li" did="'+n.docId+'" ques="'+escape(n.question)+'"><b class="words-seg">'+i+"</b></a>";break}if(r)for(0,c=0;c<r.length;c++)s=r[c],s=o.default.escapeRegExp(s),i=i.replace(new RegExp(s,"igm"),(function(e,t){if(b=!0,!((h=arguments[(f=arguments.length)-2])>0))return'<b class="words-seg">'+e+"</b>";if(m=arguments[f-1].substring(0,h),g=arguments[f-1].substring(h),s.match(/^s|sp|spa|span$/)&&m.match(/<$/))return e;if(s.match(/^n|an|pan|span$/)){var n="</span>".replace(s,",").split(",");if(m.match(new RegExp(n[0])&&g.match(n[1])))return e}return/(\<span[^>]*>([^<]+(?!\<\/span\>))?$)|(\<[a-zA-Z]+[^>]*$)/gi.test(m)?e:'<b class="words-seg">'+e+"</b>"}));b&&(S++,y+='<a class="ipt-list-li" did="'+n.docId+'" ques="'+escape(n.question)+'">'+i+"</a>")}S>0?o.default.publish("changeDom",{name:"#inputSuggest",removeCls:"hide",html:y+"</ul>"}):o.default.publish("changeDom",{name:"#inputSuggest",cls:"hide",html:" "})}}));t.default={init:function(e){var t=!1;e.subscribe("startRobot",(function(){e.unSubscribe("textInputChangeEvt"),a.default.getConfig("enableInputAssociate")&&e.subscribe("textInputChangeEvt",(0,i.debounce)(h(),1200)),a.default.getConfig("enableStreamingRendering")&&e.subscribe("textInputChangeEvt",(0,i.debounce)(h(),1200)),v(a.default.getConfig("config649")),t||(t=!0,2==a.default.getStatusData().fisrtChatstatus&&m()),a.default.setStatusByKey("statusName","robot"),o.default.publish("__chatStatus","robot")})),e.subscribe("endRobot",(function(){o.default.unSubscribe("_sendQuestion"),(0,d.isStreamGenerating)()&&(0,d.stopSessionEndGenerate)(),a.default.getStatusData().talkType==o.default.Constants.talkTypeRobot&&($(".robot-feedback").each((function(e,t){$(t).hasClass("robot-feedback-had")?$(t).hasClass("robot-feedback-sub-had")||($(".feedback-sub-solved",t).remove(),$(".feedback-sub-unsolved",t).remove()):$(t).remove()})),l.default.refreshChatScroll())}))}}},105:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(26),n(44),n(15),n(3),n(11),n(21),n(30),n(31),n(10);var o=p(n(106)),a=p(n(262)),i=p(n(137)),r=p(n(72)),s=p(n(265)),l=p(n(181)),c=p(n(8)),u=p(n(42)),d=p(n(4)),f=n(16);function p(e){return e&&e.__esModule?e:{default:e}}var h=i.default.checkMenuNums,m=u.default.callEchatNative,g={networkDisconnected:1,innerADWrap:1,footer:{name:"#footer",bottom:0},inputSuggest:1,robotToStaff:1,busyTipLine:1,urlSetList:1,chatText:1,pre_his:1},v={removeCls:function(e,t){e&&(d.default.isArray(e)||(e=[e]),e&&e.length&&e.forEach((function(e){t.removeClass(e)})))},cls:function(e,t){t.addClass(e)},attr:function(e,t){for(var n in e)t.attr(n,e[n])},isHtml:function(e,t,n){"#textInput"==n.name&&e&&2!=o.default.editorType&&o.default.changeToIframe&&o.default.changeToIframe()},html:function(e,t){t.html(e)}},y=(0,f.throttle)((function(){var e=window.getComputedStyle(_$("footer")),t=_$("footer").clientHeight,n=parseInt(e.getPropertyValue("margin-bottom")||0),o="number"==typeof g.footer.bottom?g.footer.bottom:parseInt(e.getPropertyValue("bottom")||0),a=$("#innerADWrap").height()||0+$("#networkDisconnected").height()||0,i=r.default.chatScroll,s=i.y==i.maxScrollY;$("#container").css("padding-bottom",t+n+o+"px"),$("#content").css("height",a?"calc(100% - "+a+"px)":"100%"),i&&(i.refresh(),(i.y<i.maxScrollY||s)&&i.scrollTo(0,i.maxScrollY))}),100);function b(e){var t=!1;e.forEach((function(e){if(e.name){var n,o=$(e.name);if(e.config&&e.config(e),o.length){for(n in e)v[n]&&v[n](e[n],o,e);g[e.name.replace("#","")]&&(t=!0)}}})),t&&y()}function S(e){b(c.default.getDataByName("doms")[e])}function T(){setTimeout((function(){var e=$("#loading");!e.length||e.hasClass("fading")||e.hasClass("limit-hide")||(d.default.publish("removeLoading"),(0,f.wsStoped)()&&(0,f.confirmOpenWs)())}),5e3)}d.default.subscribe("showToast",(function(e,t){var n=t.type,o=t.content;d.default.showToast(o,n)})),d.default.subscribe("changeDom",(function(e,t){t&&("#footer"==t.name&&("number"==typeof t.bottom&&(g.footer.bottom=t.bottom||0),"number"==typeof t.scrollTime&&r.default.scrollToBottom(t.scrollTime)),d.default.isArray(t)||(t=[t]),b(t))})),d.default.subscribe("removeLoading",(function(e,t){d.default.unSubscribe("removeLoading"),d.default.publish("changeDom",{name:"#loading",cls:"fading"}),setTimeout((function(e){d.default.publish("changeDom",{name:"#loading",removeCls:"fading",cls:"limit-hide"})}),500)}));t.default={input:o.default,footer:a.default,scroll:r.default,checkTimeoutLoading:T,init:function(){function e(e,t){S("staff")}s.default.init(),o.default.init(i.default),a.default.init(o.default),r.default.init(),l.default.init(),T(),function(){var e=_$("textInput");function t(n){n.target!=e&&(e.blur(),document.removeEventListener("touchend",t,!1))}$("#textInput").on("focus",(function(){console.log("focus"),o.default.inputFocus=!0,i.default.hideMenus(),r.default.scrollToBottom(500),document.addEventListener("touchend",t,!1)})).on("blur",(function(e){console.log("blur",o.default.inputFocus),o.default.inputFocus&&(o.default.inputFocus=!1,_$("footer").style.marginBottom="0px",document.body.scrollTop=0,d.default.publish("changeDom",{name:"#footer",bottom:0}))})).on("touchstart touchmove touchend",(function(e){e.stopPropagation()})),window.addEventListener("resize",(function(){r.default.scrollToBottom(500)}))}(),setTimeout((function(){n.e(1).then(function(){n(275).default(),$(".emoji").on("click",(function(e){var t=$(this).attr("code"),n=o.default.getInput().length+t.length+4,a=c.default.getConfig("inputMaxLength");a&&n>a||(o.default.insertImg(t),e.stopPropagation(),e.preventDefault())}))}.bind(null,n)).catch(n.oe)}),100),S("reset"),h(),d.default.subscribe("setTheme",(function(e,t){var n,o=c.default.getChatbox(),a={toolEmoji:".menu-emo",toolFile:".menu-file",toolSatisfaction:".menu-satisfy",toolScreenshot:".menu-capture",toolTelephone:".menu-phone",toolLog:".menu-log",toolCamera:".menu-camera",toolLocation:".menu-map",toolVoice:".record-switch"};for(n in a){var i=c.default.getVisitorInfo();"toolLog"===n&&1==i.isLogExist&&i.interfaceVersion>=6&&!Number(o[n])?$(a[n]).addClass("style-tool-hide"):Number(o[n])?$(a[n]).removeClass("style-tool-hide"):$(a[n]).addClass("style-tool-hide")}h()})),d.default.subscribe("startLeave",(function(e){S("leave")})),d.default.subscribe("startQueue",(function(t,n){setTimeout((function(){c.default.getConfig("busyCanSend")?e():S("queue"),$(".menu-satisfy").addClass("hide")}),10)})),d.default.subscribe("startChat",e),d.default.subscribe("updateChatStaffInfo",(function(){var e=c.default.getStaff();e&&e.phone?($(".menu-phone-a").attr("href","tel:"+e.phone),$(".menu-phone").removeClass("hide")):$(".menu-phone").addClass("hide"),$(".sa-avatar").html('<img src="'+e.img+'" onerror="this.src=\'../common/img/staff.jpg\'"/>'),d.default.publish("__setTitle",c.default.getStaff().name)})),d.default.subscribe("startRobot",(function(e,t){S("robot")})),d.default.subscribe("chatEnded",(function(e,t){S("reset"),i.default.hideMenus(),h();try{c.default.getVisitorInfo("interfaceVersion")>=6&&m("callEchatNative","")}catch(e){}l.default.reset()})),d.default.subscribe("enterUnread",(function(e,t){S("unread")})),d.default.subscribe("leaveDisabled",(function(e,t){if(t){$("#mask").css({display:"block"}),$("#leaveDisabled").html('<div class="leave-disabled-tip" id="leavedisabledTip"><div class="leave-disabled-scroll">'+(t.disableTips||lanRes.vis_42)+"</div></div>").show(),d.default.publish("__setTitle","");var n=window.innerHeight||document.body.clientHeight;.8*n<$(".leave-disabled-tip").height()+90&&($("#leaveDisabled").css({height:.8*n-90+"px"}),$(".leave-disabled-tip").css({height:.8*n-90+"px",position:"relative",overflow:"hidden"}),r.default.leaveDisabledScroll||(r.default.leaveDisabledScroll=r.default.initScroll("leaveDisabledScroll","leavedisabledTip")),setTimeout((function(){r.default.leaveDisabledScroll.refresh()}),600))}}))}}},106:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(3),n(11),n(10),n(255);var o=l(n(256)),a=l(n(8)),i=l(n(4)),r=n(107),s=n(104);function l(e){return e&&e.__esModule?e:{default:e}}var c,u,d="textInput",f=window.innerHeight;function p(e){var t=_$("fakeInput"),n=_$(d),o=_$(d).clientHeight,a=t.clientHeight;parseInt(n.style.height)>90&&a>92||(a>92?a=93:a<33&&(a=33),n.style.height=a+"px",n.setAttribute("height",a),n.style.width="auto",n=t=null,(o-a>3||o-a<-3)&&i.default.publish("changeDom",{name:"#footer"}))}c=new function(){var e=this;o.default.call(this);var t=this,n=this.textInputChange;t.SENDCTRL=!1,t.plainText=!0,t.editorType=1,t.isMobile=!0,t.textRange=null,t.inputFocus=!1,this.init=function(o){e.Menu=o,t.bindPlainTextEvent(),$("#"+d).on("propertychange change input paste drop",(function(e){setTimeout(n,20)})),$("#enter_btn").on("touchend",(function(e){(0,r.isStreamGenerating)(!1)?(0,r.stopGenerateStream)():(0,s.checkBlockSendQuestionOld)()||t.sendMsg({from:"enter"}),e.stopPropagation(),e.preventDefault()})).on("touchstart",(function(e){e.stopPropagation(),e.preventDefault()})).on("click",(function(e){e.stopPropagation(),e.preventDefault()}))},this.setInput=function(e){e&&(e=e.replace(/<img[^>]+code="([^"]+)"[^>]*>/gi,"[#$1#]").replace(/<(?!br|\/br)(?:.|\s)*?>/gi,"").replace(/&nbsp;/gi," ").replace(/^((<\/?br\/?>)|[\r\n\s]+)+|((<\/?br\/?>)|[\r\n\s]+)+$/gi,""),$("#"+d).val(e))},this.getInput=function(e){var n=$("#"+d).val();return n?(e&&$("#"+d).val(""),t.filterPasteData(n,!0)):(n.length>5e3&&(n=n.substring(0,5e3)),n)},this.inputBlur=function(e,n){n&&_$("sa_advise").blur(),!0!==t.inputFocus||e&&e.target&&"textInput"==e.target.id||(_$("textInput").blur(),setTimeout((function(){_$("textInput").blur(),window.scrollTo(0,0)}),10),window.blur())},this.bindPlainTextEvent=function(e){$("#"+d).off("keydown").on("keydown",(function(e){var o,a,i,r,s,l=e||window.event,c=l.keyCode||l.which||l.charCode||0;if(13==c&&void 0!==t.SENDCTRL&&t.SENDCTRL==!!l.ctrlKey)return t.sendMsg({from:"input"}),l.preventDefault&&l.preventDefault(),!1;8==c&&(a=(o=_$(d)).value,o.createTextRange?console.log("手机端IE?"):(i=o.selectionStart,r=-1,s=0,i>0&&a.replace(/\[#([^#]+)#\]/g,(function(e,t,n,o){return n<i&&n+e.length>=i&&(r=n,s=n+e.length),e})),-1!=r&&o.setSelectionRange(r,s))),t.getPos(),setTimeout(n,50)})).on("change input",(function(){t.getPos()})).on("paste",(function(e){return t.filterPasteText(e,void 0,window,document)})).on("drop",t.getPos).on("focus",t.getPos),setTimeout((function(){_$(d)&&_$(d).scrollIntoView()}),400),t.textRange=null},this.getPos=function(e){var n,o,a=_$(d);if(window.getSelection){o=window.getSelection();try{n=o.getRangeAt(0)}catch(e){(n=document.createRange()).selectNodeContents(a),n.collapse(!0)}}else n=document.selection.createRange();return t.textRange=n,n},this.lastSelectionStart=-1,this.lastSelectionEnd=-1,this.initLastSelecttion=function(){try{var e=_$(d);this.lastSelectionStart=e.selectionStart,this.lastSelectionEnd=e.selectionEnd}catch(e){this.lastSelectionStart=this.lastSelectionEnd=-1}},this.insertImg=function(t){var o=a.default.getDataByName("emoCodeTolan"),i=_$(d),r=i.value,s=!1,l="[#"+o[t]+"#]",c=i.selectionStart,u=i.selectionEnd;console.log("insertImg",e.lastSelectionStart,e.lastSelectionEnd),-1!=e.lastSelectionStart&&(c=e.lastSelectionStart,u=e.lastSelectionEnd),console.log(c,u),!c&&0!==c||!u&&0!==u?(i.value+=l,i.innerHTML+=l,s=!0):(c==i.value.length&&(s=!0),i.value=r.substring(0,c)+l+r.substring(u),e.lastSelectionStart=e.lastSelectionEnd=c+l.length),s&&setTimeout((function(e){var t=_$(d);t.scrollTop=t.scrollHeight,t.scrollTo(0,t.scrollHeight),i=null})),n({from:"insertImg"}),i=null}},i.default.subscribe("textInputChangeEvt",(function(){var e=_$(d),t=_$("fakeInput"),n=e.value;t.innerText=n||" ",setTimeout(p,10),function(e){e=e||_$(d);var t=$("#menu_more"),n=$("#enter_btn");e.value?(n.removeClass("hide"),t.addClass("hide")):(n.addClass("hide"),t.removeClass("hide"))}(e)})),i.default.subscribe("keyboardHeight",(function(e,t){var n,o,a=window.innerHeight+t-f;t,c.inputFocus&&(a<3&&a>-3||window.innerHeight==_$("footer").getBoundingClientRect().bottom?window.scrollTo(0,f):(u&&clearTimeout(u),u=setTimeout((function(){u=null;var e=_$("footer").getBoundingClientRect().bottom;if(window.innerHeight==e)return console.log(f,t,window.innerHeight,"**innerHeight change"),void window.scrollTo(0,f);n=parseInt(window.getComputedStyle(_$("footer")).getPropertyValue("margin-bottom"))||0,((o=t-f+e+n)<3&&o>-3||window.innerHeight==e)&&(o=0),console.log(f,e,t,n,"**500ms**",window.innerHeight,o),c.inputFocus&&(_$("footer").style.marginBottom=o+"px"),i.default.publish("changeDom",{name:"#footer",bottom:0})}),600)))})),i.default.subscribe("inputBlur",(function(e,t){c.inputBlur()}));t.default=c},107:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.checkEnableStreamInput=m,t.checkNeedTyping=function(e,t){if(!(0,c.isCurrentRobot)(e))return!1;var n=P(t);if(2!=n.status&&!n.endReason)return!0;return!1},t.default=void 0,t.fakeTypewriter=function(e,t){var n,a=t.id,i=t.str,r=t.wrap,l=t.listHtml||"",u=t.feedback||"";if(0===e.isForward&&!m()&&(0,c.unBlockSendQuestionOld)(),n=(0,s.filterTextMsg)(i),0!==e.isForward||!m())return r.replace("${content}",n+l)+u;if(k(e))return"";if(!i)return r.replace("${content}",l)+u;return b={id:a},setTimeout((function(){if(b.id!=a)return u&&$(_$("typed"+a).parentNode.parentNode).append(u),void(_$("typed"+a).parentNode.innerHTML=n+l);var t=new o.default("#typed"+a,{strings:[""],delay:30,autoStart:!1,pauseFor:10,loop:!1,onCreateTextNode:function(e,t){return x(a),t}});p.sum++,p[a]={id:a,html:6==e.type?n:void 0,typewriter:t},t.typeString(n).start().callFunction((function(){if(p[a]){delete p[a],p.sum--,p.sum<1&&(p.sum=0,!d&&!f&&I(!0));var e=_$("typed"+a).parentNode;l&&$(e).append(l),$(".Typewriter__cursor",e).hide(),u&&$(e.parentNode).append(u),setTimeout((function(){x(a)}))}else console.log("callFunction")})).start().stop(),I(!1)}),15),r.replace("${content}",'<div id="typed'+a+'" class="stream-msg-typed stream-msg-fake"></div>')},t.getH5DataList=B,t.getStreamData=P,t.getStreamTempData=N,t.isStreamGenerating=E,t.mergeFakeAnswer=k,t.removeFakeAnswer=w,t.stopGenerateStream=M,t.stopSessionEndGenerate=function(){if(!m())return;if(d){if(d.typewriter){d.typewriter.stop();var e=_$(d.typedSelector).parentNode;$(".Typewriter__cursor",e).hide()}C(d),setTimeout((function(){x()}))}D(),w(),$(".stream-msg-stop").remove(),I(!0)},n(54),n(35),n(19),n(15),n(3),n(11),n(21),n(180),n(10);var o=u(n(260)),a=u(n(4)),i=u(n(8)),r=n(16),s=n(178),l=u(n(55)),c=n(104);function u(e){return e&&e.__esModule?e:{default:e}}var d=null,f=null,p={sum:0},h={};function m(){return i.default.getConfig("enableStreamingRendering")}function g(e){return e.reduce((function(e,t){return e+t.content}),"")}function v(e){return'<img  src="'+e.picUrl+'"/>'}function y(){for(var e,t,n,o,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],i=[],r=[],s=0;s<a.length;s++)"string"==typeof(e=a[s])&&(e=JSON.parse(e)),o=e.answerMedia,t=e.result,n="",0==o?n=g([t]):(r.length&&(n=g(r),r=[],n&&i.push(n)),n=1===o?v(t):"<span>媒体类型"+o+",内容"+(t.fileUrl||t.content||t.articleCount)+"</span>"),n&&i.push(n);return r.length&&(i.push(g(r,end)),r=void 0),i}var b={};var S=null;function T(e){console.log("-------initGenerateStream",e),$("#tempRobotStream").remove(),f=!0,l.default.showMsg({mt:50,id:"tempRobotStream",mid:"tempRobotStream",content:'<div class="circle-item-wrap circle-item-inmsg"><i class="circle-item circle-1"></i><i class="circle-item circle-2"></i><i class="circle-item circle-3"></i></div>'}),I(!1),S&&clearTimeout(S),S=setTimeout((function(){w({from:"timeout"})}),5e3)}function w(e){console.log("-------removeFakeAnswer",e),S&&clearTimeout(S),f=!1,$("#tempRobotStream").length&&($("#tempRobotStream").remove(),!d&&p.sum<1&&I(!0),x())}function k(e){if(!_$("tempRobotStream"))return!1;f=!1;var t=(0,r.getMsgDomId)(e);return $("#tempRobotStream").attr("id",t),l.default.updateMsg(e),x(t),!d&&p.sum<1&&I(!0),!0}function I(e,t){d=e?null:t||d,e?$("#enter_btn").removeClass("stream-enter-stop").removeClass("color0"):$("#enter_btn").addClass("stream-enter-stop").addClass("color0")}function C(e){var t=_$(e.streamId);$(".circle-item-inmsg",t).remove(),$(".stream-msg-stop",t).remove(),I(!0)}function x(e,t){var n=l.default.checkNeedScrollToBottom(t);l.default.switchScrollToBottom(n)}function E(e){if(m()){var t=!!d||p.sum>0||f;return t&&e&&a.default.showTip(lanRes.blockAnswer),t}}function D(){if(d||f||I(!0),p.sum){for(var e in $(".circle-item-inmsg").remove(),p)if("sum"!=e){p[e].typewriter.stop();var t=_$("typed"+p[e].id).parentNode;$(".Typewriter__cursor",t).hide(),p[e].html&&(_$("typed"+p[e].id).innerHTML=p[e].html)}p.sum=0,setTimeout((function(){x()}))}}function M(){if(console.log("-----中止生成答案---135"),D(),d){var e=d.msg;a.default.publish("sendMessage",{et:135,searchId:e.searchId,talkId:e.talkId,answerDetailId:e.answerDetailId},(function(e){e.successful}))}}function _(e){return y(e)}function P(e){var t=e.robotDetailList||[],n=e.allExtra.h5Extra||{},o=n.robotDetailList||[],a=e.status||n.status||0,i=e.endReason||n.endReason;return{robotDetailList:t.concat(o),status:a,endReason:i}}function N(e,t){var n=(0,r.getMsgDomId)(e);return{streamId:"stream"+n,domSelector:"dom"+n,typedSelector:"typed"+n,msg:e,extraOption:t,fromHis:i.default.getMsgFromHistory(e.allExtra.echatId).originData.fromHis,domId:n}}function B(e,t){var n=(e.allExtra.h5Extra||{}).robotDetailList||[];if(!n.length)return n.push(t),n;var o=n[n.length-1];return 0==o.answerMedia&&0==t.answerMedia&&(o.result.content+=t.result.content),n}function O(e){var t=e.answerDetailId;var n=i.default.getApiDomain(),o=i.default.getVisitorInfo(),r=o.companyId,s=o.visitorId;$.ajax({url:n+"/rsa/query",type:"post",data:{talkId:e.talkId,answerDetailId:t,companyId:r,visitorId:s},contentType:"application/x-www-form-urlencoded; charset=UTF-8",success:function(e){if("string"==typeof e&&e.length>4)try{e=JSON.parse(e)}catch(e){}e.successful?function(e){if(2==e.status)if(h[t]){a.default.publish("setExtraMessage",h[t].msg,{status:2,endReason:e.endReason,robotDetailList:e.dataList||[]});var n=i.default.getMsgFromHistory(h[t].msg.allExtra.echatId).msg;l.default.updateMsg(n),x(),C(h[t].msg)}else console.log("ajax 12004 回来没有找到数据",e)}(e.result):console.log("12004 接口获取全量消息失败")},error:function(e,t,n){console.log("ajax rsa/query error")}})}a.default.subscribe("getMsgRobotStream",(function(e,t,n){if(m()&&(a.default.publish("changeDom",{name:"#inputSuggest",cls:"hide",html:" "}),2!=P(t).status)){var o=N(t,n);h[t.answerDetailId]=o,I(!1,o),o.fromHis&&O(t)}})),a.default.subscribe("getMsgStreamInput",(function(e,t){if(m()){var n=t.answerDetailId;if(h[n]&&!h[n].fromHis){var i,r=h[n].msg,s=t.info,c=B(r,s);a.default.publish("setExtraMessage",r,{robotDetailList:c,status:1}),h[n].typewriter||(i=h[n],$(".circle-item-inmsg",_$(i.streamId)).remove(),h[n].typewriter=new o.default("#"+h[n].typedSelector,{strings:[""],delay:0,autoStart:!0,pauseFor:10,loop:!1,onCreateTextNode:function(e,n){return x(0,t),n}}));var u=l.default.checkNeedScrollToBottom(t),d=_([s]).join("");console.log("--------输入新数据",d,"-------------"),h[n].typewriter.typeString(d).start(),l.default.switchScrollToBottom(u)}}})),a.default.subscribe("getRobotStreamEnd",(function(e,t){if(m()){var n=t.answerDetailId;if(h[n]){if(!h[n].msg.endReason)if(h[n].fromHis)O(h[n].msg);else{var o,i,r=t.endReason||t.finishReason,l=h[n].msg;l.endReason=r,a.default.publish("setExtraMessage",l,{status:2,endReason:r}),"1"==r?(o=h[n],i=_$(o.streamId),$(i).append('<div class="stream-msg-error"></div>')):"2"==r&&function(e){var t=_$(e.streamId);$(t).append('<div class="stream-msg-interrupt"></div>')}(h[n]),h[n].typewriter?h[n].typewriter.callFunction((function(){var e,t=_(P(l).robotDetailList).join(""),o=(0,s.filterTextMsg)(t),a=h[n].extraOption.listHtml;0==r&&h[n].extraOption&&(e=h[n].extraOption.feedback),o!=t?_$(h[n].typedSelector).innerHTML=o:$(".Typewriter__cursor",_$(h[n].typedSelector)).hide(),a&&$(_$(h[n].streamId)).append(e),e&&$(_$(h[n].streamId).parentNode).append(e),C(l),setTimeout((function(){x()}))})).start().stop():C(l)}}else console.log("本地12004无此消息 出错",t)}})),a.default.subscribe("backViewInRobot",(function(e,t){var n,o;for(o in h)(n=h[o].msg).talkId==t.talkId&&2!=n.status&&(h[o].fromHis=!0,O(n))})),$("#content").on("touchend",".stream-msg-stop",(function(){M()})),a.default.subscribe("sendRobotQuestion",(function(e,t){m()&&(E()||T(t))}));t.default={streamListToHtml:y,getStreamContent:_}},108:function(e,t,n){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}n(25),n(33),n(39),n(60),n(51),n(34),n(61),n(44),n(52),n(62),n(19),n(15),n(40),n(21),n(53),n(30),n(31),n(41),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,t.removeToResend=m,n(3),n(11),n(10);var a=u(n(4)),i=u(n(45)),r=u(n(8)),s=u(n(16)),l=u(n(55)),c=["sendStatus"];function u(e){return e&&e.__esModule?e:{default:e}}function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function f(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=o(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!=o(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==o(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var p={tipErrorTime:3,errorTimes:0};function h(e){if(!e)return p.errorTimes=0,void a.default.publish("changeNetWsStatus",!0);p.errorTimes++,p.errorTimes>=p.tipErrorTime&&a.default.publish("changeNetWsStatus",!1)}function m(e){var t,n=_$(s.default.getMsgDomId(e));r.default.updateMsgList(e,"remove"),(t=n.previousElementSibling)&&t.childNodes[0]&&-1!=(t.childNodes[0].className+"").indexOf("color1")&&$(t).remove(),$(n).remove()}function g(e,t,n){var o,s=(new Date).getTime(),u=e.sendStatus==i.default.sendStatus.error,d=e.id||"msg"+s;if(e.id=d,e.tm=e.tm||s,e.data.bridgeMsgId||(e.bridgeMsgId=e.data.bridgeMsgId=r.default.getNextBridgeMsgId()),e.data.isResend=u?1:0,e.sendStatus=e.data.sendStatus=i.default.sendStatus.sending,e.hide||(u&&m(e),r.default.updateMsgList(e,"push"),l.default.showMsg($.extend(e,e.data))),!t){o=e.bridgeMsgId,p[o]&&(p[o].timer&&clearTimeout(p[o].timer),delete p[o]);var f=e.data,g=(f.sendStatus,function(e,t){if(null==e)return{};var n,o,a=function(e,t){if(null==e)return{};var n={};for(var o in e)if({}.hasOwnProperty.call(e,o)){if(-1!==t.indexOf(o))continue;n[o]=e[o]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}(f,c));console.log("sendData",g),a.default.publish("sendMessage",g,(function(t,a){var s;if(t.successful)s=r.default.getStatusByKey("lasMid"),e.sendStatus=e.data.sendStatus=i.default.sendStatus.success,e.mid=t.mid,s<e.mid&&r.default.setStatusByKey("lasMid",e.mid),!e.hide&&l.default.updateMsg(e,(function(t){e.mid&&$(t).attr("id",e.mid),$(".msg-error",t).remove(),$("img",t).each((function(){$(this).attr("src",$(this).attr("src"))}))})),e=null,h(!1);else if(e.sendStatus=e.data.sendStatus=i.default.sendStatus.error,a&&a(),!e.hide){var c=3e3+3e3*Math.random();p[o]={timer:setTimeout((function(){l.default.updateMsg(e),h(!0)}),c)}}if(n)try{n(t)}catch(e){}}))}}t.default=function(e,t,n){e&&!e.data&&(e.data=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){f(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e));var o=t||e.data.content,r=o&&o.replace(i.default.regEmo,"[face]");t&&(e.data.img=1,e.data.content=t),e.filterMsg&&o&&!e.localMsg?(e.localMsg=o,e.data.content=o+lanRes.vis_48):g(e,t,!1),!o||105!=e.data.et&&130!=e.data.et||a.default.publish("__visitorSendMsg",r),105==e.data.et?a.default.publish("_addSendMsgNum",e):130==e.data.et&&a.default.publish("sendRobotQuestion",e)}},136:function(e,t,n){},137:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(54),n(35),n(19),n(3),n(22),n(11),n(10);var o=l(n(42)),a=l(n(4)),i=l(n(8)),r=n(16),s=l(n(106));function l(e){return e&&e.__esModule?e:{default:e}}n(136);var c,u,d,f,p,h,m,g,v,y,b=o.default.callEchatNative,S=0;y=function(){var e=0;function t(){e&&clearTimeout(e),e=null,v().showNum<=0?$("#chatText").addClass("enter-show"):$("#chatText").removeClass("enter-show")}return function(){e&&clearTimeout(e),e=setTimeout(t,60)}}(),a.default.subscribe("triggerFile",(function(e,t){console.log("triggerFile",t);var n,o,a=2;if("record"==t?a=4:"gallery"==t?a=2:"voice"==t&&(a=3),n=document.getElementById("uploadInput"),$(n).attr("filetype",a),document.createEvent)try{(o=document.createEvent("mouseEvent")).initEvent("click",!0,!0),n.dispatchEvent(o)}catch(e){n.click(),console.log(e)}else n.click()})),a.default.subscribe("setUrlList",(function(e,t){var n,o,r=i.default.getStatusConfig(),s=r.sdkUrlList||r.phoneUrlList,l="",c="",d=['<li class="dot-list-li hover">0</li>'],f=_$("url_dot_list"),p=$(".tool-menu-item").length,g=0;if("string"==typeof s&&(s=JSON.parse(s)),$(".list-url-item").remove(),$(".url-list-pagemore").remove(),!s||0==s.length)return h&&h(0),void i.default.setConfig("urlListConfig",new Array(p));for(s=new Array(p).concat(s),i.default.setConfig("urlListConfig",s),o=p;o<s.length;o++)a.default.needHttps&&(s[o].url=s[o].url.replace(/^http:/i,a.default.needHttps),s[o].icon=s[o].icon.replace(/^http:/i,a.default.needHttps)),c='<li class="list-url-item" data-index="'+o+'"><div class="list-url-img"><div class="menu-item-icon border0"><img src="'+s[o].icon+'" class="list-url-icon" /></div></div><div class="list-url-title">'+s[o].title+"</div></li>",7==o?($("#urlListPage1").append(l+c),l=""):o>7&&(o+1)%8==0?l+=c+"</ul>":o%8==0?(l+='<ul class="clearfix url-list-page flex1 url-list-pagemore">'+c,g++,d.push("<li class='dot-list-li'>"+g+"</li>")):l+=c;$("#urlListWrap").css({width:100*(g+1)+"%",transform:"translate(0px, 0px)"}).attr("x2","0").attr("x2","0"),o<8?$("#urlListPage1").append(l):o>8&&(l+="</ul>",$("#urlListWrap").append(l)),!m||g>0?(S=0,n=function(){S<0&&(S=0),$($(".dot-list-li",f).removeClass("hover").results[S]).addClass("hover")},h=function(e){$("#urlListWrap").css({transform:"translate(-"+window.innerWidth*e+"px, 0px)"}).attr("x2","0").attr("x","-"+window.innerWidth*e),S=e,n()},m=function(e){0!=e&&((S+=e)>g&&(S=g),n())},0==g?$(f).hide():($(f).html(d.join("")).show(),a.default.pageSlide("#urlListWrap",m))):($(f).hide(),h&&h(0)),y(),u()})),a.default.subscribe("setCustomList",(function(e,t){var n,o,s=i.default.getStatusConfig().customUrlList,l=null,c=$("#urlSetList"),u=$("#urlSetListBox"),d=document.createElement("div");if(c.hide(),u.results&&u.results[0].children.length&&(u.html(""),a.default.publish("changeDom",{name:"#urlSetList",cls:"hide"})),"string"==typeof s&&(s=JSON.parse(s)),s&&0!=s.length){if(o=s.length,0!=a.default.queryParams.businessUrl&&o){for(c.show(),a.default.publish("changeDom",{name:"#urlSetList",removeCls:"hide"}),n=0;n<o;n+=1)d.innerHTML='<span class="uslSetSpan">{title}</span>'.replace("{title}",a.default.escapeHtml(s[n].title)),(l=d.children[0]).onclick=f(n),u.append(l);!function(){if(!T)return;T=!0;var e=$("#urlSetList"),t=$("#urlSetListBox"),n={minLeft:e.width()-t.width()-12,in:!1,left0:0,x0:0,x1:0};function o(e){e=e.touches&&e.touches[0]||e,n.in=!0,n.x0=e.clientX;var t=window.getComputedStyle(_$("urlSetListBox"));n.left0=parseInt(t.getPropertyValue("left"))||0,$(document).on("touchmove",a),$(document).on("touchend",i),$("#urlSetListBox").addClass("transition-none")}function a(e){if(n.in){e=e.touches&&e.touches[0]||e,n.x1=e.clientX;var t=n.left0+n.x1-n.x0;t<n.minLeft?t=n.minLeft:t>12&&(t=12),t==n.minLeft?($(".left-reg").show(),$(".right-reg").hide()):12==t&&($(".left-reg").hide(),$(".right-reg").show()),_$("urlSetListBox").style.left=t+"px"}}function i(){n.in=!1,e.ontouchstart=null,$(document).off("touchmove",a),$(document).off("touchend",i),$("#urlSetListBox").removeClass("transition-none")}function r(e){var t=$("#urlSetListBox").results[0],n=2*$("#chat").width()/3,o=t.offsetLeft,a=$("#urlSetListBox"),i=$("#urlSetList").width()-24,r=-(a.width()-i-12);switch(e){case"left":$(".right-reg").show(),(s=o+n)>=12?(a.css("left","12px"),$(".left-reg").hide()):a.css("left",s+"px");break;case"right":var s;$(".left-reg").show(),(s=o-n)<=r?($(".right-reg").hide(),a.css("left",r+"px")):a.css("left",s+"px")}}$("#urlSetList").on("touchstart",".left-reg",(function(){r("left")})).on("touchstart",".right-reg",(function(){r("right")})),t.width()>e.width()-24?($(".right-reg").show(),$(e).off("touchstart"),$(e).on("touchstart",o)):$(e).off("touchstart",o)}()}}else i.default.setConfig("customListConfig",[]);function f(e){return function(t){var n=s[e];if(2==n.type)return 2!=i.default.getStatusByKey("chatStatus")?void a.default.showTip(lanRes.visitor172):void(n.msgContent&&a.default.triggerEventOnPoint("_sendMsg",n.msgContent));var o=(0,r.getADURL)(!0,n.openWindowParamList,n.url,1==n.appendType);a.default.publish("showURLLink",n.title,o,{openType:1==n.openType?"default":"half"})}}}));var T=!0;p=function(e){function t(e,t){b(e,t),u()}function n(e){var n=i.default.getVisitorInfo();t("uploadMedia",{visitorId:n.visitorId,companyId:n.companyId,type:e,maxNum:9})}f=e,$(".tool-menu-item").addClass("hide"),$(".menu-emo").addClass("hide"),$(".url-list-item").addClass("hide"),$("#menu_emotion").on("click",(function(e){return s.default.initLastSelecttion(),d(e,"emotion",this)})),$("#menu_more").on("click",(function(e){return d(e,"urlList",this)})),$(".menu-satisfy").on("click",(function(){a.default.publish("showSatisfy",3)})),$(".menu-file").on("click",(function(){n("gallery")})),$(".menu-camera").on("click",(function(){n("camera")})),$(".menu-log").on("click",(function(){var e=i.default.getStatusData(),n=i.default.getVisitorInfo();t("uploadLogs",{id:(0==e.chatStatus?"leave_":"chat_")+n.companyId+"_"+e.talkId,from:"chat",visitorId:n.visitorId,companyId:n.companyId})})),$(".menu-map").on("click",(function(){t("map")})),1!=a.default.getQueryString("isMapExist")&&$(".menu-map").addClass("style-tool-hide")},d=function(e,t,n){return f.inputFocus?(setTimeout((function(){c(t)}),550),f.inputBlur()):$(n).hasClass("open")?u():c(t),e&&e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation(),!1},c=function(e){g&&clearTimeout(g);var t,n,o,i=$("#"+e);"emotion"==e?(t=206,o="urlList",$("#chatText").removeClass("recording")):"urlList"==e&&(t=v().height,o="emotion"),n=$("#"+(o||"")),$("#chat").off("click",u),setTimeout((function(){$("#chat").on("click",u)}),20),$("#footer").css("bottom",t+"px"),a.default.publish("changeDom",{name:"#footer",bottom:t,scrollTime:550}),"urlList"==e?($(".menu-more").addClass("open"),$(".menu-more-i").addClass("color0"),$(".menu-emo").removeClass("open").removeClass("color0")):($(".menu-more").removeClass("open"),$(".menu-more-i").removeClass("color0"),$(".menu-emo").addClass("open").addClass("color0")),i.removeClass("ani-hide"),n.addClass("ani-hide"),setTimeout((function(){i.removeClass("hide")})),g=setTimeout((function(){n.addClass("hide").removeClass("ani-hide")}),200)},u=function(e,t){var n=window.getComputedStyle(_$("footer"));if(parseInt(n.getPropertyValue("bottom")||0)){var o,i,r;if(g&&clearTimeout(g),!t&&e&&(o=e&&e.target?e.target:window.event?window.event.srcElement:null))for(i=[_$("menu_emotion"),_$("emotion"),_$("menu_more"),_$("urlList")],r=0;r<i.length;r++)if(o==i[r]||$.fn.contains(i[r],o))return;$("#chat").off("click",u),f.inputFocus&&(console.log('$("#footer").addClass("transition-none");'),$("#footer").addClass("transition-none"),$("#footer").css("bottom","0px")),setTimeout((function(){$("#footer").css("bottom","0px"),$("#footer").removeClass("transition-none"),a.default.publish("changeDom",{name:"#footer",bottom:0,scrollTime:550})}),100),$("#emotion").hasClass("hide")?$("#emotion").addClass("ani-hide"):$("#urlList").hasClass("hide")&&$("#urlList").addClass("ani-hide"),g=setTimeout((function(){$("#emotion").addClass("hide").removeClass("ani-hide"),$("#urlList").removeClass("ani-hide")}),500),$(".menu-more").removeClass("open"),$(".menu-more-i").removeClass("color0"),$(".menu-emo").removeClass("open").removeClass("color0")}},v=function(){var e,t,n,o,a,r=0,s=0,l=$(".tool-menu-item"),c=$(".list-url-item"),u=c.length,d=i.default.getConfig("urlListConfig").length,f=$(".list-url-item",document.getElementById("urlListPage1")).length,p=$(".url-list-page");if($(".url-list-page").each((function(e,t){$(t).hasClass("hide")||s++})),l.each((function(e,t){t.className.match(/hide/g)&&r++})),t=l.length+u-r,(e=8-l.length+r)!=f&&u){var h=-1;$(".list-url-item").remove(),p.each((function(t,n){if(!(h>=u)){var o,a=0==t?e:8;for(o=0;o<a&&!(++h>=u);o++)$(n).append(c.results[h].outerHTML)}}))}return t<1?a=0:t<5?a=114:t&&(a=232),$("#urlList").css({height:a+"px",bottom:-a+"px"}),n=parseInt(d/8)+(d%8>0?1:0),o=parseInt(t/8)+(t%8>0?1:0),s==o&&n==o||($("#urlListWrap").css({width:100*o+"%",transform:"translate(0px, 0px)"}).attr("x","").attr("x2",""),$(".url-list-page").removeClass("hide").each((function(e,t){e+1>o?$(t).addClass("hide"):$(t).removeClass("hide")})),1==o?$("#url_dot_list").hide():$("#url_dot_list").show(),$(".dot-list-li",_$("url_dot_list")).removeClass("hide").removeClass("hover").each((function(e,t){e+1>o?$(t).addClass("hide"):$(t).removeClass("hide")}))),{height:a,hideNum:r,pageNum:o,showNum:t}};t.default={init:p,checkMenuNums:y,hideMenus:u}},16:function(e,t,n){"use strict";n(25),n(33),n(39),n(51),n(34),n(52),n(62),n(15),n(40),n(21),n(53),n(30),n(31),n(41),Object.defineProperty(t,"__esModule",{value:!0}),t.addEchatInnerFrameParam=function(e){if(!e)return"";if(-1!=e.indexOf("&echatInnerFrame=1")||-1!=e.indexOf("?echatInnerFrame=1"))return e;var t=e.split("#"),n=t[1]||"",o=t[0],a=-1==o.indexOf("?")?0:1;return o+(a?"&":"?")+"echatInnerFrame=1"+(n?"#":"")+n},t.addFixedParam=function(e){if(!e||!a.default.getConfig("echatSourceTagEnable")||e.match(/^(mailto|tel|javascript):/i))return e||"";var t,n=new RegExp("(^|&)echatSourceTag=([^&]*)(&|$)","i"),i=v(e,"?"),r="echatSourceTag="+encodeURIComponent((s=u(),l=a.default.getStaff(),o.default.addMapParams({staffId:l.staffId,staffName:l.name,media:s.media||6,companyId:s.companyId,talkId:s.talkId,echatTag:s.echatTag,visitorId:s.visitorId,country:s.country,province:s.province,keyword:s.keyword})||""));var s,l;if(t=v(i[1]||i[0],"#"),t[0].match(n))return e;e=i.length>1?i[0]+"?"+t[0]+"&"+r+(t.length>1?"#"+t[1]:""):t[0]+"?"+r+(t.length>1?"#"+t[1]:"");return e},t.checkHistory=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];o.default.unSubscribe("checkHistory",e);var n,i,r,s,l,c=t.concat(a.default.getMsgList()),u=a.default.getStatusData(),d=u.talkId,f=o.default.Constants.visitorEventTypes,p=0;for(l=c.length-1;l>=0;l--)if(i=c[l].data,s=i.talkId,r=parseInt(i.mt||i.et),s||f[r]&&p++,s==d)673!=r||0!=i.isForward||n||(n=i),f[r]&&p++;else if(s)break;return a.default.setStatusByKey("sendMsgNum",p),o.default.publish("initEvaluate",i),{noLimit:a.default.getEvaluateAndLimit().limit<=p,last673:n}},t.confirmOpenWs=function(e,t){if(f())return!1;return o.default.showDialog({tip:e||lanRes.vis_59,okTip:t||lanRes.vis_60,ok:function(){h()}}),!0},t.debounce=function(e,t){if(!e)return;t||(t=300);return n=e,o=t,c=function e(){var t=Date.now()-s;t<o&&t>=0?a=setTimeout(e,o-t):(a=null,l=n.apply(r,i),a||(r=i=null))},function(){return r=this,i=arguments,s=Date.now(),a||(a=setTimeout(c,o)),l};var n,o,a,i,r,s,l,c},t.default=void 0,t.getADURL=y,t.getMsgByDom=function(e){var t=$(e).parents(".msgli").attr("id"),n=t&&a.default.getMsgFromHistory(t);if(!n)return void console.log("出错 没有找消息");return n.msg},t.getMsgDomId=g,t.getParamChat=u,t.handOpenWs=p,t.handleNetwork=m,t.hasConnect=d,t.isWSReady=f,t.networkStatusChange=function(e){if(a.default.getDataByName("netConnected")==e)return;a.default.setDataByName("netConnected",e),o.default.publish("changeNetStatus",e),o.default.publish("changeNetWsStatus",e)},t.openWsAndRegist=h,t.plainTextToSendMsg=function(e){var t={"<":"&lt;",">":"&gt;",'"':"&quot;"};return e.replace(/\[#([^#]+)#\]/g,(function(e,t){return"[#"+(a.default.getDataByName("emoLanToCode")[t]||t)+"#]"})).replace(/[<">]/g,(function(e){return t[e]}))},t.throttle=function(e,t){var n,o=Date.now();return function a(){var i=this,r=arguments,s=Date.now();n&&clearTimeout(n),s-o>=t?(e.apply(i,r),o=Date.now()):n=setTimeout((function(){a.apply(i,r)}),t)}},t.websocketStatusChange=function(e){o.default.publish("changeNetWsStatus",a.default.getDataByName("netConnected"));var t=f(),n=a.default.getDataByName("netConnected"),i=t||n;if(n==i)return;o.default.publish("changeNetStatus",i)},t.wsStoped=function(){var e=a.default.getDataByName("websocketStatus");return e==o.default.Constants.websocketStoped||e==o.default.Constants.websocketNotConnect},n(60),n(54),n(61),n(26),n(44),n(19),n(63),n(69),n(3),n(71),n(50),n(22),n(11),n(10);var o=i(n(4)),a=i(n(8));function i(e){return e&&e.__esModule?e:{default:e}}function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=r(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=r(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==r(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(){return l(l({},a.default.getVisitorInfo()),a.default.getStatusData())}function d(){var e=a.default.getDataByName("websocketStatus");return e==o.default.Constants.websocketConnected||e==o.default.Constants.websocketReady}function f(){var e=a.default.getDataByName("websocketStatus");return e==o.default.Constants.websocketReady||e==o.default.Constants.websocketConnected}function p(e){if(e&&!(e>3)){var t=a.default.getStatusByKey("chatStatus"),n=a.default.getDataByName("netConnected"),o=d();n&&!o&&(2==t&&(1==e||2==e)||0==t&&3==e)&&h()}}function h(){return!f()&&(o.default.publish("__openWebsocket"),o.default.subscribe("websocketReadyAndRegist",(function(){o.default.publish("restartChat"),o.default.unSubscribe("websocketReadyAndRegist")})),!0)}function m(e){var t=a.default.getDataByName("netConnected"),n=d();return!t&&!n&&(e&&t&&!n&&p(e),t?n?void 0:(o.default.showDialog({tip:lanRes.vis_44}),!0):(o.default.showTip(lanRes.vis_43),!0))}function g(e){return e.clientFileId||e.bridgeMsgId||e.id||e.mid}function v(e,t){var n=e,o=[],a=n.indexOf(t);return a>=0?(o[0]=n.substring(0,a),n.substring(a+1)&&(o[1]=n.substring(a+1))):o[0]=n,o}function y(e,t,n,a){if(!n)return"";if(!e||"0"==e||!t)return n;var i,r,s,l,c,d="",f="",p="",h=n.split("#"),m=h[1]||"",g=h[0],v=-1==g.indexOf("?")?0:1,y=u(),b=o.default.Constants.ADParams,S=0,T="?";if("string"==typeof t&&(t=JSON.parse(t)),o.default.isArray(t)&&t.length){for(i=t.length,s=0;s<b.length&&("staffId"==(l=b[s])&&(f=d,d="",a&&(T="",v=m?1:0)),"staffId"!=l||y.staffId);s++)for(r=0;r<i;r++)if("metaData"!=(c=t[r].paramName)&&"metadata"!=c||(c="metaData"),c==l){"metaData"==c?(S=1,d+=(0!=v?"&":T)+c+"="+encodeURIComponent(y[c]||""),d+=(0!=++v?"&":T)+(c="myData")+"="+encodeURIComponent(y[c]||""),v++,y[c="info"]&&(d+=(0!=v?"&":T)+c+"="+encodeURIComponent(y[c]||""),v++)):"myData"==c?S||(d+=(0!=v?"&":T)+c+"="+encodeURIComponent(y[c]||""),v++):"staffId"==c?(d+=(0!=v?"&":T)+c+"="+("-1"==encodeURIComponent(y[c]||"")?"":encodeURIComponent(y[c]||"")),v++):(d+=(0!=v?"&":T)+c+"="+encodeURIComponent(y[c]||""),v++);break}b.length==s&&(p=d,d="")}return a?g+f+(m?"#"+m+p:"#"+p):g+f+p+(m?"#"+m:"")}t.default={handleNetwork:m,getMsgDomId:g,getADURL:y}},178:function(e,t,n){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}n(25),n(33),n(39),n(34),n(52),n(40),n(128),n(41),Object.defineProperty(t,"__esModule",{value:!0}),t.filterTextMsg=function(e){return e?T(b(S(k(e)))):e},t.getMsgContent=x,t.getRobotFeedback=_,t.getSendProgess=D,t.handleMap=void 0,t.init=function(e){e},n(35),n(174),n(88),n(26),n(44),n(253),n(19),n(15),n(3),n(87),n(50),n(22),n(11);var a=f(n(45)),i=f(n(4)),r=f(n(8)),s=f(n(55)),l=n(16),c=n(104),u=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=o(e)&&"function"!=typeof e)return{default:e};var n=d(t);if(n&&n.has(e))return n.get(e);var a={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in e)if("default"!==r&&{}.hasOwnProperty.call(e,r)){var s=i?Object.getOwnPropertyDescriptor(e,r):null;s&&(s.get||s.set)?Object.defineProperty(a,r,s):a[r]=e[r]}return a.default=e,n&&n.set(e,a),a}(n(107));function d(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(d=function(e){return e?n:t})(e)}function f(e){return e&&e.__esModule?e:{default:e}}var p,h,m,g={toChat:"robot-staff ",endChat:"end-chat ",toLeaveWord:"to-leave-word "};function v(){return r.default.getConfig("locationBase")||location.origin}var y=t.handleMap={etmt:{10:1,20:1,30:1,40:1,50:1,161:1,162:1,163:1,164:1,127:1,105:1,130:1,640:1,641:1,642:1,644:1,647:1,648:1,655:1,658:1,680:1,688:1,864:1,865:1,866:1,902:1,959:1,10001:1,10011:1,10010:1,12001:1,12004:1},text:{10:1,20:1,30:1,40:1,50:1,105:1,130:1,864:1,640:1,644:1,648:1},visitor:{30:1,127:1,105:1,130:1,161:1,162:1,163:1,164:1,864:1,865:1,866:1,902:1},resendEt:{127:1,105:1,130:1,161:1,162:1,163:1},sendingEt:{127:1,105:1,130:1,163:1},resendEtFile:{161:1,162:1,163:1,164:1},staff:{10:1,640:1,641:1,642:1,644:1,680:1},sysMsg:function(e){return 647==e.mt||648==e.mt||20==e.mt||10010==e.mt||10001==e.mt||12001==e.mt&&(7==e.type||3==e.type)||10011==e.mt&&(3==e.mst||2==e.customizeMsgType)},sysToStaff:function(e){return 647==e.mt&&(5==e.type||10==e.type)||10011==e.mt&&2==e.mst},sysToVisitor:function(e){return 10011==e.mt&&1==e.mst},sysToRobot:function(e){return 647==e.mt&&10==e.type},robotAnswer:function(e){return 12001==e.mt&&(1==e.type||2==e.type||5==e.type||6==e.type)||12004==e.mt||50==e.mt},robotTip:function(e){return 12001==e.mt&&7==e.type},location:function(e){return 127==e.et||902==e.mt},msgParser:function(e){var t,n,o=e.mt||e.et;if(m[o])return m[o];for(t=["push","video","voice","img","file"],n=0;n<t.length;n++)if(y[t[n]](e))return m[t[n]]},push:function(e){return 655==e.mt||658==e.mt},video:function(e){return 162==e.et&&4==e.fileType||(642==e.mt||866==e.mt)&&2==e.fileType},voice:function(e){return 163==e.et&&3==e.fileType||(642==e.mt||866==e.mt)&&1==e.fileType},img:function(e){return 161==e.et&&1==e.fileType||641==e.mt||865==e.mt},file:function(e){return 161==e.et&&2==e.fileType||164==e.et||(642==e.mt||866==e.mt)&&0==e.fileType},getResendClass:function(e,t){if(y.resendEt[t]&&e.sendStatus===a.default.sendStatus.error)return y.resendEtFile[t]?"file-resend":"resend";if(y.sendingEt[t]&&e.sendStatus===a.default.sendStatus.sending)return" "}};function b(e){return e?e=e.replace(/\[\[#(toChat|endChat|toLeaveWord):([^\]]+)\]\]/g,(function(e,t,n){return'<span class="link-in-msg '+(g[t]||"")+'">'+n+"</span>"})):e}function S(e){if(!e||"string"!=typeof e)return e;var t=r.default.getDataByName("emoMap"),n=v();return t&&(e=e.replace(a.default.regFace,(function(e){var o=e.charCodeAt(0),a=e.charCodeAt(1),i=(a-56320+(o-55296<<10)+65536).toString(16);return t[i]?'<img class="img-emo" src="'+n+"/res/emoji/32/"+i+'.png" />':t[o+"_"+a]?'<img class="img-emo" src="'+n+"/res/emoji/32/"+o+"_"+a+'.png" />':e}))),e=e.replace(a.default.regEmo,(function(e){var o=e.replace(/^\[#([\d\w_]+)#\]/g,"$1");return t&&t[o]||!t?'<img class="img-emo" src="'+n+"/res/emoji/32/"+o+'.png" />':e}))}function T(e){if("string"!=typeof e||e.match(/(msg\-tel)|(msg\-link)|(msg\-mail)/))return e;var t,n,o=i.default.isMobile,r=a.default.regPhone,s=a.default.regMail,l=a.default.regLink;return r.lastIndex=0,s.lastIndex=0,l.lastIndex=0,(e=e.replace(l,(function(e){var t=arguments.length,n=arguments[t-2];if(n>0){var a=arguments[t-1].substring(0,n);if(a=a.replace(/\<a[^>]*>([\s\S]*?)([^<]+(\<\/a\>))/g,""),/(\<(a|img|link|iframe|script)[^>]*>([^<]+(?!\<\/a\>))?)|(\<[a-zA-Z]+[^>]*$)/gi.test(a))return e}return o?'<a class="msg-link" href="'+e+'" target="visitorSiteIframe">'+e+"</a>":'<a class="msg-link" target="_blank" href="'+e+'">'+e+"</a>"}))).indexOf("@")>1&&(e=e.replace(s,(function(e){var t=arguments.length,n=arguments[t-2];if(n>0){var o=arguments[t-1].substring(0,n);if(/(\<(a|img|link|iframe|script)[^>]*>[^<]+(?!\<\/a\>)$)|(\<[a-zA-Z]+[^>]*$)/gi.test(o))return e}return'<a class="msg-mail" target="_blank" href="mailto:'+e+'">'+e+"</a>"}))),e=e.replace(r,(function(e,t){var n,a,i=arguments.length,r=arguments[i-2];if(r>0){var s=arguments[i-1].substring(0,r);if(/(\<(a|img|link|iframe|script)[^>]*>[^<]+(?!\<\/a\>)$)|(\<[a-zA-Z]+[^>]*$)/gi.test(s))return e;if(/\<(a)[^>]*>/gi.test(s)&&-1==s.indexOf("</a>"))return e}return n=t,a=e.replace(/^[^\d]|\b/,""),(n||"")+(o?'<a class="msg-tel" href="tel:'+a+'">'+a+"</a>":'<span class="msg-tel">'+a+"</span>")})),n=/\bsrc\b\s*=\s*[\'\"]?([^\'\"]*)[\'\"]?/i,e=t=(t=e)&&t.replace(/<video\b.*?(?:\>|\/>)/gi,(function(e){var t=n.exec(e),o="";return t.length>1&&(o=t[1]),'<div class="msg-medias"><div class="msg-video" videourl='+o+'><div class="msg-video-poster"></div><div class="msg-video-angle"></div></div></div>'}))}function w(e,t,n){return'<img onerror="_echat0.imgError(this)"'+(t?"":' onload="javascript:_echat0.scrollToBottom()"')+' src="'+e+'" class="msg-img '+(n||"")+'"/>'}function k(e,t,n,o){var a=/\bsrc\b\s*=\s*[\'\"]?([^\'\"]*)[\'\"]?/i;return t=t||{},e=e&&e.replace(/<img\b.*?(?:\>|\/>)/gi,(function(e){var i=o||a.exec(e);return i?w(i=o||i[1],t.notEnd,n):e}))}function I(e){return b(S(k(e.localMsg||e.translation||e.content)))}function C(e){return e?b(S(e)):e}function x(e,t){var n,o=y.msgParser(e);return n=o?o.apply(this,arguments):I(e),680==e.mt||y.push(e)?n:n&&T(n).replace(/((\r\n)|\n)/g,"</br>")}function E(e){return(e.toStaffNickName||lanRes.serviceStaff)+" "+lanRes.transferStaff}function $(e){var t=e.locationX||e.x,n=e.locationY||e.y,o="https://restapi.amap.com/v3/staticmap?location="+n+","+t+"&zoom="+(e.scale||15)+"&size=400*200&key=246302a5850ae023576227e569a15b1b&markers=mid,,A:"+n+","+t;return'<div class="msg-map"><a target="cover" href="http://uri.amap.com/marker?position='+n+","+t+"&name="+encodeURIComponent(e.label)+'&coordinate=gaode"><div class="msg-map-title"><div>'+e.label+'</div><div class="msg-map-addr">'+(e.address||"")+'</div></div><img onerror="_echat0.imgError(this)" onload="_echat0.scrollToBottom()" class="view_img" src="'+o+'" draggable="false"/></a></div>'}function D(e){var t=e.sendStatus,n=r.default.getMsgFromHistory(e.clientFileId);return n&&n.sendStatus==a.default.sendStatus.success?"":t==a.default.sendStatus.sending||t==a.default.sendStatus.notSend?'<div class="msg-preview-info"><div class="msg-preview-progress">'+(e.progress||0)+"%</div></div>":""}function M(e,t,n){var o=e.sendStatus;return 161!=e.et&&162!=e.et&&163!=e.et&&164!=e.et||o==a.default.sendStatus.success||t?"":D(e)+(n?"</div>":"")}function _(e,t){if(!t)return"";if(1!=t.feedback||!r.default.getConfig("robotFeedback"))return"";var n,o,a=r.default.getStatusData(),s=e.feedback||e.allExtra.h5Extra.feedback,l=e.feedbackSubitem||e.allExtra.h5Extra.feedbackSubitem;if(e.talkId!=a.talkId&&!s)return"";if(12004==t.mt){var c=(0,u.getStreamData)(t);if(c.endReason&&"0"!=c.endReason)return""}return n=r.default.getConfig("config649").robotWordsInfo,o=i.default.dji,i.default.needHttps&&(n.solvedButton&&(n.solvedButton=n.solvedButton.replace(/^http:/,i.default.needHttps)),n.unsolvedButton&&(n.unsolvedButton=n.unsolvedButton.replace(/^http:/,i.default.needHttps))),n.solvedSubitem||n.unsolvedSubitem?!o||n.unsolvedWords||n.solvedWords?p=function(e){e=e||{};var t,a="",i='<div class="feedback-tip">'+(n.fedBackWords||"")+'</div><div class="feedback-btns clearfix"><div class="feedback-btn-solve '+(1==e.feedback?"feedback-btn-solve-sel":"")+(o&&!n.solvedWords?" hide":"")+'" type="1">'+(n.solvedButton?'<img onerror="_echat0.imgError(this)" src="'+n.solvedButton+'"/>':"")+"<span>"+(n.solvedWords||"")+'</span></div><div class="feedback-btn-unsolve '+(2==e.feedback?"feedback-btn-unsolve-sel":"")+(o&&!n.unsolvedWords?" hide":"")+'" type="2">'+(n.unsolvedButton?'<img onerror="_echat0.imgError(this)" src="'+n.unsolvedButton+'"/>':"")+"<span>"+(n.unsolvedWords||"")+"</span></div></div>";if(e.feedbackSubitem||e.currentTalk){if(n.solvedSubitem&&"string"==typeof n.solvedSubitem&&(n.solvedSubitem=JSON.parse(n.solvedSubitem)),n.unsolvedSubitem&&"string"==typeof n.unsolvedSubitem&&(n.unsolvedSubitem=JSON.parse(n.unsolvedSubitem)),2!=e.feedback&&n.solvedSubitem&&n.solvedSubitem.length>0){for(a+='<div class="feedback-sub-solved"><div class="robot-tip">'+lanRes.solvedReason+'</div><ul class="feedback-sub-list '+(e.feedbackSubitem?"robot-feedback-sub-had":"")+'">',t=0;t<n.solvedSubitem.length;t++)a+='<li class="feedback-sub-li sub-solved-li '+(e.feedbackSubitem==n.solvedSubitem[t].content?"feedback-sub-sel1":"")+'"><span class="list-style-dot">'+(t+1)+'.</span><span class="feedback-sub-content" type="1">'+n.solvedSubitem[t].content+"</span></li>";a+="</ul></div>"}if(1!=e.feedback&&n.unsolvedSubitem&&n.unsolvedSubitem.length>0){for(a+='<div class="feedback-sub-unsolved"><div class="robot-tip">'+lanRes.unsolvedReason+'</div><ul class="feedback-sub-list '+(e.feedbackSubitem?"robot-feedback-sub-had":"")+'">',t=0;t<n.unsolvedSubitem.length;t++)a+='<li class="feedback-sub-li sub-unsolved-li '+(e.feedbackSubitem==n.unsolvedSubitem[t].content?"feedback-sub-sel2":"")+'"><span class="list-style-dot">'+(t+1)+'.</span><span class="feedback-sub-content" type="2">'+n.unsolvedSubitem[t].content+"</span></li>";a+="</ul>"}}return i+a+"</div></div>"}:hasRobotFeedback=!1:p=function(e){return e=e||{},'<div class="feedback-tip">'+(n.fedBackWords||"")+'</div><div class="feedback-btns clearfix"><div class="feedback-btn-solve '+(1==e.feedback?"feedback-btn-solve-sel":"")+'" type="1">'+(n.solvedButton?'<img onerror="_echat0.imgError(this)" src="'+n.solvedButton+'"/>':"")+"<span>"+(n.solvedWords||"")+'</psan></div><div class="feedback-btn-unsolve '+(2==e.feedback?"feedback-btn-unsolve-sel":"")+'" type="2">'+(n.unsolvedButton?'<img onerror="_echat0.imgError(this)" src="'+n.unsolvedButton+'"/>':"")+"<span>"+(n.unsolvedWords||"")+"</span></div></div></div></div>"},p?'<div class="robot-feedback '+(s?" robot-feedback-had robot-feedback-had"+s:"")+'">'+p({currentTalk:e.talkId==a.talkId,feedback:s,feedbackSubitem:l}):(console.log("设置反馈打开但是没找到反馈配置"),"")}h=function(e,t){var n=t?" border0":"";return e?'<div class="custom-event'+n+'"><div class="custom-event-wrap">{{imageUrl}}<div class="custom-event-content"><div class="custom-event-title" title="{{title1}}">{{title}}</div><div class="custom-event-detail">{{content}}</div></div></div>{{memo}}</div>':'<a class="custom-event'+n+'" {{linkset}}><div class="custom-event-wrap">{{imageUrl}}<div class="custom-event-content"><div class="custom-event-title" title="{{title1}}">{{title}}</div><div class="custom-event-detail">{{content}}</div></div></div>{{memo}}</a>'},m={647:function(e){if(10!=e.type)return T(I(e));var t,n,o=e.content;if(o=C(k(o,e)),(n=e.commonQuestions&&JSON.parse(e.commonQuestions))&&n.length){for(e.commonQuesWords?o+='<div class="common-ques-tip">'+e.commonQuesWords+'</div><ul class="common-ques-list">':o+='<ul class="common-ques-list">',t=0;t<n.length;t++)o+='<li class="common-ques-li" did="'+n[t].id+'" ques="'+escape(n[t].question||n[t].content)+'"><span class="list-style-dot">'+(t+1)+'.</span><span class="link-robot-ques">'+(n[t].question||n[t].content)+"</span></li>";o+="</ul>"}return o},959:function(e){if(e.template){var t=e.template,n=i.default.getCSSRule(".bg0"),o=1==Number(i.default.windowType)?"info_frame3":"inner",a=e.formUrl.replace(/^http(s)?:\/\/(.*?)\//,v()+"/")+i.default.addMapParams({isVisitor:1,showResult:1,tm:(new Date).getTime(),talkId:e.talkId,visitorId:e.formInfo.visitorId,sendId:e.formInfo.sendId,formInfoId:e.formInfo.id,bgColor:n.style.backgroundColor||"",apiServerDomain:r.default.getApiDomain(),companyId:r.default.getVisitorInfo("companyId"),dataHost:r.default.getVisitorInfo("dataHost")});return'<a target="'+o+'" href="'+encodeURI(a)+'" class="push-url clearfix form-link-box form-res-box"><span class="from-res-box-img"></span><span>'+t.commitMsg+'</span><span style="float: right;color: #ddd;">></span></a>'}},688:function(e){if(e.template){var t=e.template,n=i.default.getCSSRule(".bg0"),o=1==Number(i.default.windowType)?"info_frame3":"inner",a=e.formUrl.replace(/^http(s)?:\/\/(.*?)\//,v()+"/")+i.default.addMapParams({isVisitor:1,visitorId:e.visitorId,talkId:e.talkId,sendId:e.sendId,companyId:r.default.getVisitorInfo("companyId"),bgColor:n.style.backgroundColor||"",dataHost:r.default.getVisitorInfo("dataHost"),apiServerDomain:r.default.getApiDomain()}),s=function(){var e=(t.detailList||[]).slice().splice(0,4),n="";for(var o in e)n+="<li>"+e[o].label+"</li>";return n}(),l='<a title="'+t.name+'" class="push-url clearfix form-link-box" target="'+o+'" href="'+encodeURI(a)+'"><div class="form-link-box-name">'+t.name+'</div><ul class="form-link-box-content">'+s+'</ul><div class="form-link-box-btn bg0"><span>'+lanRes.vis_54+"</span></div></a>";if(1==t.openType&&e.allExtra&&0==e.allExtra.isForward)switch(Number(i.default.windowType)){case 1:i.default.publish("handlePushURL",encodeURI(a));break;default:i.default.publish("showURLLink",t.name,encodeURI(a),{from:5})}return l}},10011:function(e,t){if(2!=e.visibility){if(t[0]=t[0]+"anglebgwhite ",e.urlForVisitor){e.urlForVisitor=e.urlForVisitor.replace(/\s/g,"");var n=e.urlForVisitor.match(/^http\(['"]?([^'",]+)['"]?(\,['"]?(blank|inner)['"]?)?\)/i)||e.urlForVisitor.match(/^xcx\(['"]?([^'",]+)['"]?(\,['"]?(navigateTo|redirectTo|switchTab)['"]?)?\)/i);n?(e.url=n[1],e.openType=n[3]):e.url=""}else if(0==e.urlEnableForVisitor&&(e.url=void 0,delete e.url),e.url){var o=e.url.replace(/\s/g,"").match(/^apiUrl\(['"]?(\d+)['"]?(\,['"]?(reload|hash)['"]?)?\)/);o?e.toCrmUrlId=o[1]:(e.url.match(/(^http[s]?:)|(^file:)/i)||(e.url=""),e.toCrmUrlId=!1)}var a,r="";e.imageUrl&&(e.imageUrl=e.imageUrl.replace(/["']/,""),r=e.imageUrl?'<img onerror="_echat0.imgError" class="custom-event-img" src="'+e.imageUrl+'"/>':"",e.url&&!e.toCrmUrlId||(r=k(r,e,"custom-event-img",e.imageUrl)));var s=i.default.HTMLDecode(e.title||"")||"",l=i.default.HTMLDecode(e.memo||"")||"";return a=h(!e.url||e.toCrmUrlId,3==e.mst).replace(/\{\{linkset\}\}/,!e.url||e.toCrmUrlId?"":' href="'+e.url+("inner"==e.openType?'" target="inner" title="'+(s||lanRes.interactWnd)+'" ':"navigateTo"==e.openType||"redirectTo"==e.openType||"switchTab"==e.openType?'" target="'+e.openType+'" ':'" target="_blank" ')).replace(/\{\{title1\}\}/,s).replace(/\{\{title\}\}/,s).replace(/\{\{imageUrl\}\}/,r).replace(/\{\{content\}\}/,e.content).replace(/\{\{memo\}\}/,l?'<div class="custom-event-memo">'+l+"</div>":""),console.log("******************",a),a}},10001:E,680:function(e){var t=e.pushUrlDetail.url,n="";return i.default.needHttps&&t.match(/^http:/i)&&(n=" push-blank"),'<a class="push-url clearfix'+n+'" target="info_frame3" href="'+t+'"><div class="push-icon echat bg1"></div><div class="push-content"><div class="push-name">'+i.default.HTMLDecode(e.pushUrlDetail.urlName)+' </div><div class="push-url-link">'+e.pushUrlDetail.url+"</div></div></a>"},604:E,12001:function(e){var t,n,o,a=(0,c.getAnswerItem)(e),d=y.robotAnswer(e),f="",p='<ul class="question-list">';if(e.nonTextMsg)return 0==e.isForward&&(0,u.removeFakeAnswer)(e,!0),0==e.isForward&&(0,c.unBlockSendQuestionOld)(),x(e.nonTextMsg);if(1==e.type||2==e.type){if(a&&12004==a.mt&&(d=!0,a.answerType=a.answerType||6,a.echatId=e.echatId,a.isForward=e.isForward,a.mid=e.mid,a.allExtra=e.allExtra,a.answer=function(e){var t=(0,u.getStreamData)(e),n=(0,u.getStreamTempData)(e),o=u.default.getStreamContent(t.robotDetailList).join("");return'<div class="msg-item-robot stream-wrap" id="'+n.streamId+'"><div class="stream-msg-pre">'+o+"</div>"+((0,c.isCurrentRobot)(e)?2==t.status||t.endReason?"":(t.robotDetailList.length?"":'<div class="circle-item-wrap circle-item-inmsg"><i class="circle-item circle-1"></i><i class="circle-item circle-2"></i><i class="circle-item circle-3"></i></div>'.replace("${classSet}","circle-item-inmsg"))+'<div class="stream-msg stream-msg-typed" id="'+n.typedSelector+'"></div><div class="stream-msg-stop">'+lanRes.stopAnswer+"</div>":"")+("1"==t.endReason?'<div class="stream-msg-error"></div>':"2"==t.endReason?'<div class="stream-msg-interrupt"></div>':"")+"${listHtml}</div>"}(a)),a?1==a.answerType&&a.suggestions.length>0?(f+=a.answer||"",t=a.suggestions,p+='<div class="robot-tip">'+(e.tips||"")+"</div>"):1==a.answerType?f+=e.tips||"":2==a.answerType?(f+='<div class="robot-tip">'+(e.tips||"")+"</div>",f+=a.answer||"",t=a.relateKnowledges,p+='<div class="robot-tip margin-top10">'+(e.tipsExt||"")+"</div>"):3==a.answerType?(t=a.suggestions,p+='<div class="robot-tip">'+(e.tips||"")+"</div>"):4==a.answerType?f+=a.answer||"":5==a.answerType?(f+=a.answer||"",t=a.relateKnowledges,p+='<div class="robot-tip">'+(e.tips||"")+"</div>"):6==a.answerType&&(f+=a.answer||"",t=a.relateKnowledges,p+='<div class="robot-tip margin-top10">'+(e.tips||"")+"</div>"):f+=e.tips||"",t&&t.length){for(o=0;o<t.length;o++)p+='<li class="question-list-li" index="'+o+'" ><span class="list-style-dot">'+(o+1)+'. </span><span class="color-link">'+t[o].question+"</span></li>";p+="</ul>"}else p="";return n=_(e,a)||"",!(f=(f=C(k(f,e))).replace(/&nbsp;([^&\s])/g," $1"))&&p?((0,c.unBlockSendQuestionOld)(),(0,u.mergeFakeAnswer)(e)?"":'<div class="msg-item-robot">'+p+"</div>"+n):a&&12004==a.mt?(0,u.checkNeedTyping)(e,a)?(i.default.publish("getMsgRobotStream",a,{listHtml:p,feedback:n}),(0,u.mergeFakeAnswer)(e)?"":f.replace("${listHtml}","")):(0==e.isForward&&(0,u.removeFakeAnswer)(e,!0),0==e.isForward&&(0,c.unBlockSendQuestionOld)(),f.replace("${listHtml}",p)+n):(0,u.fakeTypewriter)(e,{id:(0,l.getMsgDomId)(e),str:f,wrap:'<div class="msg-item-robot">${content}</div>',listHtml:p,feedback:n})}if(5==e.type)try{var h,m=e.feedbackSubitem,g=e.feedback,v=r.default.getMsgByFilter((function(t){var n,o=t.data;return 12001==o.mt&&!(!(n=(0,c.getAnswerItem)(o))||n.robotDetailId!=e.robotDetailId)}));v.length&&(h=v[0].data),!h||h.allExtra.h5Extra.feedback==g&&h.allExtra.h5Extra.feedbackSubitem==m||(i.default.publish("setExtraMessage",h,{feedback:g,feedbackSubitem:m}),h.allExtra.h5Extra.feedback=g,h.allExtra.h5Extra.feedbackSubitem=m,s.default.updateMsg(h))}catch(e){console.log("处理反馈没有找到机器人消息",e)}return(f=(f=e.tip||e.tips||e.content)&&f.replace(/&nbsp;([^&\s])/g," $1"))?d?(0,u.fakeTypewriter)(e,{id:(0,l.getMsgDomId)(e),str:f,wrap:'<div class="msg-item-robot">${content}</div>'}):((0,u.checkEnableStreamInput)()?(0,u.removeFakeAnswer)(e):(0,c.unBlockSendQuestionOld)(),C(f)):f},127:$,902:$,push:function(e,t){var n=e.staffNickName||r.default.getStaff(e.staffId).name,o=[];return 1==e.allExtra.h5Extra.read&&(t[0]=t[0]+" unfold "),o.push('<div class="msg-leave" ><div class="msg-leave-title"><i class="msg-leave-i"></i><span class="msg-leave-t">'),o.push('<span class="color0">'+n+"&nbsp;</span>"),o.push(658==e.mt?lanRes.visitor174:4==e.chatInfoType?lanRes.staffLeave:lanRes.leaveStaffReply),o.push("</span></div>"),o.push('<div class="msg-leave-con" ><div class="msg-leave-content">'),o.push(S(i.default.HTMLDecode(e.brief))),o.push('</div><div class="msg-leave-dot">...</div><div class="msg-leave-link color0">'),o.push(lanRes.viewAll),o.push("</div></div></div>"),o.join("")},video:function(e){var t=e.localThumbnailPath||e.remoteThumbnailPath||e.videoThumbUrl;return'<div class="msg-video">'+(t?'<img class="msg-video-poster" onerror="_echat0.imgError(this)" src="'+t+'" '+(e.notEnd?"":'onload="javascript:_echat0.scrollToBottom()"')+'alt=""/>':'<div class="msg-video-poster" ></div>')+'<div class="msg-video-angle"></div>'+M(e,!1,!0)},voice:function(e){var t,n;return t=(n=parseInt((e.voiceDuration||e.duration||0)/1e3)||1)<4?60:15*n,'<div class="msg-voice" style="width:'+(t=Math.min(t,.75*window.innerWidth-40))+'px;"><span class="msg-voice-info">'+n+'"</span><i></i>'+M(e,!0,!0)},img:function(e){return'<div class="msg-imgs">'+w(e.smallImg||e.localFile,e.notEnd,e.customClass)+M(e,!1,!0)},file:function(e){var t=e.allExtra.nativeExtra||{},n=t.loadStatus,o=void 0===n?0:n,a=t.progress,i=void 0===a?0:a,r={0:lanRes.vis_55,1:lanRes.vis_56,2:i+"%",3:lanRes.vis_51,4:lanRes.vis_57};return'<div class="msg-file file-load-status'+o+'" ><div class="file-icon echat"></div><div class="file-info file-info-btn"><div class="file-name">'+e.fileName+'</div><div class="file-size">'+lanRes.vis_58+"（"+((parseInt((e.fileSize||0)/1024)||1)/1024).toFixed(3)+'M）</div></div><div class="file-load-bar clearfix"><div class="file-load-bar-info">'+r[o||0]+'</div><div class="file-load-progress"><div class="file-load-progress0" style="width:'+(i||0)+'%"></div></div></div></div>'+M(e,!1,!0)}}},181:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(26),n(3),n(11),n(10);var o=l(n(4)),a=l(n(8)),i=l(n(72));n(266),n(267),n(268);var r=l(n(42)),s=l(n(45));function l(e){return e&&e.__esModule?e:{default:e}}var c=r.default.callEchatNative;function u(){var e=$(this).attr("dataindex"),t=a.default.getConfig("config695").routeEntranceInfo.entranceDetails[parseInt(e)],n={routeId:t.routeId,routeEntranceTheme:t.theme,echatTag:t.routeEntranceEchatTag||t.theme};a.default.setVisitorInfo(n),o.default.triggerEventOnPoint("registChat",n),$("#router").remove(),$("#mask").hide()}function d(){var e=a.default.getVisitorInfo(),t=a.default.getStatusData();c("syncMessage",{action:"retrySync",companyId:e.companyId,talkId:t.talkId,talkType:t.talkType||s.default.talkTypeChat})}o.default.subscribe("displayRouterDom",(function(e,t){var n,r,s,l,c,d,f,p,h=0,m=t.lines,g=t.entranceDetails,v=t.routeEntranceType,y=o.default.Browser.isIOS&&o.default.Browser.osVersion<13,b='<div id="router" class="router '+(y?"":"slideUp")+" router-line"+m+'"><div id="routerTitle" class="router-title '+(t.title?"":"router-hide")+'">'+t.title+'</div><div id="routerList" class="router-list"><ul class="clearfix">';if($("#entry").addClass("hide"),$("#mask").show(),2==v)return function(e){$("body").append('<div id="router" class="router"></div>');var t=e.routeEntranceMulti.routeEntranceIcon||{};delete t.positionLevel,delete t.positionVertical;var n=$(".rr_guide_menu_box")[0];n&&n.remove();var i=new ServiceGuide({type:"3",config:e,isMobile:!0,backText:lanRes.back,callback:function(e){var t={routeId:e.routeId,routeEntranceTheme:e.name,echatTag:e.echatTag};a.default.setVisitorInfo(t),o.default.triggerEventOnPoint("registChat",t),$("#router").remove(),$("#mask").hide()},onChange:function(e){},container:document.getElementById("router")});i.init().style.cssText="",i.show()}(t);for(l=0;l<g.length;l++)n=++h%m==0,r=(s=g[l]).icon&&!s.content?1:s.icon&&s.content?2:!s.icon&&s.content?3:s.icon||s.content?"":3,o.default.needHttps&&s.icon&&(s.icon=s.icon.replace(/^http:/,o.default.needHttps)),b+='<li class="router-item router-item-content'+r+'" dataindex="'+l+'" '+(n?'style="border-right:none;"':"")+'><div class="router-item-content"><div class="router-item-icon '+(g[l].icon?"":"router-hide")+'">'+(g[l].icon?'<img onload="_echat0.checkImg&&_echat0.checkImg(this)" src="'+g[l].icon+'"/>':"")+'</div></div><div class="router-item-theme">'+g[l].theme+"</div></li>";b+="</ul></div></div>",$("body").append(b),$(".router-item").off("click").on("click",u),d=window.innerHeight||document.body.clientHeight,f=$("#routerList").height(),p=$("#routerTitle").height(),.8*d<f+p?($("#router").css({height:.8*d+"px"}),$("#routerList").css({height:.8*d-p+"px"}),c=i.default.initScroll("routerScroll","routerList"),setTimeout((function(){c.refresh()}),600)):$("#routerList").css({height:"auto"}),!y&&setTimeout((function(){$("#router").removeClass("slideUp")}),100)}));t.default={init:function(){o.default.Browser.isIOS&&$("body").addClass("ios"),$(".robot-staff-close").on("click",(function(){var e=this.parentNode;$(e).addClass("hide")})),$("#chat").on(o.default.clickName,".robot-staff",(function(){2==a.default.getStatusByKey("chatStatus")&&a.default.getStatusByKey("talkType")==s.default.talkTypeRobot&&o.default.publish("sendMessage",{et:131})})).on(o.default.clickName,".end-chat",(function(){o.default.publish("visitorClose")})).on(o.default.clickName,".to-leave-word",(function(){a.default.getStatusByKey("chatStatus")>0&&a.default.getStatusByKey("talkType")!=s.default.talkTypeLeave&&o.default.publish("sendMessage",{et:107,toLeaveWord:1},(function(){}))})),$(".leave-bar-btn").on("click",(function(){o.default.publish("restartChat")}))},reset:function(){$(".btn-qcode").addClass("hide"),$(".btn-close").addClass("hide")},setSyncMessageEvent:function(e){$(document).off(o.default.clickName,d),e&&$(document).on(o.default.clickName,d)}}},182:function(e,t,n){},183:function(e,t,n){},184:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getElementByFieldType=function(e,t,n,a,i){var r,s,l=o.default.Constants.validRule,c="",u={type1:'<input autocomplete="off" type="text" class="entry2-input {{req}}" maxlength="{{length}}" placeholder="{{wordDesc}}" lb="{{configDesc}}" name="{{configName}}" value="{{value}}"/>',type6b:'<input type="date" class="entry2-input {{req}}" placeholder="{{wordDesc}}" lb="{{configDesc}}" name="{{configName}}" value="{{value}}"/>',type6:'<div class="date-input-box"><input autocomplete="off" type="text" lb="{{configDesc}}" placeholder="{{wordDesc}}" class="entry2-input date-show"/><input type="date" lb="{{configDesc}}" placeholder="{{wordDesc}}" name="{{configName}}" value="{{value}}" class="entry2-input date-input"/><span class="date-select-icon echat-vs color0">&#xe638;</span></div>',type2:'<textarea autocomplete="off" class="entry2-textarea {{req}}" maxlength="{{length}}" rows="4" placeholder="{{wordDesc}}" lb="{{configDesc}}" name="{{configName}}" autoHeight="true">{{value}}</textarea>',type4:'<div class="entry2-checkbox"><label><input name="{{configName}}" value="{{configs.value}}" inputvalue="{{configs.item}}" lb="{{configDesc}}" type="radio" {{check}} /><span class="entry2-checkicon color0"></span><span>{{configs.item}}</span></label></div>',type5:'<div class="entry2-checkbox"><label><input name="{{configName}}" value="{{configs.value}}" inputvalue="{{configs.item}}" lb="{{configDesc}}" type="checkbox" {{check}} /><span class="entry2-checkicon color0"></span><span>{{configs.item}}</span></label></div>',type3:'<option value="{{configs.value}}" inputvalue="{{configs.item}}" {{check}} >{{configs.item}}</option>',type7:'<option value="{{configs.value}}" inputvalue="{{configs.item}}" {{check}} >{{configs.item}}</option>',type8:'<div class="entry2-log-upload" id="logUpload">'+lanRes.vis_67+"</div>",typeWorkOrder3:'<div class="entry2-select-option" name="{{configName}}" value="{{configs.value}}" inputvalue="{{configs.item}}" {{check}} >{{configs.item}}</div>',typeWorkOrder7:'<div class="entry2-select-option" name="{{configName}}" value="{{configs.value}}" inputvalue="{{configs.item}}" {{check}} >{{configs.item}}</div>'};function d(e,t){for(var n=0;n<e.length;n++)if(e[n]==t)return!0;return!1}if(c=u["type"+t],6==t&&(window.ltIE10||o.default.isMobile))c=u.type6b;else if(4==t||5==t||3==t||7==t){if(r=e[n.configName].configs,c=[],e[n.configName].valueOverlength&&!r)c.push('<select class="entry2-select {{req}}" name="{{configName}}" lb="{{configDesc}}"><option value="">{{wordDesc}}</option>');else{if(a=a?a.split(","):a,3==t||7==t){if(7==t){var f,p=[];for(f=r.start;f<=r.end&&(p.push({item:f,value:f}),150!=p.length);f+=r.stepSize);r=p}"workorder"===i?(c.push('<div class="entry2-select {{req}}" tabindex="0" >'),n.wordDesc?c.push('<div class="entry2-selected-item"><input value="" name="{{configName}}" lb="{{configDesc}}" />{{wordDesc}}</div><div lb="{{configDesc}}" class="entry2-select-dropdown">'):c.push('<div class="selected-item"><input value="" name="{{configName}}" lb="{{configDesc}}" />'+lanRes.pleaseSelect+'</div><div lb="{{configDesc}}" class="entry2-select-dropdown">')):(c.push('<select class="entry2-select {{req}}" value="" name="{{configName}}" lb="{{configDesc}}">'),n.wordDesc?c.push('<option value="" selected >{{wordDesc}}</option>'):c.push('<option value="" selected  >'+lanRes.pleaseSelect+"</option>"))}for(s=0;s<r.length;s++){var h=u["type"+t];h="workorder"===i&&u["typeWorkOrder"+t]||h,c.push(h.replace(/\{\{configs.item\}\}/g,r[s].item).replace("{{configs.value}}",r[s].value).replace("{{check}}",a&&d(a,r[s].value)?3==t||7==t?"selected":"checked":""))}}3!=t&&7!=t||c.push("workorder"===i?"</div></div>":"</select>"),c=c.join("")}else 1!=t&&2!=t||(c=c.replace("{{length}}",(l[n.configName]||l[1==t?"text":"textarea"]).length));return c},t.getFormItemValue=function(e,t,n){e=e||_$("entryForm");var o,a,i="",r="",s="",l="";n?t=e[n]:t&&(n=t.name);if(1!=t.nodeType){for(i=[],s=[],l=[],o=0;o<t.length;o++)t[o].checked&&(i.push(t[o].value),s.push($(t[o]).attr("lb")),l.push($(t[o]).attr("inputvalue")));r=$(t[0]).parents(".entry2-typeline").attr("lb"),i=i.join(","),s=s.join(","),l=l.join(",")}else if(r=$(t).attr("lb"),i=t.value.replace(/^[\s]+|[\s]+$/gi,""),"SELECT"==t.tagName)for(a=0;a<t.length;a++)if(t[a].value==i||t[a].getAttribute("value")==i){l=t[a].getAttribute("inputvalue"),s=$(t[a]).text();break}return{val:i,ipt:t,label:r,labelVal:s||i,inputValue:l}},t.resetOptionField=function(e,t,n,i){var r={},s={},l=[],c=[],u=[],d="workorder"===n?"/chatapi/jobh/dfd":"/chatapi/bfc/df",f=a.default.getApiDomain(),p=a.default.getVisitorInfo(),h=p.companyId,m=p.visitorId,g={companyId:h,requesterVisitorId:m};i&&(g.token=i.token,g.nonce=i.nonce);for(var v=0;v<e.length;v++)r[e[v].configName]=e[v].lan||"default";for(var y=0;y<t.length;y++)t[y].valueOverlength&&(s[t[y].field]=t[y],u.push(t[y].fieldId));u.length>0&&(g.fieldIds=u.join(","),$.ajax({url:f+d+"?"+o.default.addMapParams1(g),type:"jsonp",jsonpCB:"jsonpCallback",success:function(e){for(var t=0;t<e.length;t++){l=e[t].settings;for(var n=0;n<l.length;n++)if(r[e[t].field]===l[n].lan)for(var o in c=l[n].configs){var a="<option value='{{value}}' inputvalue='{{inputvalue}}'>{{inputvalue}}</option>";a=a.replace(/\{\{value\}\}/g,c[o].value).replace(/\{\{inputvalue\}\}/g,c[o].item),$("select[name="+e[t].field+"]").append(a)}}},error:function(){}}))},n(35),n(26),n(3),n(11);var o=i(n(4)),a=i(n(8));function i(e){return e&&e.__esModule?e:{default:e}}},185:function(e,t,n){"use strict";var o;n(26),n(32),n(10),function(e){var t,n,a,i={length:0,max:20},r=0,s=1;function l(e){var t=e.allExtra.nativeExtra||{};return{clientFileId:e.clientFileId,identityKey:e.identityKey,localFile:e.localFile||e.localVideoPath,fileType:e.fileType,sendStatus:e.sendStatus,progress:e.progress||0,fileUrl:t.sourceUrl||t.fileUrl||e.remoteVideoPath,fileSize:t.fileSize||100,fileName:t.fileName||(4==e.fileType?e.clientFileId+".mp4":e.clientFileId+".jpeg"),bucket:t.bucket,key:t.key,bigUrl:t.bigUrl,smallUrl:t.smallUrl,remoteThumbnailPath:t.videoThumbUrl||e.remoteThumbnailPath,localThumbnailPath:e.localThumbnailPath}}o={orderUploadData:i,resetOrderUploadData:function(){o.orderUploadData=i={length:0,max:20}},uploadSelector:"",paramData:{token:"",nonce:"",visitorId:"",companyId:"",apiServerDomain:"",interfaceVersion:0,isLogExist:0},setParamData:function(e){for(var t in e)o.paramData[t]=e[t]},setUtil:function(e){n=e},setNative:function(e){t=e},uploadLogsStatus:function(e){var t="ticket_"+o.paramData.companyId+"_"+o.orderOnlyId;if(e.id===t)if(window.orderUploadStatus=e.status,-1==e.status);else if(1==e.status)$(".order-fileslist").append('<div class="load orderUpload-item-log" dataindex="'+orderOnlyId+'" id="orderUpload'+orderOnlyId+'"><i class="orderfile-progress-num"></i><i class="orderfile-progress"></i></div>');else if(2==e.status)$(".orderfile-progress",document.getElementById("orderUpload"+orderOnlyId)).css("width",(e.progress||0)+"%");else if(3==e.status);else if(4==e.status&&e.result){var n=e.result;$("#orderUpload"+orderOnlyId).removeClass("load"),$("#orderUpload"+orderOnlyId).html('<a title="'+e.filename+'" download="'+e.filename+'" href="'+n.fileUrl+'" />'),window.uploadLogInfo={type:1,fileValue:{bucket:n.bucket,fileType:n.fileType,key:n.key,name:n.fileName,url:n.fileUrl}}}},getOrderParam:function(){return{token:o.paramData.token||"",nonce:o.paramData.nonce||"",companyId:o.paramData.companyId,visitorId:o.paramData.visitorId,apiServerDomain:o.paramData.apiServerDomain}},prepareAddOrderFile:(a=0,function(e){var t,n=l(e);i[n.clientFileId]||i.length++,i[n.clientFileId]=n,n.index=++a,t=4==n.fileType?'<img src="'+n.localThumbnailPath+'" alt="" onerror="this.className=\'video-img-err\'"/><span class="file-prev-video"><i>&#xe69a;</i></span>':'<img onerror="this.className=\'file-prev-img\'" src="'+n.localFile+'" alt=""/>',$("#orderUpload"+n.index).remove(),$(".order-fileslist").append('<div class="load orderUpload-item orderUpload-item-'+(4==n.fileType?"video":"img")+'" clientFileId="'+n.clientFileId+'" id="orderUpload'+a+'">'+t+'<span class="file-progress-bg"></span><span class="file-progress"></span></div>'),i.length>=i.max&&$(o.uploadSelector||".order-button").addClass("limit-hide")}),updateOrderFile:function(e){var t=l(e);if(t.sendStatus==s)return o.successOrderFile(t);var a=t.clientFileId,c=i[a];c&&t.sendStatus==r?(n.showTip(lanRes.uploadError||lanRes.visitor181),setTimeout((function(){o.removeOrderFile(t)}),2e3)):c&&(i[t.clientFileId]=$.extend(c,t),$(".file-progress",document.getElementById("orderUpload"+c.index)).css("width",t.progress+"%"))},successOrderFile:function(e){var t,a,s=l(e),c=s.clientFileId,u=i[c];if(u&&s.sendStatus==r)return n.showTip(lanRes.uploadError||lanRes.visitor181),void setTimeout((function(){o.removeOrderFile(s)}),2e3);u&&(i[c]=$.extend(u,s),t=document.getElementById("orderUpload"+u.index),$(".file-progress",t).remove(),$(".file-progress-bg",t).remove(),$("#orderUpload"+u.index).removeClass("load"),4!=s.fileType?(a=$("img",t)).hasClass("file-prev-img")&&a.removeClass("file-prev-img").attr("src",s.fileUrl):(a=$("img",t)).hasClass("video-img-err")&&a.removeClass("video-img-err").attr("src",s.remoteThumbnailPath),$("#orderUpload"+u.index).append('<a class="file-remove"></a>'))},removeOrderFile:function(e){var t=e.clientFileId,n=i[t];n&&(i.length--,$("#orderUpload"+n.index).remove(),i.length<i.max&&$(o.uploadSelector||".order-button").removeClass("limit-hide"),delete i[t])},getSubmitItems:function(e,t){var n,o,a=!0;if(t=t||[],e){for(n in i)if((o=i[n])&&o.index&&o.sendStatus==s){var r={type:1,fileValue:{url:o.fileUrl,name:o.fileName,size:o.fileSize,videoThumbUrl:o.remoteThumbnailPath,fileType:4==o.fileType?2:4,key:o.key,bucket:o.bucket}};e.push(r),t.push({type:r.fileValue.fileType,name:r.fileValue.name,fileType:r.fileValue.fileType,fileValue:r.fileValue})}else!o.fileUrl&&o.index&&(a=!1);return a}},bindOrderUpload:function(e,a){function r(e){var t=$(this.parentNode).attr("clientfileid"),a=i[t];a&&a.fileUrl?(n.showDialog({tip:lanRes.IsDel||lanRes.visitor191||"",ok:function(){var e=o.getOrderParam(),r={requesterVisitorId:e.visitorId,token:e.token||"",nonce:e.nonce||"",keys:JSON.stringify([a.key]),bucket:a.bucket};($._ajax||$.ajax)({url:e.apiServerDomain+"/chatapi/jobh/bdf?companyId="+e.companyId+n.addMapParams(r),type:$._ajax?"jsonp":"get",jsonpCB:"jsonpCallback",success:function(e){e&&e.successful?(n.showTip(lanRes.delSuccess||lanRes.visitor182||""),o.removeOrderFile(i[t])):n.showTip(e&&e.errorMsg||"删除失败")}})}}),e.preventDefault(),e.stopPropagation()):console.log("错误 没有文件可删除")}o.uploadSelector=e,$(a||"#orderUpload").hide(),$("#orderFileMenu").off("click").remove(),$("body").append('<div id="orderFileMenu" class="file-menu hide"><div class="file-menu-item" type="camera"><i class="color0">&#xe6fc;</i><span>'+lanRes.camera+'</span></div><div class="file-menu-item" type="gallery"><i class="color0">&#xe65e;</i><span>'+lanRes.gallery+"</span></div></div>"),$(e||".order-button").off("click").on("click",(function(){i.length>=i.max?n.showDialog({tip:lanRes.MaxFileNum||lanRes.visitor179,cancel:!1}):($("#orderFileMenu").removeClass("hide"),$("#orderMask").length||($("body").append('<div class="mask" id="orderMask" style="display:block;"></div>'),$("#orderMask").on("click",(function(){$("#orderFileMenu").addClass("hide"),$("#orderMask").off("click").remove()}))))})),$("#orderFileMenu").on("click",".file-menu-item",(function(e){var n=$(this).attr("type"),a=o.getOrderParam();t("uploadMedia",{visitorId:a.visitorId,companyId:a.companyId,token:a.token,nonce:a.nonce,type:n,maxNum:i.max-i.length}),$("#orderFileMenu").addClass("hide"),$("#orderMask").off("click").remove()})),$(".order-fileslist").on("click",".orderUpload-item-img",(function(e){var n=e.srcElement||e.target||{};if(-1!=n.className.indexOf("file-remove"))return r.call(n,e);var o=0,a=this,s=[];$(".orderUpload-item-img").each((function(e,t){var n=$(t).attr("clientfileid"),r=i[n],l=r.fileUrl,c=0;r.fileUrl||(c=1,l=r.localFile),r&&(s.push({bigImg:r.bigUrl||l,smallImg:r.smallUrl||l,sourceImg:r.fileUrl||l,fileName:r.fileName,identityKey:r.identityKey,clientFileId:r.clientFileId,localFile:r.localFile,isOrignal:c}),a==t&&(o=s.length))})),t("previewImage",{urls:s,current:o}),e.preventDefault(),e.stopPropagation()})),$(".order-fileslist").on("click",".orderUpload-item-video",(function(e){var n=e.srcElement||e.target||{};if(-1!=n.className.indexOf("file-remove"))return r.call(n,e);var o,a=$(this).attr("clientfileid"),s=i[a];t("video",{type:"play",clientFileId:s.clientFileId,url:s.fileUrl,localVideoPath:s.localFile,thumbUrl:s.localThumbnailPath||s.remoteThumbnailPath,downloadUrl:(o=s.fileUrl,o?o+(-1==o.indexOf("?")?"?":"&")+"attname="+encodeURIComponent(s.fileName):""),fileName:s.fileName})})),$(".order-fileslist").on("click",".orderUpload-item-log",(function(e){var t=e.srcElement||e.target||{};if(-1!=t.className.indexOf("file-remove"))return r.call(t,e)}))},__playVideo:function(e,n,o,a,i){t("video",{type:"play",identityKey:i||"",clientFileId:i||"",url:e,thumbUrl:n,downloadUrl:o,fileName:a||""})},orderOnlyId:"",__uploadLogs:function(e,n){var a=o.getOrderParam();o.orderOnlyId=e,t("uploadLogs",{id:"ticket_"+a.companyId+"_"+e,from:n,visitorId:a.visitorId,companyId:a.companyId,token:a.token,nonce:a.nonce})}}}(),window.fileUtil=o},186:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=s(n(42)),a=s(n(4)),i=n(16),r=s(n(8));function s(e){return e&&e.__esModule?e:{default:e}}var l,c=o.default.callEchatNative,u="";l={isGaodeMapExist:function(e){e+""!="true"&&$(".menu-map").addClass("hide").addClass("limit-hide")},closeChat:function(e){a.default.publish("visitorClose",1==e?1:0)},switchSoundTip:function(e){},triggerFile:function(e){a.default.publish("triggerFile",e)},voice:function(e){a.default.publish("recordEvent",e)},uploadType:function(e){if(e){var t=2,n=document.getElementById("uploadInput");"record"==e?t=4:"gallery"==e?t=2:"voice"==e&&(t=3),$(n).attr("filetype",t)}},location:function(e){var t=e.provinceName,n=void 0===t?"":t,o=e.cityName,i=void 0===o?"":o,r=e.adName,s=void 0===r?"":r,l=e.address,c=void 0===l?"":l,u={id:(new Date).getTime(),et:127,locationX:e.latitude,locationY:e.longitude,scale:parseInt(e.zoom||15),label:e.title,address:n+i+s+c};a.default.triggerEventOnPoint("_sendMsgLocation",u)},keyboardHeight:function(e){a.default.publish("keyboardHeight",e)},networkChangeStatus:function(e){var t=r.default.getDataByName("netConnected");e&&0==e.networkType?(0,i.networkStatusChange)(!1):t||c("checkNetworkStatus",{pingIp:void 0,url:void 0})},networkStatus:function(e){var t=e.isConnected,n=e.error,o=t==a.default.Constants.netConnected,s=r.default.getDataByName("netConnected");if(1==n)return console.log("检查网络传参数错误");(0,i.networkStatusChange)(o),o&&!s&&!s&&c("checkWebsocketStatus")},websocketStatus:function(e){var t=e.type;r.default.setDataByName("websocketStatus",t),a.default.Constants.websocketConnecting,t!=a.default.Constants.websocketStoped&&t!=a.default.Constants.websocketNotConnect||a.default.publish("removeLoading"),(0,i.websocketStatusChange)(t)},callbackOpenFile:function(e){"0"==e.status&&a.default.showTip(lanRes.vis_16)},downloadProgress:function(e){a.default.publish("downloadEvent",e)},uploadLogsStatus:function(e){a.default.publish("uploadLogsStatus",e)}},o.default.initNativeAPI(l,"callEchatJs"),a.default.subscribe("__chatStatus",(function(e,t){})),a.default.subscribe("__evaluate",(function(e,t){c("visitorEvaluate",t)})),a.default.subscribe("_closeWin",(function(e,t){r.default.getStatusByKey("visitorClose")&&c("destoryView")})),a.default.subscribe("_changeCloseBtn",(function(e,t){c("changeCloseBtnStatus",t||"0")})),a.default.subscribe("__setTitle",(function(e,t){r.default.getConfig("companyVersionType")===a.default.Constants.companyCommon&&c("setTitle",u=t||" ")})),a.default.subscribe("__setTitleTyping",(function(e,t){c("setTitle",t)})),a.default.subscribe("__clearTitleTyping",(function(){c("setTitle",u)})),a.default.subscribe("__setTitleShop",(function(e,t){"string"==typeof t.title&&(u=t.title||" ",c("setTitle",u)),"string"==typeof t.logo&&c("setLogo",t.logo),void 0!==t.shopEnter&&c("setShopEnter",t.shopEnter)})),a.default.subscribe("_checkNetworkStatus",(function(e,t){c("checkNetworkStatus",{pingIp:void 0,url:void 0})})),a.default.subscribe("_checkWebsocketStatus",(function(e,t){c("checkWebsocketStatus")})),a.default.subscribe("__jumpToUrl",(function(e,t){c("jumpToUrl",t)})),a.default.subscribe("__openWebsocket",(function(e){c("openWebsocket")}));t.default=l},202:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(203);var o=r(n(204)),a=r(n(271)),i=r(n(105));function r(e){return e&&e.__esModule?e:{default:e}}window.addEventListener("load",(function(){i.default.init(),a.default.pageReady(),o.default.pageReady()}));t.default={}},203:function(e,t,n){},204:function(e,t,n){"use strict";n(60),n(51),n(61),n(44),n(52),n(62),n(19),n(128),n(21),n(53),n(30),n(31),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(25),n(33),n(39),n(34),n(32),n(15),n(3),n(40),n(22),n(170),n(41),n(10);var o=h(n(4)),a=h(n(45)),i=h(n(8)),r=h(n(55)),s=n(16),l=h(n(105)),c=h(n(108)),u=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=v(e)&&"function"!=typeof e)return{default:e};var n=p(t);if(n&&n.has(e))return n.get(e);var o={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&{}.hasOwnProperty.call(e,i)){var r=a?Object.getOwnPropertyDescriptor(e,i):null;r&&(r.get||r.set)?Object.defineProperty(o,i,r):o[i]=e[i]}return o.default=e,n&&n.set(e,o),o}(n(104)),d=h(n(270)),f=n(107);function p(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(p=function(e){return e?n:t})(e)}function h(e){return e&&e.__esModule?e:{default:e}}function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function g(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=v(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=v(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==v(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function v(e){return(v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var y,b={pageReady:function(){o.default.subscribe("sendInitVisEvt",(function(){if(o.default.unSubscribe("sendInitVisEvt"),2===i.default.getStatusData().chatStatus){var e=i.default.getVisitorInfo().visEvt;e&&("object"===v(e)&&(e=JSON.stringify(e)),b.publish("sendMessage",{et:126,dedup:1,visEvt:e}))}}))}};function S(){var e=i.default.getStatusData(),t=2==e.chatStatus,n=i.default.getConfig("busyCanSend");return(0,s.handOpenWs)(1),!(0,f.isStreamGenerating)(!0)&&!(0,u.checkBlockSendQuestionOld)()&&(e.talkType==a.default.talkTypeQueue&&t&&!n?(o.default.publish("changeDom",{name:"#busyTipLine",removeCls:"hide"}),!1):(i.default.getDataByName("netConnected")||o.default.showTip(lanRes.vis_43),t||o.default.showDialog({tip:lanRes.vis_52,ok:function(){o.default.publish("restartChat"),r.default.removeMsg({id:"restartChat"})}}),t))}function T(e,t){var n=i.default.getStatusByKey("talkType");y==o.default.Constants.talkTypeQueue&&n==o.default.Constants.talkTypeChat||o.default.publish("setTheme",t),n!=o.default.Constants.talkTypeRobot&&o.default.publish("endRobot"),o.default.publish("setUrlList"),o.default.publish("setCustomList"),o.default.publish("_changeCloseBtn","1"),r.default.removeMsg({id:"restartChat"}),y=n}o.default.subscriber.call(b,"handle"),b.setSub("connect"),u.default.init(b),d.default.init(b),o.default.publish("_checkNetworkStatus"),o.default.addEventPoint("registChat",{once:!1,check:function(e){var t=i.default.getStatusData();return 0===t.chatStatus||1===t.chatStatus||-1===t.chatStatus||(!(2!=t.chatStatus||t.talkType!=o.default.Constants.talkTypeRobot||!e||!e.robotToHumanKey)||void 0)},callback:function(e){o.default.unSubscribe("sendInitVisEvt");var t,n=i.default.getVisitorInfo(),a=n.visEvt,r=n.routeEntranceId;t={et:109,media:6,osName:o.default.queryParams.osName||o.default.Device.OS,osVersion:o.default.queryParams.osVersion||"1",browserName:o.default.queryParams.browserName||"webview",browserVersion:"1",myData:n.myData,screenResolution:window.screen.width+"x"+window.screen.height,routeId:n.routeId,echatTag:n.echatTag,chatLaunchFrom:n.chatLaunchFrom,acdType:n.acdType,acdStaffId:n.acdStaffId,fm:n.fm,visEvt:a},r&&(t.routeEntranceId=r,i.default.setVisitorInfo({routeEntranceId:void 0,lastRouteEntranceId:r})),e&&$.extend(t,e),console.log("***注册对话了****"),i.default.setStatusByKey("unreadCount",0),b.publish("sendMessage",t),o.default.publish("_changeCloseBtn","0")}}),o.default.subscribe("visitorClose",(function(e,t){function n(){i.default.setStatusData({visitorClose:!0}),2==i.default.getStatusData().chatStatus?o.default.publish("_endChat"):o.default.publish("chatEnded")}if(1===t||i.default.getStatusData().chatStatus<1)return n();o.default.showDialog({tip:i.default.getStatusData().isInWorkOrder?lanRes.visitor188:lanRes.closeTip,ok:n,cancel:function(){i.default.setStatusData({visitorClose:!1})}})})),o.default.addEventPoint("_sendMsgLocation",{once:!1,check:S,callback:c.default}),o.default.addEventPoint("_sendMsg",{once:!1,check:S,callback:function(e){var t,n,o=i.default.getStatusData(),r=2==o.chatStatus&&o.talkType==a.default.talkTypeRobot;(n=e||l.default.input.getInput(!0)).trim()&&(n.match(/^\[#echat::lihong#\]$/),l.default.input.plainText&&(n=(0,s.plainTextToSendMsg)(n)),t={data:{content:n,et:r?130:105},filterMsg:!1},(0,c.default)(t))}}),b.subscribe("displayRouter",(function(e,t){var n=i.default.formatRouteList();if(n){var a=n.chatBoxTitle||lanRes.onlineService;i.default.setConfig("pageTitle",a),o.default.publish("__setTitle",a),i.default.setStatusByKey("statusName","router"),o.default.publish("__chatStatus","router"),o.default.publish("displayRouterDom",n)}else o.default.triggerEventOnPoint("registChat")})),b.subscribe("waitingChat",(function(e,t){var n={isInWorkOrder:!1,isInEntryOrCode:!1},a=i.default.getStatusData();if(!(i.default.getStatusByKey("unreadCount")>0)){if(4==a.status&&t.jobWindowInfo)n.isInWorkOrder=!0,o.default.publish("enterWorkorder",t),i.default.setStatusByKey("statusName","workorder"),o.default.publish("__chatStatus","workorder");else if(i.default.getEntryInfo(t))o.default.publish("displayEntryDom",t),n.isInEntryOrCode=!0,i.default.setStatusByKey("statusName","entry"),o.default.publish("__chatStatus","entry"),o.default.publish("setChatStatus",1);else if(i.default.getStatusByKey("captChaToken"))o.default.publish("displayCode",{captChaToken:i.default.getStatusByKey("captChaToken")}),n.isInEntryOrCode=!0,i.default.setStatusByKey("statusName","entry"),o.default.publish("__chatStatus","entry"),o.default.publish("setChatStatus",1);else if(1!=a.canChatNow){var r=i.default.getLeaveConfig(t);2===i.default.getStatusData().status&&r&&(c=(l=r).thirdPartyUrl,l&&2==l.enable&&c?(o.default.publish("__chatStatus","leaveToUrl"),i.default.setStatusByKey("statusName","end"),c=(0,s.getADURL)(1==l.enableThirdPartyParams,l.thirdPartyParams,c),o.default.publish("__jumpToUrl",c),$("body").html("")):(2==l.enable&&!c||0==l.enable)&&(o.default.publish("__chatStatus","leaveDisabled"),i.default.setStatusByKey("statusName","end"),o.default.publish("leaveDisabled",l)))}var l,c;i.default.setStatusData(n)}})),b.subscribe("startLeave",(function(e){o.default.publish("__setTitle",lanRes.leaveWord),i.default.setStatusByKey("statusName","leaveService"),o.default.publish("__chatStatus","leaveService");var t=i.default.getStatusByKey("visitorEntryInput");t.entryVisitorMsg&&b.publish("sendMessage",{et:105,isSave:0,content:t.entryVisitorMsg}),t.entryLeaveContent&&(b.publish("sendMessage",{et:105,isSave:0,content:t.entryLeaveContent}),setTimeout((function(){o.default.publish("_endChat")}),100))})),b.subscribe("_endChat",(function(e,t){b.publish("sendMessage",{et:107})})),b.subscribe("startSession",T),b.subscribe("startRobot",T),b.subscribe("startLeave",T),b.subscribe("startChat",T),b.subscribe("startQueue",T),b.subscribe("chatEnded",(function(e,t,n){var a=t?1==t.closeReason:i.default.getStatusByKey("visitorClose"),s=n||i.default.getStatusData(),l=i.default.getVisitorInfo(),c=t||{},u=1==c.changeRoute||1==c.closeTag,d=2==s.chatStatus&&s.talkType==o.default.Constants.talkTypeChat,f=!u&&d&&i.default.getNativeH5DataByKey("satisfyLastTalkId")!=s.talkId;y=0,o.default.publish("clearSendingMsg","endchat"),o.default.publish("endRobot"),b.unSubscribe("getMsgTyping"),b.unSubscribe("clearMsgTyping"),b.unSubscribe("textInputChangeEvt"),r.default.removeMsg({id:"restartChat"}),!c.unreadCount&&r.default.showMsg({id:"restartChat",mt:20,tm:(new Date).getTime(),content:'<span class="btn-restart">'+lanRes.toContinueChat+"</span>"}),1!=c.changeRoute&&o.default.publish("_changeCloseBtn","0"),f&&o.default.publish("showSatisfy",1),f=f&&i.default.getStatusByKey("hasSatisfy"),o.default.publish("__chatStatus","end-"+(c.closeReason||"0")+"-"+(f?1:0)),i.default.setStatusByKey("statusName","end"),i.default.setStatusByKey("sendMsgNum",0),i.default.setStatusData({visitorClose:a,sendMsgNum:0,chatStatus:0,staffId:""}),l.lastRouteEntranceId&&i.default.setVisitorInfo({routeEntranceId:l.lastRouteEntranceId}),l.fm&&i.default.setVisitorInfo({fm:void 0}),!a||u||f||1==c.toLeaveWord?1==c.toLeaveWord&&setTimeout((function(){o.default.publish("restartChat",{toLeaveWord:1}),r.default.removeMsg({id:"restartChat"})}),100):o.default.publish("_closeWin"),delete o.default.queryParams.autoPop,delete o.default.queryParams.autoChat,o.default.publish("__setTitle","")})),o.default.subscribe("restartChat",(function(e,t){t=t||{},(0,s.handleNetwork)(),(0,s.openWsAndRegist)();var n=i.default.getConfig("config672")||{};i.default.getStatusByKey("chatStatus")>=2||o.default.triggerEventOnPoint("registChat",function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){g(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({nonce:n.nonce,reChatTag:n.reChatTag},t))})),o.default.subscribe("_addSendMsgNum",(function(e,t){var n=i.default.getStatusByKey("sendMsgNum");i.default.setStatusByKey("sendMsgNum",n+1),o.default.publish("initEvaluate",t)}));t.default=b},233:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(54),n(35),n(174),n(135),n(32),n(238),n(15),n(63),n(69),n(3),n(71),n(87),n(50),n(22),n(11),n(239),n(10);var o,a=(o=n(242))&&o.__esModule?o:{default:o};var i=function(){var e,t,n,o,i,r,s,l,c,u,d,f,p,h,m,g,v,y,b,S=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,T=/^[^{]+\{\s*\[native \w/,w=/[\t\r\n\f]/g,k=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,I=/\S+/g,C={find:{},filter:{}},x=window.document,E=window.document,$="echatQuery"+1*new Date,D={},M=[],_=M.slice,P=M.push,N=new RegExp("\\\\([\\da-f]{1,6}[\\x20\\t\\r\\n\\f]?|([\\x20\\t\\r\\n\\f])|.)","ig"),B=function(e,t,n){var o="0x"+t-65536;return o!==o||n?t:o<0?String.fromCharCode(o+65536):String.fromCharCode(o>>10|55296,1023&o|56320)},O=function(){o()},L=1,R={},A={},j="onfocusin"in window,F={focus:"focusin",blur:"focusout"},U={mouseenter:"mouseover",mouseleave:"mouseout"},H=/^-ms-/,V=/-([\da-z])/gi,K=function(e){return e.replace(H,"ms-").replace(V,(function(e,t){return t.toUpperCase()}))},W={},q=W.toString,z=0,Y=/(\=)\?(&|$)|\?\?/i,X=function(){return!0},Q=function(){return!1},J=/^([A-Z]|returnValue$|layer[XY]$)/,G={preventDefault:"isDefaultPrevented",stopImmediatePropagation:"isImmediatePropagationStopped",stopPropagation:"isPropagationStopped"};function Z(e){return e._zid||(e._zid=L++)}function ee(e){E.createElement;var t=E.createElement("div");try{return!!e(t)}catch(e){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function te(e,t,n){var a=t&&t.ownerDocument;return n=n||[],e?e.nodeType||e==window.document||e==window?(this.context=e,this.results=[e],this.length=1,this):l(e)?void 0!==p?this.readyList.push(e):e():e instanceof te?e:((t?t.ownerDocument||t:x)!==E&&o(t),t=t||E,this.selector=e,this.context=t,this.results=i(e,t,n,a),void(this.length=this.results.length)):(this.length=0,this.results=this.results||n,this)}function ne(e){return"object"==function(e){return null==e?String(e):W[q.call(e)]||"object"}(e)}function oe(e,t,n){for(var o in t)n&&(d(t[o])||c(t[o]))?(d(t[o])&&!d(e[o])&&(e[o]={}),c(t[o])&&!c(e[o])&&(e[o]=[]),oe(e[o],t[o],n)):void 0!==t[o]&&(e[o]=t[o])}function ae(e){var t=(""+e).split(".");return{e:t[0],ns:t.slice(1).sort().join(" ")}}function ie(e,t,n,o){t=ae(t);var a,i,r,s,l,c=R[Z(e)]||[];for(t.ns&&(s=t.ns,a=new RegExp("(?:^| )"+s.replace(" "," .* ?")+"(?: |$)")),i=[],r=0;r<c.length;r++)!(l=c[r])||t.e&&l.e!=t.e||t.ns&&!a.test(l.ns)||n&&Z(l.fn)!==Z(n)||o&&l.sel!=o||i.push(c[r]);return i}function re(e,t){return e.del&&!j&&e.e in F||!!t}function se(e){return U[e]||j&&F[e]||e}function le(t,n,o,a,i,r,s){var l,c=Z(t),u=R[c]||(R[c]=[]);e.fn.each(n.split(/\s/),(function(n,c){if("ready"==c)return e(E).ready(m);var d=ae(c);d.fn=o,d.sel=i,d.e in U&&(o=function(t){var n=t.relatedTarget;if(!n||n!==this&&!e.contains(this,n))return d.fn.apply(this,arguments)}),d.del=r,l=r||o,d.proxy=function(e){if(!(e=g(e)).isImmediatePropagationStopped()){a&&(e.data=a);var n=l.apply(t,null==e._args?[e]:[e].concat(e._args));return!1===n&&(e.preventDefault(),e.stopPropagation()),n}},d.i=u.length,u.push(d),"addEventListener"in t?t.addEventListener(se(d.e),d.proxy,re(d,s)):t.attachEvent("on"+se(d.e),d.proxy)}))}function ce(t,n,o,a,i){var r=Z(t);e.fn.each((n||"").split(/\s/),(function(n,s){e.fn.each(ie(t,s,o,a),(function(e,n){delete R[r][n.i],"removeEventListener"in t?t.removeEventListener(se(n.e),n.proxy,re(n,i)):t.detachEvent("on"+se(n.e),n.proxy)}))}))}function ue(e){var t,n={originalEvent:e};for(t in e)J.test(t)||void 0===e[t]||(n[t]=e[t]);return g(n,e)}function de(){}return r={TAG:function(e){var t=e.replace(N,B).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=new RegExp("(^|[\\x20\\t\\r\\n\\f])"+e+"([\\x20\\t\\r\\n\\f]|$)");return function(e){return t.test("string"==typeof e.className&&e.className||void 0!==e.getAttribute&&e.getAttribute("class")||"")}}},D.getElementsByTagName=ee((function(e){return e.appendChild(E.createComment("")),!e.getElementsByTagName("*").length})),(o=function(e){var o,a,i=e?e.ownerDocument||e:x;return i===E||9!==i.nodeType||i.documentElement,t=(E=i).documentElement,(a=E.defaultView)&&a.top!==a&&(a.addEventListener?a.addEventListener("unload",O,!1):a.attachEvent&&a.attachEvent("onunload",O)),D.attributes=ee((function(e){return e.className="i",!e.getAttribute("className")})),D.getElementsByTagName=ee((function(e){return e.appendChild(E.createComment("")),!e.getElementsByTagName("*").length})),D.getElementsByClassName=T.test(i.getElementsByClassName),D.getById=ee((function(e){return t.appendChild(e).id=$,!E.getElementsByName||!E.getElementsByName($).length})),D.getById?(C.find.ID=function(e,t){if(void 0!==t.getElementById){var n=t.getElementById(e);return n?[n]:[]}},C.filter.ID=function(e){var t=e.replace(N,B);return function(e){return e.getAttribute("id")===t}}):(delete C.find.ID,C.filter.ID=function(e){var t=e.replace(N,B);return function(e){var n=void 0!==e.getAttributeNode&&e.getAttributeNode("id");return n&&n.value===t}}),D.qsa=T.test(i.querySelectorAll),C.find.TAG=D.getElementsByTagName?function(e,t){return void 0!==t.getElementsByTagName?t.getElementsByTagName(e):D.qsa?t.querySelectorAll(e):void 0}:function(e,t){for(var o,a=[],i=0,r=x.getElementsByTagName(e);o=r[i++];)1===o.nodeType&&n(t,o)&&a.push(o);return a},C.find.CLASS=D.getElementsByClassName&&function(e,t){if(void 0!==t.getElementsByClassName&&documentIsHTML)return t.getElementsByClassName(e)},o=T.test(t.compareDocumentPosition),n=o||T.test(t.contains)?function(e,t){if(!e||!t)return!1;var n=9===e.nodeType?e.documentElement:e,o=t&&t.parentNode;return e===o||!(!o||1!==o.nodeType||!(n.contains?n.contains(o):e.compareDocumentPosition&&16&e.compareDocumentPosition(o)))}:function(e,t){if(!e)return!1;if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},i})(),i=function(e,t,o,a){if(!e)return o;var i,s,l,c,u,d,f,p,h,m=t?t.nodeType:9;if(c=S.exec(e),11!==m&&(c=S.exec(e)))if(i=c[1]){if(9===m){if(!(l=t.getElementById(i)))return o;if(l.id===i)return o.push(l),o}else if(t.ownerDocument&&(l=t.ownerDocument.getElementById(i))&&n(t,l)&&l.id===i)return o.push(l),o}else{if(i=c[2])return(d=C.find.TAG(i,t))&&P.apply(o,d),o;if((i=c[3])&&D.getElementsByClassName&&t.getElementsByClassName)return P.apply(o,t.getElementsByClassName(i)),o}if(1!==m&&(a=t,u=e),u)try{return P.apply(o,a.querySelectorAll(u)),o}catch(e){}if(f=(d=C.find.TAG("*",t)).length,s=0,p=c[2]){if(h=[],o=t.getElementsByTagName(p),l=void 0,"*"===p){for(;l=o[s++];)1===l.nodeType&&h.push(l);return h}return o}for(matches=(0,r.CLASS)(c[3]),s=0;s!==f&&null!=(l=d[s]);s++)l&&1===l.nodeType&&matches(l)&&o.push(l);return o},(e=function(e,t,n){return new te(e,t)}).ajaxJSONP=function(t,n){if(!("type"in t))return e.ajax(t);var o,a,i,r,s,c,u=t.jsonpCallback,d=(l(u)?u():u)||"jsonp"+ ++z,f=E.createElement("script"),p=window[d],h=function(n){t.errorSwitch?t.errorSwitch():a({type:"error",timeout:1}),e(script).triggerHandler("error",n||"abort")},m={abort:h};if(n&&n.promise(m),a=function(a,i){e(f).remove(),a&&"error"==a.type||!o?t.error&&t.error(null,i||"error",m,t,n):t.success&&t.success(o[0],m,t,n),window[d]=p,o&&l(p)&&p(o[0]),p=o=void 0},window[d]=function(){o=arguments},i="$1"+d+"$2",t.url=t.url.replace(Y,i),r="",t.data){for(s in t.data)c="string"==typeof t.data[s]?t.data[s]:JSON.stringify(t.data[s]),r="&"+s+"="+encodeURIComponent(c);r&&(r=r.substring(1),r+="&")}return t.url+=(/\?/.test(t.url)?"&":"?")+r+(t.jsonpCB||"jsonp")+"="+d,"onload"in f?(f.onload=a,f.onerror=function(){a({type:"error"})}):f.onreadystatechange=function(){/loaded|complete/.test(f.readyState)&&a()},t.beforeSend&&!1===t.beforeSend(m)?(console.log("abort",t),m):(f.src=t.url,E.getElementsByTagName("head")[0].appendChild(f),t.timeout>0&&(abortTimeout=setTimeout((function(){h("timeout"),m.isTimeout=1}),t.timeout)),m)},e.ajax=e._ajax=function(t){if("jsonp"==t.jsonp||"JSONP"==t.jsonp||"jsonp"==t.type||"JSONP"==t.type)return e.ajaxJSONP(t,t.deferred);var n,o,a,i=function(){var e,t,n;try{e=new XMLHttpRequest}catch(o){for(t=["Msxml3.XMLHTTP","Msxml2.XMLHTTP","Microsoft.XMLHTTP"],n=0,len=t.length;n<len;n++)try{e=new ActiveXObject(t[n]);break}catch(e){continue}}return e}(),r=t.data,s="";if(i.onreadystatechange=function(){4==i.readyState&&(200==i.status?t.success&&t.success(i.responseText):0==i.status&&t.errorSwitch?t.errorSwitch():t.error&&t.error(i,i.responseText))},r&&"[object object]"==Object.prototype.toString.apply(r).toLowerCase())for(n in r)s+="&"+n+"="+encodeURIComponent(r[n]);s&&t.type.match(/get/i)&&(-1!=t.url.indexOf("?")?t.url+=s:t.url+="?"+s.substring(1),s="",r=null),window.XMLHttpRequest?r||(r=null):r||(r=void 0),i.open(t.type.toUpperCase(),t.url,!0),t.timeout&&(i.timeout=t.timeout);try{if(t.xhrFields)for(o in t.xhrFields)i[o]=t.xhrFields[o]}catch(e){}if(t.header)for(a in t.header)i.setRequestHeader(a,t.header[a]);t.header&&(t.header["Content-Type"]||t.header["Content-type"]||t.header["content-type"])&&!1===t.contentType||i.setRequestHeader("Content-type",t.contentType||"application/json;charset=UTF-8;"),t.beforeSend&&t.beforeSend(i),i.send(s?s.substring(1):r)},(v=E.createElement("div")).innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",y=(y=(b=v.getElementsByTagName("a")[0])&&b.style).cssText="float:left;opacity:.5",s={float:y.cssFloat?"cssFloat":"styleFloat"},v=null,b=null,l=function(e){return null!=e&&("function"==typeof e||"[object Function]"===Object.prototype.toString.call(e))},c=function(e){return"[object Array]"===Object.prototype.toString.apply(e)},u=function(e){return"string"==typeof e},d=function(e){return ne(e)&&!function(e){return null!=e&&e==e.window}(e)&&Object.getPrototypeOf(e)==Object.prototype},f=function(e){return null==e?"":(e+"").replace(k,"")},e.extend=function(e,t,n){for(var o in t)n&&(d(t[o])||c(t[o]))?(d(t[o])&&!d(e[o])&&(e[o]={}),c(t[o])&&!c(e[o])&&(e[o]=[]),oe(e[o],t[o],n)):void 0!==t[o]&&(e[o]=t[o]);return e},e.cookie=function(t,n,o){var a,i,r,s,l,c;if(arguments.length>1&&(!/Object/.test(Object.prototype.toString.call(n))||null==n))return o=e.extend({},o),null==n&&(o.expires=-1),"number"==typeof o.expires&&(a=o.expires,(i=o.expires=new Date).setDate(i.getDate()+a)),n=String(n),E.cookie=[encodeURIComponent(t),"=",o.raw?n:encodeURIComponent(n),o.expires?"; expires="+o.expires.toUTCString():"","; path="+(o.path||"/"),o.domain?"; domain="+o.domain:"",o.secure?"; secure":""].join("");for(r=(o=n||{}).raw?function(e){return e}:decodeURIComponent,s=E.cookie.split("; "),c=0;l=s[c]&&s[c].split("=");c++)if(r(l[0])===t)return r(l[1]||"");return null},e.toJSON=JSON.stringify,h={src:!0,href:!0},m={isFunction:l,isArray:c,isString:u,isObject:ne,isPlainObject:d,trim:f,contains:n,readyList:[],find:function(e){var t={};return this.each((function(n,o){te.call(t,e,o,t.results)})),t},match:function(e,t){var o=new te(t),a=null;return o.each((function(t,o){if(o==e||n(o,e))return a=o,!0})),a},parents:function(e){var t,n,o,a,i,r;if(e&&this.results&&this.results.length>0&&(t=S.exec(e))&&((i=t[1])?n=function(e){return e.id==i}:(i=t[2])?(i=i.toUpperCase(),n=function(e){return e.tagName==i}):(i=t[3])&&(n=function(e){if(e.className){var t=e.className.split(" ");for(r=0;r<t.length;r++)if(t[r]==i)return!0;return!1}}),n))for(o=this.results[0];a=o.parentNode;){if(n(a))return new te(a,this.context,[]);o=a}return new te(null,this.context,[])},html:function(e){return e||""===e?this.each((function(t,n){n.innerHTML=e})):this.results&&this.results[0]?this.results[0].innerHTML:null},text:function(e){return"string"==typeof e?this.each((function(t,n){"string"==typeof n.textContent?n.textContent=e:n.innerText=e})):this.results&&this.results[0]?this.results[0].textContent||this.results[0].innerText:null},append:function(e){if(e){if(u(e)){var t,n=E.createElement("div");n.innerHTML=e,t=n.childNodes,this.each((function(e,n){for(var o,a=0;o=t[a++];)1==o.nodeType&&(o=o.cloneNode(!0),n.appendChild(o))}))}else this.each((function(t,n){n.appendChild(e)}));return this}},insertBefore:function(e,t){var n,o,a;if(e)return u(e)?((o=E.createElement("div")).innerHTML=e,a=o.childNodes,this.each((function(e,o){for(var i,r=0;i=a[r++];)1==i.nodeType&&(i=i.cloneNode(!0),(n=t||o.childNodes[0])?o.insertBefore(i,n):o.appendChild(i))}))):this.each((function(o,a){(n=t||a.childNodes[0])?a.insertBefore(e,n):a.appendChild(e)})),this},show:function(){return this.each((function(e,t){t.style.display="block"})),this},hide:function(){return this.each((function(e,t){t.style.display="none"})),this},removeClass:function(e){for(var t,n,o,a,i=this.results.length,r=0,s=0,l=(e||"").match(I)||[];s<i;s++)if(n=1===(t=this.results[s]).nodeType&&(t.className?(" "+t.className+" ").replace(w," "):"")){for(r=0;o=l[r++];)for(;n.indexOf(" "+o+" ")>=0;)n=n.replace(" "+o+" "," ");a=e?f(n):"",t.className!==a&&(t.className=a)}else t.className="";return this},addClass:function(e){for(var t,n,o,a,i=this.results.length,r=0,s=0,l=(e||"").match(I)||[];s<i;s++)if(n=1===(t=this.results[s]).nodeType&&(t.className?(" "+t.className+" ").replace(w," "):"")){for(r=0;o=l[r++];)for(;n.indexOf(" "+o+" ")<0;)n+=o+" ";a=e?f(n):"",t.className!==a&&(t.className=a)}else t.className=e;return this},attr:function(e,t){if(!e)return this;var n,o,a,i;if(void 0===t){if("string"==typeof e)return this.results&&this.results.length>0?this.getAttr(this.results[0],e):"";for(n in o=this.results?this.results.length:0,e)for(i=0;i<o;i++)a=this.results[i],h[n]?a[n]=e[n]:a.setAttribute(n+"",e[n])}else for(o=this.results?this.results.length:0,i=0;i<o;i++)(a=this.results[i]).setAttribute(e,t),h[e]?a[e]=t:a.setAttribute(e,t);return this},css:function(e,t){if(!e)return this;var n,o,a,i,r;if(void 0===t)if("string"==typeof e)this.css(e,0===t?"0":"inherit");else for(o=this.results?this.results.length:0,i=0;i<o;i++)for(n in e){r=K(n),r=s[r]||r,a=this.results[i];try{a.style[r]=e[n]}catch(e){console.log(e.message),console.log("css:"+r+":"+n)}}else try{for(o=this.results?this.results.length:0,i=0;i<o;i++)r=K(e),r=s[r]||r,(a=this.results[i]).style[r]=t}catch(e){return this}return this},remove:function(){var e,t,n=this.results?this.results.length:0;for(t=0;t<n;t++)(e=this.results[t]).parentNode.removeChild(e);return this.length=0,this.results=[],this},removeAttr:function(e){return this.each((function(t,n){n.setAttribute(e,""),n.removeAttribute(e)}))},ready:function(e){for(var t=0;this.readyList&&this.readyList[t];)m.call(window),t++;return this},hasClass:function(e){var t,n,o=this.results?this.results.length:0,a=[],i=r.CLASS(e);for(t=0;t<o;t++)i(n=this.results[t])&&a.push(n);return a.length},max:function(e,t){return e>t?e:t},width:function(){return this.results&&this.results[0]?m.max(this.results[0].offsetWidth,this.results[0].clientWidth):null},height:function(){return this.results&&this.results[0]?m.max(this.results[0].offsetHeight,this.results[0].clientHeight):null},val:function(e){return void 0===e?this.results&&this.results[0]?this.results[0].value:null:(this.results&&this.results[0]&&(this.results[0].value=e+""),this)},getAttr:function(e,t){return e.getAttribute(t)},each:function(e,t){var n=0;if(c(e))for(n=0;n<e.length&&!t.call(e[n],n,e[n]);n++);else if(l(e))for(t=e,e=this.results||[],n=0;n<e.length&&!t.call(e[n],n,e[n]);n++);else for(n in e)if(t.call(e[n],n,e[n]))break;return this}},(p=function(){var e,t=function(){p&&(m.ready(),p=void 0)};function n(){E.removeEventListener("DOMContentLoaded",n,!1),E.removeEventListener("load",n,!1),t()}function o(){"complete"==E.readyState&&(E.detachEvent("onreadystatechange",o),E.detachEvent("onload",e),t())}if(e=function(){E.detachEvent("onreadystatechange",o),E.detachEvent("onload",e),t()},E.addEventListener)E.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1);else if(E.attachEvent)E.attachEvent("onreadystatechange",o),window.attachEvent("onload",e);else if(E.lastChild==E.body)return t();(E.getElementsByTagName("body")||[]).length>0&&t()})(),e.fn=m,e.each=m.each,A.click=A.mousedown=A.mouseup=A.mousemove="MouseEvents",e.event={add:le,remove:ce},e.proxy=function(t,n){var o,a=2 in arguments&&_.call(arguments,2);if(l(t))return(o=function(){return t.apply(n,a?a.concat(_.call(arguments)):arguments)})._zid=Z(t),o;if(u(n))return a?(a.unshift(t[n],t),e.proxy.apply(null,a)):e.proxy(t[n],t);throw new TypeError("expected function")},e.fn.bind=function(e,t,n){return this.on(e,t,n)},e.fn.unbind=function(e,t){return this.off(e,t)},e.fn.one=function(e,t,n,o){return this.on(e,t,n,o,1)},g=function(t,n){return!n&&t.isDefaultPrevented||(n||(n=t),e.each(G,(function(e,o){var a=n[e];t[e]=function(){return this[o]=X,a&&a.apply(n,arguments)},t[o]=Q})),(void 0!==n.defaultPrevented?n.defaultPrevented:"returnValue"in n?!1===n.returnValue:n.getPreventDefault&&n.getPreventDefault())&&(t.isDefaultPrevented=X)),t},e.fn.delegate=function(e,t,n){return this.on(t,e,n)},e.fn.undelegate=function(e,t,n){return this.off(t,e,n)},e.fn.live=function(t,n){return e(E.getElementsByTagName("body")[0]).delegate(this.selector,t,n),this},e.fn.die=function(t,n){return e(E.getElementsByTagName("body")[0]).undelegate(this.selector,t,n),this},e.fn.on=function(t,n,o,a,i){var r,s,c=this;return t&&!u(t)?(e.each(t,(function(e,t){c.on(e,n,o,t,i)})),c):(u(n)||l(a)||!1===a||(a=o,o=n,n=void 0),void 0!==a&&!1!==o||(a=o,o=void 0),!1===a&&(a=Q),c.each((function(l,c){i&&(r=function(e){return ce(c,e.type,a),a.apply(this,arguments)}),n&&(s=function(t){var o,i=(t=t||window.event).target||t.srcElement,s=m.match(i,n);if(s&&s!==c)return o=e.extend(ue(t),{currentTarget:s,liveFired:c}),(r||a).apply(s,[o].concat(_.call(arguments,1)))}),le(c,t,a,o,n,s||r)})))},e.fn.off=function(t,n,o){var a=this;return t&&!u(t)?(e.each(t,(function(e,t){a.off(e,n,t)})),a):(u(n)||l(o)||!1===o||(o=n,n=void 0),!1===o&&(o=Q),a.each((function(){ce(this,t,o,n)})))},e.fn.trigger=function(t,n){return(t=u(t)||d(t)?e.Event(t):g(t))._args=n,this.each((function(){if(t.type in F&&"function"==typeof this[t.type])this[t.type]();else if("dispatchEvent"in this){this.dispatchEvent;this.dispatchEvent(t)}else e(this).triggerHandler(t,n)}))},e.fn.triggerHandler=function(t,n){var o,a;return this.each((function(i,r){(o=ue(u(t)?e.Event(t):t))._args=n,o.target=r,e.each(ie(r,t.type||t),(function(e,t){if(a=t.proxy(o),o.isImmediatePropagationStopped())return!1}))})),a},e.fn.each("focusin focusout focus blur load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select keydown keypress keyup error".split(" "),(function(t,n){e.fn[n]=function(e){return 0 in arguments?this.bind(n,e):this.trigger(n)}})),e.Event=function(e,t){u(e)||(e=(t=e).type);var n=E.createEvent(A[e]||"Events"),o=!0;if(t)for(var a in t)"bubbles"==a?o=!!t[a]:n[a]=t[a];return n.initEvent(e,o,!0),g(n)},e.fn.autoHeight=function(){this.each((function(){e(this).on("keyup",(function(){var e;(e=this).style.height="auto",e.style.height=e.scrollHeight+"px"}))}))},e.isBoolean=de,e.isDate=de,e.isFunction=de,e.isNaN=de,e.isNumber=de,e.isObject=de,e.isRegExp=de,e.isString=de,e.isUndefined=de,function(){var t,n,o=e,a="Array Boolean Date NaN Number Function Object RegExp Undefined".split(" ");for(t=0;t<a.length;t++)o["is"+(n=a[t])]=function(e){return function(t){return t!=t?"NaN"===e:RegExp(e).test(Object.prototype.toString.call(t))}}(n)}(),te.prototype=e.fn,(0,a.default)(e),e}();t.default=i},242:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t,n,o,a,i,r={};function s(){a=null,r.last&&(r.el.trigger("longTap"),r={})}function l(){a&&clearTimeout(a),a=null}function c(){t&&clearTimeout(t),n&&clearTimeout(n),o&&clearTimeout(o),a&&clearTimeout(a),t=n=o=a=null,r={}}function u(e){return("touch"==e.pointerType||e.pointerType==e.MSPOINTER_TYPE_TOUCH)&&e.isPrimary}function d(e,t){return e.type=="pointer"+t||e.type.toLowerCase()=="mspointer"+t}e((function(){var f,p,h,m,g=0,v=0;"MSGesture"in window&&((i=new MSGesture).target=document.body),e(document).bind("MSGestureEnd",(function(e){var t=e.velocityX>1?"Right":e.velocityX<-1?"Left":e.velocityY>1?"Down":e.velocityY<-1?"Up":null;r.el&&t&&(r.el.trigger("swipe"),r.el.trigger("swipe"+t))})).on("touchstart",(function(n){(m=d(n,"down"))&&!u(n)||(h=m?n:n.touches[0],n.touches&&1===n.touches.length&&r.x2&&(r.x2=void 0,r.y2=void 0),f=Date.now(),p=f-(r.last||f),r.el=e("tagName"in h.target?h.target:h.target.parentNode),t&&clearTimeout(t),r.x1=h.pageX,r.y1=h.pageY,p>0&&p<=250&&(r.isDoubleTap=!0),r.last=f,a=setTimeout(s,750),i&&m&&i.addPointer(n.pointerId))})).on("touchmove",(function(e){(m=d(e,"move"))&&!u(e)||(h=m?e:e.touches[0],l(),r.x2=h.pageX,r.y2=h.pageY,g+=Math.abs(r.x1-r.x2),v+=Math.abs(r.y1-r.y2))})).on("touchend",(function(a){(m=d(a,"up"))&&!u(a)||(l(),r.x2&&Math.abs(r.x1-r.x2)>30||r.y2&&Math.abs(r.y1-r.y2)>30?r.el&&(o=setTimeout((function(){var e,t,n,o;r.el&&(r.el.trigger("swipe"),r.el.trigger("swipe"+(e=r.x1,t=r.x2,n=r.y1,o=r.y2,Math.abs(e-t)>=Math.abs(n-o)?e-t>0?"Left":"Right":n-o>0?"Up":"Down")),r={})}),0)):"last"in r&&(g<30&&v<30?n=setTimeout((function(){var n=e.Event("tap");r.el&&(n.cancelTouch=c,r.el&&r.el.trigger(n),r.isDoubleTap?(r.el&&r.el.trigger("doubleTap"),r={}):t=setTimeout((function(){t=null,r.el&&r.el.trigger("singleTap"),r={}}),250))}),0):r={}),g=v=0)})).on("touchcancel MSPointerCancel pointercancel",c),e(window).on("scroll",c)})),["swipe","swipeLeft","swipeRight","swipeUp","swipeDown","doubleTap","tap","singleTap","longTap"].forEach((function(t){e.fn[t]=function(e){return this.on(t,e)}}))},n(15),n(10)},243:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(88),n(32),n(19),n(15),n(3),n(50),n(11),n(10);var o=i(n(45)),a=i(n(4));function i(e){return e&&e.__esModule?e:{default:e}}t.default={parseMsgByRule:function(e,t,n){if(t&&e){var i=o.default.regFace,r=o.default.regEmo,s=1;return content=t[e.mt||0],content?content=content.replace(/\$\{([^,]+),?([^,]+)?,?([^,]+)?,?([^,]+)?\}/g,(function(t,n,o,a,i){if(s="1"==i?1:0,!o&&!a)return e[n];a=parseInt(a);var r=e[n];return r?(a>0&&r.replace(/\[#([^#]+)#\]/g,(function(e,t,n,o){return(n<a&&n+e.length>=a||n<a)&&(a+=e.length-1),e})),e[n].substring(o,a)):""})):(content=e.content)||(content=t[0]),(s||n&&n.notPlainText)&&(content=function(e,t){return e&&(e+"").replace(/<(?:.|\s)*?>/gi,"").substring(0,t||100)}(content)),i?content&&(content=function(e,t){if(!e)return e;var n=a.default.emo;return n&&(e=e.replace(i,(function(e){var t=e.charCodeAt(0),o=e.charCodeAt(1),a=(o-56320+(t-55296<<10)+65536).toString(16);return n[a]?'<img class="img-emo" src="/res/emoji/32/'+a+'.png" />':n[t+"_"+o]?'<img class="img-emo" src="/res/emoji/32/'+t+"_"+o+'.png" />':e}))),e=e.replace(r,(function(e){var t=e.replace(/^\[#([\d\w_]+)#\]/g,"$1");return n&&n[t]||!n?'<img class="img-emo" src="/res/emoji/32/'+t+'.png" />':e}))}(content)):content&&(content=content.replace(r,"[face]")),content}},sendMsgboxUnread:function(){var e,t={cookieName:"",cookieValue:"",readySendName:"",readySend:{lastMid:"",order:[123],123:{}},queue:[],pageTag:(new Date).getTime(),checkTimer:null,timeoutTimer:null},n=null;function o(){t.readySend=$.store(t.readySendName),t.readySend=t.readySend?JSON.parse(t.readySend):{order:[]}}function a(e,n){o();var a,i=t.readySend.order;if(0===n){if(e.mid&&(t.readySend.lastMid=e.mid),i.length>0)for(t.readySend[e.mid]=void 0,delete t.readySend[e.mid],a=0;a<i.length;a++)i[a]==e.mid&&i.splice(a,1)}else if(!t.readySend[e.mid]&&(t.readySend[e.mid]=e,t.readySend.order.unshift(e.mid),t.readySend.order.length>10)){for(a=10;a<i.length;a++)t.readySend[i[a]]=void 0,delete t.readySend[i[a]];t.readySend.order.length=10}$.store(t.readySendName,JSON.stringify(t.readySend))}function i(n){if(n&&(t.queue.push(n),a(n,1)),0!=t.queue.length){var o=$.cookie(t.cookieName);o&&(t.checkTimer||t.timeoutTimer)?t.checkTimer||t.timeoutTimer||(t.timeoutTimer=setTimeout((function(){t.timeoutTimer=null,i()}),300)):(!o&&t.checkTimer&&clearTimeout(t.checkTimer),!o&&t.timeoutTimer&&clearTimeout(t.timeoutTimer),e(t.queue.shift()))}}return e=function(e){if(e){if(o(),t.readySend.lastMid&&t.readySend.lastMid>=e.mid)return i();t.cookieValue=e.mid+"_"+t.pageTag,$.cookie(t.cookieName,t.cookieValue),t.checkTimer=setTimeout((function(){t.checkTimer=null,$.cookie(t.cookieName)==t.cookieValue&&(n(e),$.cookie(t.cookieName,""),a(e,0)),$.cookie(t.cookieName)?t.timeoutTimer=setTimeout((function(){t.timeoutTimer=null,i()}),300):i()}),200)}},{send:i,queue:t.queue,init:function(o){var a;!n&&_self.visitorId&&(t.cookieName="unreadNewMsg_"+_self.visitorId,t.readySendName="unreadNewMsgMap_"+_self.visitorId,$.cookie(t.readySendName,""),t.cookieValue=$.cookie(t.cookieName),t.readySend=$.store(t.readySendName),t.readySend?t.readySend=JSON.parse(t.readySend):(t.readySend={order:[]},$.store(t.readySendName,'{ "order": [] }')),t.cookieValue&&(a=t.cookieValue.split("_")[0],t.readySend[a]&&e(t.readySend[a])),n=o)}}}()}},245:function(e,t,n){},246:function(e,t,n){"use strict";var o,a,i;function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}n(25),n(33),n(39),n(34),n(35),n(176),n(135),n(88),n(26),n(247),n(32),n(86),n(19),n(248),n(15),n(3),n(87),n(40),n(21),n(30),n(177),n(251),n(31),n(41),n(10),function(n,s){"object"==r(t)&&void 0!==e?s(t):(a=[t],void 0===(i="function"==typeof(o=s)?o.apply(t,a):o)||(e.exports=i))}(0,(function(e){var t=function(e,n){return(t=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}))(e,n)};function n(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}var o=function(){return(o=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};function a(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var o=Array(e),a=0;for(t=0;t<n;t++)for(var i=arguments[t],r=0,s=i.length;r<s;r++,a++)o[a]=i[r];return o}var i=[{sourceKey:"scroller.scrollBehaviorX.currentPos",key:"x"},{sourceKey:"scroller.scrollBehaviorY.currentPos",key:"y"},{sourceKey:"scroller.scrollBehaviorX.hasScroll",key:"hasHorizontalScroll"},{sourceKey:"scroller.scrollBehaviorY.hasScroll",key:"hasVerticalScroll"},{sourceKey:"scroller.scrollBehaviorX.contentSize",key:"scrollerWidth"},{sourceKey:"scroller.scrollBehaviorY.contentSize",key:"scrollerHeight"},{sourceKey:"scroller.scrollBehaviorX.maxScrollPos",key:"maxScrollX"},{sourceKey:"scroller.scrollBehaviorY.maxScrollPos",key:"maxScrollY"},{sourceKey:"scroller.scrollBehaviorX.minScrollPos",key:"minScrollX"},{sourceKey:"scroller.scrollBehaviorY.minScrollPos",key:"minScrollY"},{sourceKey:"scroller.scrollBehaviorX.movingDirection",key:"movingDirectionX"},{sourceKey:"scroller.scrollBehaviorY.movingDirection",key:"movingDirectionY"},{sourceKey:"scroller.scrollBehaviorX.direction",key:"directionX"},{sourceKey:"scroller.scrollBehaviorY.direction",key:"directionY"},{sourceKey:"scroller.actions.enabled",key:"enabled"},{sourceKey:"scroller.animater.pending",key:"pending"},{sourceKey:"scroller.animater.stop",key:"stop"},{sourceKey:"scroller.scrollTo",key:"scrollTo"},{sourceKey:"scroller.scrollBy",key:"scrollBy"},{sourceKey:"scroller.scrollToElement",key:"scrollToElement"},{sourceKey:"scroller.resetPosition",key:"resetPosition"}];function s(e){console.error("[BScroll warn]: "+e)}var l="undefined"!=typeof window,c=!(!(x=l&&navigator.userAgent.toLowerCase())||!/wechatdevtools/.test(x)),u=x&&0<x.indexOf("android"),d="string"==typeof x&&!!(x=/os (\d\d?_\d(_\d)?)/.exec(x))&&!!(13===(x=x[1].split("_").map((function(e){return parseInt(e,10)})))[0]&&4<=x[1]),f=!1;if(l)try{var p={};Object.defineProperty(p,"passive",{get:function(){f=!0}}),window.addEventListener("test-passive",(function(){}),p)}catch(e){}function h(){return window.performance&&window.performance.now&&window.performance.timing?window.performance.now()+window.performance.timing.navigationStart:+new Date}var m=function(e,t){for(var n in t)e[n]=t[n];return e};function g(e){return null==e}function v(e,t,n){return e<t?t:n<e?n:e}var y=l&&document.createElement("div").style,b=function(){if(l)for(var e=0,t=[{key:"standard",value:"transform"},{key:"webkit",value:"webkitTransform"},{key:"Moz",value:"MozTransform"},{key:"O",value:"OTransform"},{key:"ms",value:"msTransform"}];e<t.length;e++){var n=t[e];if(void 0!==y[n.value])return n.key}return!1}();function S(e){return!1===b?e:"standard"===b?"transitionEnd"===e?"transitionend":e:b+e.charAt(0).toUpperCase()+e.substr(1)}function T(e){return"string"==typeof e?document.querySelector(e):e}function w(e,t,n,o){o=f?{passive:!1,capture:!!o}:!!o,e.addEventListener(t,n,o)}function k(e,t,n,o){e.removeEventListener(t,n,{capture:!!o})}function I(e){e.cancelable&&e.preventDefault()}function C(e){for(var t=0,n=0;e;)t-=e.offsetLeft,n-=e.offsetTop,e=e.offsetParent;return{left:t,top:n}}b&&"standard"!==b&&b.toLowerCase();var x=S("transform"),E=(p=S("transition"),l&&S("perspective")in y),$=l&&("ontouchstart"in window||c),D=l&&p in y,M={transform:x,transition:p,transitionTimingFunction:S("transitionTimingFunction"),transitionDuration:S("transitionDuration"),transitionDelay:S("transitionDelay"),transformOrigin:S("transformOrigin"),transitionEnd:S("transitionEnd"),transitionProperty:S("transitionProperty")},_={touchstart:1,touchmove:1,touchend:1,touchcancel:1,mousedown:2,mousemove:2,mouseup:2};function P(e){var t;return e instanceof window.SVGElement?{top:(t=e.getBoundingClientRect()).top,left:t.left,width:t.width,height:t.height}:{top:e.offsetTop,left:e.offsetLeft,width:e.offsetWidth,height:e.offsetHeight}}function N(e,t){for(var n in t)if(t[n].test(e[n]))return!0;return!1}var B=N;function O(e,t){void 0===t&&(t="click"),"mouseup"===e.type?i=e:"touchend"!==e.type&&"touchcancel"!==e.type||(i=e.changedTouches[0]);var n,a={},i=(i&&(a.screenX=i.screenX||0,a.screenY=i.screenY||0,a.clientX=i.clientX||0,a.clientY=i.clientY||0),{ctrlKey:e.ctrlKey,shiftKey:e.shiftKey,altKey:e.altKey,metaKey:e.metaKey});if("undefined"!=typeof MouseEvent)try{n=new MouseEvent(t,m(o({bubbles:!0,cancelable:!0},i),a))}catch(e){r()}else r();function r(){(n=document.createEvent("Event")).initEvent(t,!0,!0),m(n,a)}n.forwardedTouchEvent=!0,n._constructed=!0,e.target.dispatchEvent(n)}var L={swipe:{style:"cubic-bezier(0.23, 1, 0.32, 1)",fn:function(e){return 1+--e*e*e*e*e}},swipeBounce:{style:"cubic-bezier(0.25, 0.46, 0.45, 0.94)",fn:function(e){return e*(2-e)}},bounce:{style:"cubic-bezier(0.165, 0.84, 0.44, 1)",fn:function(e){return 1- --e*e*e*e}}};c=l&&window;function R(){}function A(e){}var j=l?c.requestAnimationFrame||c.webkitRequestAnimationFrame||c.mozRequestAnimationFrame||c.oRequestAnimationFrame||function(e){return window.setTimeout(e,e.interval||1e3/60)}:R,F=l?c.cancelAnimationFrame||c.webkitCancelAnimationFrame||c.mozCancelAnimationFrame||c.oCancelAnimationFrame||function(e){window.clearTimeout(e)}:R,U={enumerable:!0,configurable:!0,get:A,set:A};V.prototype.on=function(e,t,n){return void 0===n&&(n=this),this.hasType(e),this.events[e]||(this.events[e]=[]),this.events[e].push([t,n]),this},V.prototype.once=function(e,t,n){var o=this,a=(void 0===n&&(n=this),this.hasType(e),function(){for(var i=[],r=0;r<arguments.length;r++)i[r]=arguments[r];o.off(e,a);var s=t.apply(n,i);if(!0===s)return s});return a.fn=t,this.on(e,a),this},V.prototype.off=function(e,t){if(!e&&!t)return this.events={},this;if(e){if(this.hasType(e),t){var n=this.events[e];if(n)for(var o=n.length;o--;)(n[o][0]===t||n[o][0]&&n[o][0].fn===t)&&n.splice(o,1)}else this.events[e]=[];return this}},V.prototype.trigger=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(this.hasType(e),e=this.events[e])for(var o=e.length,i=a(e),r=0;r<o;r++){var s=(l=i[r])[0],l=l[1];if(s&&!0===(s=s.apply(l,t)))return s}},V.prototype.registerType=function(e){var t=this;e.forEach((function(e){t.eventTypes[e]=e}))},V.prototype.destroy=function(){this.events={},this.eventTypes={}},V.prototype.hasType=function(e){var t=this.eventTypes;t[e]!==e&&s('EventEmitter has used unknown event type: "'+e+'", should be oneof ['+Object.keys(t).map((function(e){return JSON.stringify(e)}))+"]")};var H=V;function V(e){this.events={},this.eventTypes={},this.registerType(e)}W.prototype.destroy=function(){this.removeDOMEvents(),this.events=[]},W.prototype.addDOMEvents=function(){this.handleDOMEvents(w)},W.prototype.removeDOMEvents=function(){this.handleDOMEvents(k)},W.prototype.handleDOMEvents=function(e){var t=this,n=this.wrapper;this.events.forEach((function(o){e(n,o.name,t,!!o.capture)}))},W.prototype.handleEvent=function(e){var t=e.type;this.events.some((function(n){return n.name===t&&(n.handler(e),!0)}))};var K=W;function W(e,t){this.wrapper=e,this.events=t,this.addDOMEvents()}function q(){}n(X,z=q),X.prototype.merge=function(e){if(e)for(var t in e)"bounce"===t?this.bounce=this.resolveBounce(e[t]):this[t]=e[t];return this},X.prototype.process=function(){return this.translateZ=this.HWCompositing&&E?" translateZ(1px)":"",this.useTransition=this.useTransition&&D,this.preventDefault=!this.eventPassthrough&&this.preventDefault,this.scrollX="horizontal"!==this.eventPassthrough&&this.scrollX,this.scrollY="vertical"!==this.eventPassthrough&&this.scrollY,this.freeScroll=this.freeScroll&&!this.eventPassthrough,this.scrollX=!!this.freeScroll||this.scrollX,this.scrollY=!!this.freeScroll||this.scrollY,this.directionLockThreshold=this.eventPassthrough?0:this.directionLockThreshold,this},X.prototype.resolveBounce=function(e){var t={top:!0,right:!0,bottom:!0,left:!0};return e="object"==r(e)?m(t,e):e?t:{top:!1,right:!1,bottom:!1,left:!1}};var z,Y=X;function X(){var e=z.call(this)||this;return e.startX=0,e.startY=0,e.scrollX=!1,e.scrollY=!0,e.freeScroll=!1,e.directionLockThreshold=0,e.eventPassthrough="",e.click=!1,e.dblclick=!1,e.tap="",e.bounce={top:!0,bottom:!0,left:!0,right:!0},e.bounceTime=800,e.momentum=!0,e.momentumLimitTime=300,e.momentumLimitDistance=15,e.swipeTime=2500,e.swipeBounceTime=500,e.deceleration=.0015,e.flickLimitTime=200,e.flickLimitDistance=100,e.resizePolling=60,e.probeType=0,e.stopPropagation=!1,e.preventDefault=!0,e.preventDefaultException={tagName:/^(INPUT|TEXTAREA|BUTTON|SELECT|AUDIO)$/},e.tagException={tagName:/^TEXTAREA$/},e.HWCompositing=!0,e.useTransition=!0,e.bindToWrapper=!1,e.bindToTarget=!1,e.disableMouse=$,e.disableTouch=!$,e.autoBlur=!0,e.autoEndDistance=5,e.outOfBoundaryDampingFactor=1/3,e.specifiedIndexAsContent=0,e.quadrant=1,e}J.prototype.handleDOMEvents=function(){var e=(o=this.options).bindToWrapper,t=o.disableMouse,n=o.disableTouch,o=o.click,a=this.wrapper,i=(e=e?a:window,[]),r=[];n=!n,t=!t;o&&i.push({name:"click",handler:this.click.bind(this),capture:!0}),n&&(i.push({name:"touchstart",handler:this.start.bind(this)}),r.push({name:"touchmove",handler:this.move.bind(this)},{name:"touchend",handler:this.end.bind(this)},{name:"touchcancel",handler:this.end.bind(this)})),t&&(i.push({name:"mousedown",handler:this.start.bind(this)}),r.push({name:"mousemove",handler:this.move.bind(this)},{name:"mouseup",handler:this.end.bind(this)})),this.wrapperEventRegister=new K(a,i),this.targetEventRegister=new K(e,r)},J.prototype.beforeHandler=function(e,t){var n=this.options,o=n.preventDefault,a=n.stopPropagation,i=n.preventDefaultException;!{start:function(){return o&&!N(e.target,i)},end:function(){return o&&!N(e.target,i)},move:function(){return o}}[t]()||e.preventDefault(),a&&e.stopPropagation()},J.prototype.setInitiated=function(e){this.initiated=e=void 0===e?0:e},J.prototype.start=function(e){var t=_[e.type];this.initiated&&this.initiated!==t||(this.setInitiated(t),B(e.target,this.options.tagException)?this.setInitiated():2===t&&0!==e.button||this.hooks.trigger(this.hooks.eventTypes.beforeStart,e)||(this.beforeHandler(e,"start"),t=e.touches?e.touches[0]:e,this.pointX=t.pageX,this.pointY=t.pageY,this.hooks.trigger(this.hooks.eventTypes.start,e)))},J.prototype.move=function(e){var t,n,o;_[e.type]===this.initiated&&(this.beforeHandler(e,"move"),o=(n=e.touches?e.touches[0]:e).pageX-this.pointX,t=n.pageY-this.pointY,this.pointX=n.pageX,this.pointY=n.pageY,this.hooks.trigger(this.hooks.eventTypes.move,{deltaX:o,deltaY:t,e:e})||(n=document.documentElement.scrollLeft||window.pageXOffset||document.body.scrollLeft,o=document.documentElement.scrollTop||window.pageYOffset||document.body.scrollTop,t=this.pointX-n,n=this.pointY-o,o=this.options.autoEndDistance,(t>document.documentElement.clientWidth-o||n>document.documentElement.clientHeight-o||t<o||n<o)&&this.end(e)))},J.prototype.end=function(e){_[e.type]===this.initiated&&(this.setInitiated(),this.beforeHandler(e,"end"),this.hooks.trigger(this.hooks.eventTypes.end,e))},J.prototype.click=function(e){this.hooks.trigger(this.hooks.eventTypes.click,e)},J.prototype.setContent=function(e){e!==this.wrapper&&(this.wrapper=e,this.rebindDOMEvents())},J.prototype.rebindDOMEvents=function(){this.wrapperEventRegister.destroy(),this.targetEventRegister.destroy(),this.handleDOMEvents()},J.prototype.destroy=function(){this.wrapperEventRegister.destroy(),this.targetEventRegister.destroy(),this.hooks.destroy()};var Q=J;function J(e,t){this.wrapper=e,this.options=t,this.hooks=new H(["beforeStart","start","move","end","click"]),this.handleDOMEvents()}var G={x:["translateX","px"],y:["translateY","px"]},Z=(ee.prototype.getComputedPosition=function(){var e=window.getComputedStyle(this.content,null)[M.transform].split(")")[0].split(", ");return{x:+(e[12]||e[4])||0,y:+(e[13]||e[5])||0}},ee.prototype.translate=function(e){var t=[];Object.keys(e).forEach((function(n){var o,a;!G[n]||(o=G[n][0])&&(a=G[n][1],n=e[n],t.push(o+"("+n+a+")"))})),this.hooks.trigger(this.hooks.eventTypes.beforeTranslate,t,e),this.style[M.transform]=t.join(" "),this.hooks.trigger(this.hooks.eventTypes.translate,e)},ee.prototype.setContent=function(e){this.content!==e&&(this.content=e,this.style=e.style)},ee.prototype.destroy=function(){this.hooks.destroy()},ee);function ee(e){this.setContent(e),this.hooks=new H(["beforeTranslate","translate"])}function te(e,t,n){this.translater=t,this.options=n,this.timer=0,this.hooks=new H(["move","end","beforeForceStop","forceStop","callStop","time","timeFunction"]),this.setContent(e)}te.prototype.translate=function(e){this.translater.translate(e)},te.prototype.setPending=function(e){this.pending=e},te.prototype.setForceStopped=function(e){this.forceStopped=e},te.prototype.setCallStop=function(e){this.callStopWhenPending=e},te.prototype.setContent=function(e){this.content!==e&&(this.content=e,this.style=e.style,this.stop())},te.prototype.clearTimer=function(){this.timer&&(F(this.timer),this.timer=0)},te.prototype.destroy=function(){this.hooks.destroy(),F(this.timer)},n(ae,ne=x=te),ae.prototype.startProbe=function(e,t){var n=this,o=e,a=function(){var i=n.translater.getComputedPosition();(function(e,t,n,o){function a(e,t){return 0<(e-=t)?-1:e<0?1:0}var i=a(t.x,e.x);return t=a(t.y,e.y),e=n.x-o.x,n=n.y-o.y,i*e<=0&&t*n<=0})(e,t,i,o)&&n.hooks.trigger(n.hooks.eventTypes.move,i),n.pending||(n.callStopWhenPending?n.callStopWhenPending=!1:n.hooks.trigger(n.hooks.eventTypes.end,i)),o=i,n.pending&&(n.timer=j(a))};this.callStopWhenPending&&this.setCallStop(!1),F(this.timer),a()},ae.prototype.transitionTime=function(e){this.style[M.transitionDuration]=(e=void 0===e?0:e)+"ms",this.hooks.trigger(this.hooks.eventTypes.time,e)},ae.prototype.transitionTimingFunction=function(e){this.style[M.transitionTimingFunction]=e,this.hooks.trigger(this.hooks.eventTypes.timeFunction,e)},ae.prototype.transitionProperty=function(){this.style[M.transitionProperty]=M.transform},ae.prototype.move=function(e,t,n,o){this.setPending(0<n),this.transitionTimingFunction(o),this.transitionProperty(),this.transitionTime(n),this.translate(t),o=3===this.options.probeType,n&&o&&this.startProbe(e,t),n||(this._reflow=this.content.offsetHeight,o&&this.hooks.trigger(this.hooks.eventTypes.move,t),this.hooks.trigger(this.hooks.eventTypes.end,t))},ae.prototype.doStop=function(){var e,t,n=this.pending;return this.setForceStopped(!1),this.setCallStop(!1),n&&(this.setPending(!1),F(this.timer),e=(t=this.translater.getComputedPosition()).x,t=t.y,this.transitionTime(),this.translate({x:e,y:t}),this.setForceStopped(!0),this.setCallStop(!0),this.hooks.trigger(this.hooks.eventTypes.forceStop,{x:e,y:t})),n},ae.prototype.stop=function(){this.doStop()&&this.hooks.trigger(this.hooks.eventTypes.callStop)};var ne,oe=ae;function ae(){return null!==ne&&ne.apply(this,arguments)||this}n(se,ie=x),se.prototype.move=function(e,t,n,o){n?this.animate(e,t,n,o):(this.translate(t),3===this.options.probeType&&this.hooks.trigger(this.hooks.eventTypes.move,t),this.hooks.trigger(this.hooks.eventTypes.end,t))},se.prototype.animate=function(e,t,n,o){var a=this,i=h(),r=i+n,s=3===this.options.probeType,l=function(){var c,u,d=h();r<=d?(a.translate(t),s&&a.hooks.trigger(a.hooks.eventTypes.move,t),a.hooks.trigger(a.hooks.eventTypes.end,t)):(c=o((d-i)/n),u={},Object.keys(t).forEach((function(n){var o=e[n],a=t[n];u[n]=(a-o)*c+o})),a.translate(u),s&&a.hooks.trigger(a.hooks.eventTypes.move,u),a.pending&&(a.timer=j(l)),a.pending||(a.callStopWhenPending?a.callStopWhenPending=!1:a.hooks.trigger(a.hooks.eventTypes.end,t)))};this.setPending(!0),this.callStopWhenPending&&this.setCallStop(!1),F(this.timer),l()},se.prototype.doStop=function(){var e,t=this.pending;return this.setForceStopped(!1),this.setCallStop(!1),t&&(this.setPending(!1),F(this.timer),e=this.translater.getComputedPosition(),this.setForceStopped(!0),this.setCallStop(!0),this.hooks.trigger(this.hooks.eventTypes.forceStop,e)),t},se.prototype.stop=function(){this.doStop()&&this.hooks.trigger(this.hooks.eventTypes.callStop)};var ie,re=se;function se(){return null!==ie&&ie.apply(this,arguments)||this}ce.prototype.start=function(){this.dist=0,this.setMovingDirection(0),this.setDirection(0)},ce.prototype.move=function(e){return e=this.hasScroll?e:0,this.setMovingDirection(e),this.performDampingAlgorithm(e,this.options.outOfBoundaryDampingFactor)},ce.prototype.setMovingDirection=function(e){this.movingDirection=0<e?-1:e<0?1:0},ce.prototype.setDirection=function(e){this.direction=0<e?-1:e<0?1:0},ce.prototype.performDampingAlgorithm=function(e,t){var n=this.currentPos+e;return n>this.minScrollPos||n<this.maxScrollPos?n>this.minScrollPos&&this.options.bounces[0]||n<this.maxScrollPos&&this.options.bounces[1]?this.currentPos+e*t:n>this.minScrollPos?this.minScrollPos:this.maxScrollPos:n},ce.prototype.end=function(e){var t={duration:0},n=Math.abs(this.currentPos-this.startPos);return this.options.momentum&&e<this.options.momentumLimitTime&&n>this.options.momentumLimitDistance?(n=-1===this.direction&&this.options.bounces[0]||1===this.direction&&this.options.bounces[1]?this.wrapperSize:0,t=this.hasScroll?this.momentum(this.currentPos,this.startPos,e,this.maxScrollPos,this.minScrollPos,n,this.options):{destination:this.currentPos,duration:0}):this.hooks.trigger(this.hooks.eventTypes.end,t),t},ce.prototype.momentum=function(e,t,n,o,a,i,r){void 0===r&&(r=this.options);t=e-t,n=Math.abs(t)/n;var s=r.deceleration,l=r.swipeBounceTime;r=r.swipeTime,e={destination:e+n*n/s*(t<0?-1:1),duration:Math.min(r,2*n/s),rate:15};return this.hooks.trigger(this.hooks.eventTypes.momentum,e,t),e.destination<o?(e.destination=i?Math.max(o-i/4,o-i/e.rate*n):o,e.duration=l):e.destination>a&&(e.destination=i?Math.min(a+i/4,a+i/e.rate*n):a,e.duration=l),e.destination=Math.round(e.destination),e},ce.prototype.updateDirection=function(){var e=this.currentPos-this.absStartPos;this.setDirection(e)},ce.prototype.refresh=function(e){var t=(n=this.options.rect).size,n=n.position,o="static"===window.getComputedStyle(this.wrapper,null).position,a=P(this.wrapper);this.wrapperSize=this.wrapper["width"===t?"clientWidth":"clientHeight"],this.setContent(e),e=P(this.content);this.contentSize=e[t],this.relativeOffset=e[n],o&&(this.relativeOffset-=a[n]),this.computeBoundary(),this.setDirection(0)},ce.prototype.setContent=function(e){e!==this.content&&(this.content=e,this.resetState())},ce.prototype.resetState=function(){this.currentPos=0,this.startPos=0,this.dist=0,this.setDirection(0),this.setMovingDirection(0),this.resetStartPos()},ce.prototype.computeBoundary=function(){this.hooks.trigger(this.hooks.eventTypes.beforeComputeBoundary);var e={minScrollPos:0,maxScrollPos:this.wrapperSize-this.contentSize};e.maxScrollPos<0&&(e.maxScrollPos-=this.relativeOffset,0===this.options.specifiedIndexAsContent&&(e.minScrollPos=-this.relativeOffset)),this.hooks.trigger(this.hooks.eventTypes.computeBoundary,e),this.minScrollPos=e.minScrollPos,this.maxScrollPos=e.maxScrollPos,this.hasScroll=this.options.scrollable&&this.maxScrollPos<this.minScrollPos,!this.hasScroll&&this.minScrollPos<this.maxScrollPos&&(this.maxScrollPos=this.minScrollPos,this.contentSize=this.wrapperSize)},ce.prototype.updatePosition=function(e){this.currentPos=e},ce.prototype.getCurrentPos=function(){return this.currentPos},ce.prototype.checkInBoundary=function(){var e=this.adjustPosition(this.currentPos);return{position:e,inBoundary:e===this.getCurrentPos()}},ce.prototype.adjustPosition=function(e){return!this.hasScroll&&!this.hooks.trigger(this.hooks.eventTypes.ignoreHasScroll)||e>this.minScrollPos?e=this.minScrollPos:e<this.maxScrollPos&&(e=this.maxScrollPos),e},ce.prototype.updateStartPos=function(){this.startPos=this.currentPos},ce.prototype.updateAbsStartPos=function(){this.absStartPos=this.currentPos},ce.prototype.resetStartPos=function(){this.updateStartPos(),this.updateAbsStartPos()},ce.prototype.getAbsDist=function(e){return this.dist+=e,Math.abs(this.dist)},ce.prototype.destroy=function(){this.hooks.destroy()};var le=ce;function ce(e,t,n){this.wrapper=e,this.options=n,this.hooks=new H(["beforeComputeBoundary","computeBoundary","momentum","end","ignoreHasScroll"]),this.refresh(t)}(p={}).yes=function(e){return!0},p.no=function(e){return I(e),!1};var ue=p,de=((c={}).horizontal=((x={}).yes="horizontal",x.no="vertical",x),c.vertical=((p={}).yes="vertical",p.no="horizontal",p),c),fe=(pe.prototype.reset=function(){this.directionLocked=""},pe.prototype.checkMovingDirection=function(e,t,n){return this.computeDirectionLock(e,t),this.handleEventPassthrough(n)},pe.prototype.adjustDelta=function(e,t){return"horizontal"===this.directionLocked?t=0:"vertical"===this.directionLocked&&(e=0),{deltaX:e,deltaY:t}},pe.prototype.computeDirectionLock=function(e,t){""!==this.directionLocked||this.freeScroll||(e>t+this.directionLockThreshold?this.directionLocked="horizontal":t>=e+this.directionLockThreshold?this.directionLocked="vertical":this.directionLocked="none")},pe.prototype.handleEventPassthrough=function(e){var t=de[this.directionLocked];if(t){if(this.eventPassthrough===t.yes)return ue.yes(e);if(this.eventPassthrough===t.no)return ue.no(e)}return!1},pe);function pe(e,t,n){this.directionLockThreshold=e,this.freeScroll=t,this.eventPassthrough=n,this.reset()}me.prototype.bindActionsHandler=function(){var e=this;this.actionsHandler.hooks.on(this.actionsHandler.hooks.eventTypes.start,(function(t){return!e.enabled||e.handleStart(t)})),this.actionsHandler.hooks.on(this.actionsHandler.hooks.eventTypes.move,(function(t){var n,o=t.deltaX,a=t.deltaY;t=t.e;return!e.enabled||(o=o,a=a,n=2===(n=e.options.quadrant)?[a,-o]:3===n?[-o,-a]:4===n?[-a,o]:[o,a],e.hooks.trigger(e.hooks.eventTypes.coordinateTransformation,o={deltaX:n[0],deltaY:n[1]}),e.handleMove(o.deltaX,o.deltaY,t))})),this.actionsHandler.hooks.on(this.actionsHandler.hooks.eventTypes.end,(function(t){return!e.enabled||e.handleEnd(t)})),this.actionsHandler.hooks.on(this.actionsHandler.hooks.eventTypes.click,(function(t){e.enabled&&!t._constructed&&e.handleClick(t)}))},me.prototype.handleStart=function(e){var t=h();this.fingerMoved=!1,this.contentMoved=!1,this.startTime=t,this.directionLockAction.reset(),this.scrollBehaviorX.start(),this.scrollBehaviorY.start(),this.animater.doStop(),this.scrollBehaviorX.resetStartPos(),this.scrollBehaviorY.resetStartPos(),this.hooks.trigger(this.hooks.eventTypes.start,e)},me.prototype.handleMove=function(e,t,n){var o,a,i;if(!this.hooks.trigger(this.hooks.eventTypes.beforeMove,n))return i=this.scrollBehaviorX.getAbsDist(e),a=this.scrollBehaviorY.getAbsDist(t),o=h(),!!this.checkMomentum(i,a,o)||(this.directionLockAction.checkMovingDirection(i,a,n)?(this.actionsHandler.setInitiated(),!0):(i=this.directionLockAction.adjustDelta(e,t),a=this.scrollBehaviorX.getCurrentPos(),n=this.scrollBehaviorX.move(i.deltaX),e=this.scrollBehaviorY.getCurrentPos(),t=this.scrollBehaviorY.move(i.deltaY),void(this.hooks.trigger(this.hooks.eventTypes.detectMovingDirection)||(this.fingerMoved||(this.fingerMoved=!0),i=n!==a||t!==e,this.contentMoved||i||this.hooks.trigger(this.hooks.eventTypes.contentNotMoved),!this.contentMoved&&i&&(this.contentMoved=!0,this.hooks.trigger(this.hooks.eventTypes.scrollStart)),this.contentMoved&&i&&(this.animater.translate({x:n,y:t}),this.dispatchScroll(o))))))},me.prototype.dispatchScroll=function(e){e-this.startTime>this.options.momentumLimitTime&&(this.startTime=e,this.scrollBehaviorX.updateStartPos(),this.scrollBehaviorY.updateStartPos(),1===this.options.probeType&&this.hooks.trigger(this.hooks.eventTypes.scroll,this.getCurrentPos())),1<this.options.probeType&&this.hooks.trigger(this.hooks.eventTypes.scroll,this.getCurrentPos())},me.prototype.checkMomentum=function(e,t,n){return n-this.endTime>this.options.momentumLimitTime&&t<this.options.momentumLimitDistance&&e<this.options.momentumLimitDistance},me.prototype.handleEnd=function(e){if(!this.hooks.trigger(this.hooks.eventTypes.beforeEnd,e)){var t=this.getCurrentPos();if(this.scrollBehaviorX.updateDirection(),this.scrollBehaviorY.updateDirection(),this.hooks.trigger(this.hooks.eventTypes.end,e,t))return!0;t=this.ensureIntegerPos(t),this.animater.translate(t),this.endTime=h(),e=this.endTime-this.startTime,this.hooks.trigger(this.hooks.eventTypes.scrollEnd,t,e)}},me.prototype.ensureIntegerPos=function(e){this.ensuringInteger=!0;var t=e.x,n=(e=e.y,(o=this.scrollBehaviorX).minScrollPos),o=o.maxScrollPos,a=(i=this.scrollBehaviorY).minScrollPos,i=i.maxScrollPos;t=0<t?Math.ceil(t):Math.floor(t),e=0<e?Math.ceil(e):Math.floor(e);return{x:v(t,o,n),y:v(e,i,a)}},me.prototype.handleClick=function(e){N(e.target,this.options.preventDefaultException)||(I(e),e.stopPropagation())},me.prototype.getCurrentPos=function(){return{x:this.scrollBehaviorX.getCurrentPos(),y:this.scrollBehaviorY.getCurrentPos()}},me.prototype.refresh=function(){this.endTime=0},me.prototype.destroy=function(){this.hooks.destroy()};var he=me;function me(e,t,n,o,a){this.hooks=new H(["start","beforeMove","scrollStart","scroll","beforeEnd","end","scrollEnd","contentNotMoved","detectMovingDirection","coordinateTransformation"]),this.scrollBehaviorX=e,this.scrollBehaviorY=t,this.actionsHandler=n,this.animater=o,this.options=a,this.directionLockAction=new fe(a.directionLockThreshold,a.freeScroll,a.eventPassthrough),this.enabled=!0,this.bindActionsHandler()}function ge(e,t,n,o){var a=["momentum","momentumLimitTime","momentumLimitDistance","deceleration","swipeBounceTime","swipeTime","outOfBoundaryDampingFactor","specifiedIndexAsContent"].reduce((function(t,n){return t[n]=e[n],t}),{});return a.scrollable=!!e[t],a.bounces=n,a.rect=o,a}function ve(e,t,n){n.forEach((function(n){var o,i;"string"==typeof n?o=i=n:(o=n.source,i=n.target),e.on(o,(function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return t.trigger.apply(t,a([i],e))}))}))}be.prototype.init=function(){var e=this;this.bindTranslater(),this.bindAnimater(),this.bindActions(),this.hooks.on(this.hooks.eventTypes.scrollEnd,(function(){e.togglePointerEvents(!0)}))},be.prototype.registerTransitionEnd=function(){this.transitionEndRegister=new K(this.content,[{name:M.transitionEnd,handler:this.transitionEnd.bind(this)}])},be.prototype.bindTranslater=function(){var e=this,t=this.translater.hooks;t.on(t.eventTypes.beforeTranslate,(function(t){e.options.translateZ&&t.push(e.options.translateZ)})),t.on(t.eventTypes.translate,(function(t){var n=e.getCurrentPos();e.updatePositions(t),!0===e.actions.ensuringInteger?e.actions.ensuringInteger=!1:t.x===n.x&&t.y===n.y||e.togglePointerEvents(!1)}))},be.prototype.bindAnimater=function(){var e=this;this.animater.hooks.on(this.animater.hooks.eventTypes.end,(function(t){e.resetPosition(e.options.bounceTime)||(e.animater.setPending(!1),e.hooks.trigger(e.hooks.eventTypes.scrollEnd,t))})),ve(this.animater.hooks,this.hooks,[{source:this.animater.hooks.eventTypes.move,target:this.hooks.eventTypes.scroll},{source:this.animater.hooks.eventTypes.forceStop,target:this.hooks.eventTypes.scrollEnd}])},be.prototype.bindActions=function(){var e=this,t=this.actions;ve(t.hooks,this.hooks,[{source:t.hooks.eventTypes.start,target:this.hooks.eventTypes.beforeStart},{source:t.hooks.eventTypes.start,target:this.hooks.eventTypes.beforeScrollStart},{source:t.hooks.eventTypes.beforeMove,target:this.hooks.eventTypes.beforeMove},{source:t.hooks.eventTypes.scrollStart,target:this.hooks.eventTypes.scrollStart},{source:t.hooks.eventTypes.scroll,target:this.hooks.eventTypes.scroll},{source:t.hooks.eventTypes.beforeEnd,target:this.hooks.eventTypes.beforeEnd}]),t.hooks.on(t.hooks.eventTypes.end,(function(n,o){return e.hooks.trigger(e.hooks.eventTypes.touchEnd,o),!!e.hooks.trigger(e.hooks.eventTypes.end,o)||!(t.fingerMoved||(e.hooks.trigger(e.hooks.eventTypes.scrollCancel),!e.checkClick(n)))||(e.resetPosition(e.options.bounceTime,L.bounce)?(e.animater.setForceStopped(!1),!0):void 0)})),t.hooks.on(t.hooks.eventTypes.scrollEnd,(function(n,o){var a=Math.abs(n.x-e.scrollBehaviorX.startPos),i=Math.abs(n.y-e.scrollBehaviorY.startPos);e.checkFlick(o,a,i)?(e.animater.setForceStopped(!1),e.hooks.trigger(e.hooks.eventTypes.flick)):(e.momentum(n,o)||(t.contentMoved&&e.hooks.trigger(e.hooks.eventTypes.scrollEnd,n),e.animater.forceStopped))&&e.animater.setForceStopped(!1)}))},be.prototype.checkFlick=function(e,t,n){if(1<this.hooks.events.flick.length&&e<this.options.flickLimitTime&&t<this.options.flickLimitDistance&&n<this.options.flickLimitDistance&&(1<n||1<t))return!0},be.prototype.momentum=function(e,t){var n={time:0,easing:L.swiper,newX:e.x,newY:e.y},o=this.scrollBehaviorX.end(t);t=this.scrollBehaviorY.end(t);if(n.newX=g(o.destination)?n.newX:o.destination,n.newY=g(t.destination)?n.newY:t.destination,n.time=Math.max(o.duration,t.duration),this.hooks.trigger(this.hooks.eventTypes.momentum,n,this),n.newX!==e.x||n.newY!==e.y)return(n.newX>this.scrollBehaviorX.minScrollPos||n.newX<this.scrollBehaviorX.maxScrollPos||n.newY>this.scrollBehaviorY.minScrollPos||n.newY<this.scrollBehaviorY.maxScrollPos)&&(n.easing=L.swipeBounce),this.scrollTo(n.newX,n.newY,n.time,n.easing),!0},be.prototype.checkClick=function(e){var t,n,o,a=this.animater.forceStopped;return this.hooks.trigger(this.hooks.eventTypes.checkClick)?(this.animater.setForceStopped(!1),!0):!a&&(a=!1,(t=this.options.dblclick)&&this.lastClickTime&&(t=void 0===(t=t.delay)?300:t,h()-this.lastClickTime<t&&(a=!0,O(e,"dblclick"))),this.options.tap&&(t=e,n=this.options.tap,(o=document.createEvent("Event")).initEvent(n,!0,!0),o.pageX=t.pageX,o.pageY=t.pageY,t.target.dispatchEvent(o)),this.options.click&&!N(e.target,this.options.preventDefaultException)&&O(e),this.lastClickTime=a?null:h(),!0)},be.prototype.resize=function(){var e=this;this.actions.enabled&&(u&&(this.wrapper.scrollTop=0),clearTimeout(this.resizeTimeout),this.resizeTimeout=window.setTimeout((function(){e.hooks.trigger(e.hooks.eventTypes.resize)}),this.options.resizePolling))},be.prototype.transitionEnd=function(e){e.target===this.content&&this.animater.pending&&(this.animater.transitionTime(),this.resetPosition(this.options.bounceTime,L.bounce)||(this.animater.setPending(!1),3!==this.options.probeType&&this.hooks.trigger(this.hooks.eventTypes.scrollEnd,this.getCurrentPos())))},be.prototype.togglePointerEvents=function(e){for(var t=this.content.children.length?this.content.children:[this.content],n=(e=void 0===e||e)?"auto":"none",o=0;o<t.length;o++){var a=t[o];a.isBScrollContainer||(a.style.pointerEvents=n)}},be.prototype.refresh=function(e){var t=this.setContent(e);this.hooks.trigger(this.hooks.eventTypes.beforeRefresh),this.scrollBehaviorX.refresh(e),this.scrollBehaviorY.refresh(e),t&&(this.translater.setContent(e),this.animater.setContent(e),this.transitionEndRegister.destroy(),this.registerTransitionEnd(),this.options.bindToTarget&&this.actionsHandler.setContent(e)),this.actions.refresh(),this.wrapperOffset=C(this.wrapper)},be.prototype.setContent=function(e){var t=e!==this.content;return t&&(this.content=e),t},be.prototype.scrollBy=function(e,t,n,o){void 0===n&&(n=0);var a=(i=this.getCurrentPos()).x,i=i.y;this.scrollTo(e+=a,t+=i,n,o=o||L.bounce)},be.prototype.scrollTo=function(e,t,n,a,i){void 0===n&&(n=0),void 0===a&&(a=L.bounce),void 0===i&&(i={start:{},end:{}});a=this.options.useTransition?a.style:a.fn;var r=this.getCurrentPos();r=o({x:r.x,y:r.y},i.start),e=o({x:e,y:t},i.end);this.hooks.trigger(this.hooks.eventTypes.scrollTo,e),function(e,t){for(var n=0,o=Object.keys(e);n<o.length;n++){var a=o[n];if(e[a]!==t[a])return}return 1}(r,e)||(t=Math.abs(e.x-r.x),i=Math.abs(e.y-r.y),t<1&&i<1&&(n=0,this.hooks.trigger(this.hooks.eventTypes.minDistanceScroll)),this.animater.move(r,e,n,a))},be.prototype.scrollToElement=function(e,t,n,o,a){function i(e,t,n){return"number"==typeof e?e:e?Math.round(t/2-n/2):0}function r(e,t,n,o){return o.adjustPosition((e-=t)-n)}var s=C(e=T(e));n=i(n,e.offsetWidth,this.wrapper.offsetWidth),o=i(o,e.offsetHeight,this.wrapper.offsetHeight),s.left=r(s.left,this.wrapperOffset.left,n,this.scrollBehaviorX),s.top=r(s.top,this.wrapperOffset.top,o,this.scrollBehaviorY),this.hooks.trigger(this.hooks.eventTypes.scrollToElement,e,s)||this.scrollTo(s.left,s.top,t,a)},be.prototype.resetPosition=function(e,t){void 0===e&&(e=0),void 0===t&&(t=L.bounce);var n=(o=this.scrollBehaviorX.checkInBoundary()).position,o=o.inBoundary,a=(i=this.scrollBehaviorY.checkInBoundary()).position,i=i.inBoundary;return!(o&&i||(d&&this.reflow(),this.scrollTo(n,a,e,t),0))},be.prototype.reflow=function(){this._reflow=this.content.offsetHeight},be.prototype.updatePositions=function(e){this.scrollBehaviorX.updatePosition(e.x),this.scrollBehaviorY.updatePosition(e.y)},be.prototype.getCurrentPos=function(){return this.actions.getCurrentPos()},be.prototype.enable=function(){this.actions.enabled=!0},be.prototype.disable=function(){F(this.animater.timer),this.actions.enabled=!1},be.prototype.destroy=function(){var e=this;["resizeRegister","transitionEndRegister","actionsHandler","actions","hooks","animater","translater","scrollBehaviorX","scrollBehaviorY"].forEach((function(t){return e[t].destroy()}))};var ye=be;function be(e,t,n){this.wrapper=e,this.content=t,this.resizeTimeout=0,this.hooks=new H(["beforeStart","beforeMove","beforeScrollStart","scrollStart","scroll","beforeEnd","scrollEnd","resize","touchEnd","end","flick","scrollCancel","momentum","scrollTo","minDistanceScroll","scrollToElement","beforeRefresh"]),this.options=n;var o,a,i=(l=this.options.bounce).left,r=l.right,s=l.top,l=l.bottom;this.scrollBehaviorX=new le(e,t,ge(n,"scrollX",[i,r],{size:"width",position:"left"})),this.scrollBehaviorY=new le(e,t,ge(n,"scrollY",[s,l],{size:"height",position:"top"})),this.translater=new Z(this.content),this.animater=(i=this.content,r=this.translater,t=(o=this.options).useTransition,n={},Object.defineProperty(n,"probeType",{enumerable:!0,configurable:!1,get:function(){return o.probeType}}),new(t?oe:re)(i,r,n)),this.actionsHandler=new Q(this.options.bindToTarget?this.content:e,(a=this.options,["click","bindToWrapper","disableMouse","disableTouch","preventDefault","stopPropagation","tagException","preventDefaultException","autoEndDistance"].reduce((function(e,t){return e[t]=a[t],e}),{}))),this.actions=new he(this.scrollBehaviorX,this.scrollBehaviorY,this.actionsHandler,this.animater,this.options),s=this.resize.bind(this);this.resizeRegister=new K(window,[{name:"orientationchange",handler:s},{name:"resize",handler:s}]),this.registerTransitionEnd(),this.init()}n(we,Se=H),we.use=function(e){var t=e.pluginName;return we.plugins.some((function(t){return e===t.ctor}))||(g(t)?s("Plugin Class must specify plugin's name in static property by 'pluginName' field."):(we.pluginsMap[t]=!0,we.plugins.push({name:t,applyOrder:e.applyOrder,ctor:e}))),we},we.prototype.setContent=function(e){var t=!1,n=!0;return(e=e.children[this.options.specifiedIndexAsContent])?(t=this.content!==e)&&(this.content=e):(s("The wrapper need at least one child element to be content element to scroll."),n=!1),{valid:n,contentChanged:t}},we.prototype.init=function(e){var t=this;e={x:(e=((this.wrapper=e).isBScrollContainer=!0,this.scroller=new ye(e,this.content,this.options),this.scroller.hooks.on(this.scroller.hooks.eventTypes.resize,(function(){t.refresh()})),this.eventBubbling(),this.handleAutoBlur(),this.enable(),this.proxy(i),this.applyPlugins(),this.refreshWithoutReset(this.content),this.options)).startX,y:e.startY};this.hooks.trigger(this.hooks.eventTypes.beforeInitialScrollTo,e)||this.scroller.scrollTo(e.x,e.y)},we.prototype.applyPlugins=function(){var e=this,t=this.options;we.plugins.sort((function(e,t){var n={pre:-1,post:1};return(e.applyOrder?n[e.applyOrder]:0)-(t.applyOrder?n[t.applyOrder]:0)})).forEach((function(n){var o=n.ctor;t[n.name]&&"function"==typeof o&&(e.plugins[n.name]=new o(e))}))},we.prototype.handleAutoBlur=function(){this.options.autoBlur&&this.on(this.eventTypes.beforeScrollStart,(function(){var e=document.activeElement;!e||"INPUT"!==e.tagName&&"TEXTAREA"!==e.tagName||e.blur()}))},we.prototype.eventBubbling=function(){ve(this.scroller.hooks,this,[this.eventTypes.beforeScrollStart,this.eventTypes.scrollStart,this.eventTypes.scroll,this.eventTypes.scrollEnd,this.eventTypes.scrollCancel,this.eventTypes.touchEnd,this.eventTypes.flick])},we.prototype.refreshWithoutReset=function(e){this.scroller.refresh(e),this.hooks.trigger(this.hooks.eventTypes.refresh,e),this.trigger(this.eventTypes.refresh,e)},we.prototype.proxy=function(e){var t=this;e.forEach((function(e){var n=e.key;e=e.sourceKey;!function(e,t,n){U.get=function(){for(var e=this,n=t.split("."),o=0;o<n.length-1;o++)if("object"!=r(e=e[n[o]])||!e)return;var a=n.pop();return"function"==typeof e[a]?function(){return e[a].apply(e,arguments)}:e[a]},U.set=function(e){for(var n,o=this,a=t.split("."),i=0;i<a.length-1;i++)o[n=a[i]]||(o[n]={}),o=o[n];o[a.pop()]=e},Object.defineProperty(e,n,U)}(t,e,n)}))},we.prototype.refresh=function(){var e=this.setContent(this.wrapper),t=e.contentChanged;e.valid&&(e=this.content,this.refreshWithoutReset(e),t&&(this.hooks.trigger(this.hooks.eventTypes.contentChanged,e),this.trigger(this.eventTypes.contentChanged,e)),this.scroller.resetPosition())},we.prototype.enable=function(){this.scroller.enable(),this.hooks.trigger(this.hooks.eventTypes.enable),this.trigger(this.eventTypes.enable)},we.prototype.disable=function(){this.scroller.disable(),this.hooks.trigger(this.hooks.eventTypes.disable),this.trigger(this.eventTypes.disable)},we.prototype.destroy=function(){this.hooks.trigger(this.hooks.eventTypes.destroy),this.trigger(this.eventTypes.destroy),this.scroller.destroy()},we.prototype.eventRegister=function(e){this.registerType(e)},we.plugins=[],we.pluginsMap={};var Se,Te=we;function we(e,t){var n=Se.call(this,["refresh","contentChanged","enable","disable","beforeScrollStart","scrollStart","scroll","scrollEnd","scrollCancel","touchEnd","flick","destroy"])||this;return(e=T(e))?(n.plugins={},n.options=(new Y).merge(t).process(),n.setContent(e).valid&&(n.hooks=new H(["refresh","enable","disable","destroy","beforeInitialScrollTo","contentChanged"]),n.init(e))):s("Can not resolve the wrapper DOM."),n}function ke(e,t){return new Te(e,t)}ke.use=Te.use,ke.plugins=Te.plugins,ke.pluginsMap=Te.pluginsMap,x=ke,e.Behavior=le,e.CustomOptions=q,e.createBScroll=ke,e.default=x,Object.defineProperty(e,"__esModule",{value:!0})})),"undefined"!=typeof window&&window.BScroll&&(window.BScroll=window.BScroll.default)},255:function(e,t,n){},256:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var e=this,t=this;this.textRange=null,this.getInputDoc=function(){var t;return 2==e.editorType?(t=_$("html_input").contentDocument)||(t=document.frames.html_input.document):t=document,t},this.getInputDocBody=function(){var t,n,o=e.editorType;return 3==o?(n=_$("html_pre_input")).blur||(n.blur=function(){window.focus()}):2==o?((t=_$("html_input").contentDocument)||(t=document.frames.html_input.document),n=t.body||t.getElementsByTagName("body")[0]):n=_$("textInput"),n},this.focusInput=function(t){var n,o,a,i=e.editorType;return 3==i?n=_$("html_pre_input"):2==i?(n=_$("html_input").contentWindow||document.frames.html_input,(o=_$("html_input").contentDocument)||(o=document.frames.html_input.document),a=o.body||o.getElementsByTagName("body")[0],!t&&a.focus()):n=_$("textInput"),!t&&n.focus(),!t&&a&&a.focus(),n},this.filterPasteData=function(e,t){var n=e&&e.replace(/^(<div>)(<br(\/)?>)+(<\/div>)/gi,"").replace(/(<div>)(<br(\/)?>)+(<\/div>)/gi,"\n").replace(/<([br|hr|div])+(\/)?>/gi,"\n").replace(/<\/(br|p|table|section|footer|article|li|ul|ol)>/gi,"\n").replace(/(<[a-z]+(\s+[^>]*)?\/?>)|(<\/[a-z]+>)/gi,"").replace(/&nbsp;/g," ");return"function"==typeof String.prototype.trimEnd?(t&&(e=e.trimEnd()),n=n.trimEnd()):(t&&(e=e.replace(/(\n|\r|[<br>]|\s)+$\w{0}/g,"")),n=n.replace(/(\n|\r|[<br>]|\s)+$\w{0}/g,"")),e&&t?e:n},this.filterPasteText=function(t,n,o,a){var i,r,s=_$("textInput");if(void 0===n&&(n=o.clipboardData&&clipboardData.setData?o.clipboardData.getData("text"):(t.originalEvent||t).clipboardData.getData("text/plain")||prompt(lanRes.vis_26)),n){if(n=e.filterPasteData(n),t.returnValue=!1,t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation(),n&&e.plainText)if(a.selection)a.selection.createRange().text=n;else if("number"==typeof s.selectionStart&&"number"==typeof s.selectionEnd){var l=s.selectionStart,c=s.selectionEnd,u=l,d=s.value;s.value=d.substring(0,l)+n+d.substring(c,d.length),u+=n.length,s.selectionStart=s.selectionEnd=u}else s.value+=n;else n&&a.body.createTextRange?(a.selection?textRange=a.selection.createRange():o.getSelection&&(i=o.getSelection().getRangeAt(0),(r=a.createElement("span")).innerHTML="&#FEFF;",i.deleteContents(),i.insertNode(r),textRange=a.body.createTextRange(),textRange.moveToElementText(r),r.parentNode.removeChild(r)),textRange.text=n,textRange.collapse(!1),textRange.select()):n&&a.execCommand("insertText",!1,n);return!1}return!0},this.sendMsg=function(e){o.default.triggerEventOnPoint("_sendMsg");try{3==t.editorType?window.getSelection().empty():2==t.editorType&&t.win.getSelection().empty()}catch(e){}t.textInputChange()},this.textInputChange=function(e){var n=t.getInput(),r=i.default.getStatusData(),l=i.default.getConfig("inputMaxLength"),c=i.default.getConfig("maxRobotLength"),u=-1;2==r.chatStatus&&r.talkType==a.default.talkTypeRobot?function(e,n){var o,a,i=0,r=0;for(n*=2,o=0;o<e.length;o++){if(null!=e.charAt(o).match(/[^\x00-\xff]/gi)?(i+=2,r+=1):i+=1,i>=n)return t.setInput(e.substr(0,i-r)),void $("#inputLengthTip").html(lanRes.inputLengthTip1+" 0 "+lanRes.inputLengthTip2);a=n/2-(parseInt(i/2)+i%2),$("#inputLengthTip").html(lanRes.inputLengthTip1+" "+a+" "+lanRes.inputLengthTip2)}}(n,l?Math.min(c,l):c):l&&l<n.length&&(n.substr(l-8,16).replace(o.default.Constants.regEmo,(function(e,t,n){u=n})),u=u>-1?8-u:0,t.setInput(n.substr(0,l-u))),n!=s&&(s=n),o.default.publish("textInputChangeEvt",e)}},n(3),n(22),n(11),n(257);var o=r(n(4)),a=r(n(45)),i=r(n(8));function r(e){return e&&e.__esModule?e:{default:e}}var s=""},260:function(e,t,n){(function(t){var n;"undefined"!=typeof self&&self,n=()=>(()=>{var e={75:function(e){(function(){var n,o,a,i,r,s;"undefined"!=typeof performance&&null!==performance&&performance.now?e.exports=function(){return performance.now()}:null!=t&&t.hrtime?(e.exports=function(){return(n()-r)/1e6},o=t.hrtime,i=(n=function(){var e;return 1e9*(e=o())[0]+e[1]})(),s=1e9*t.uptime(),r=i-s):Date.now?(e.exports=function(){return Date.now()-a},a=Date.now()):(e.exports=function(){return(new Date).getTime()-a},a=(new Date).getTime())}).call(this)},4087:(e,t,n)=>{for(var o=n(75),a="undefined"==typeof window?n.g:window,i=["moz","webkit"],r="AnimationFrame",s=a["request"+r],l=a["cancel"+r]||a["cancelRequest"+r],c=0;!s&&c<i.length;c++)s=a[i[c]+"Request"+r],l=a[i[c]+"Cancel"+r]||a[i[c]+"CancelRequest"+r];if(!s||!l){var u=0,d=0,f=[];s=function(e){if(0===f.length){var t=o(),n=Math.max(0,16.666666666666668-(t-u));u=n+t,setTimeout((function(){var e=f.slice(0);f.length=0;for(var t=0;t<e.length;t++)if(!e[t].cancelled)try{e[t].callback(u)}catch(e){setTimeout((function(){throw e}),0)}}),Math.round(n))}return f.push({handle:++d,callback:e,cancelled:!1}),d},l=function(e){for(var t=0;t<f.length;t++)f[t].handle===e&&(f[t].cancelled=!0)}}e.exports=function(e){return s.call(a,e)},e.exports.cancel=function(){l.apply(a,arguments)},e.exports.polyfill=function(e){e||(e=a),e.requestAnimationFrame=s,e.cancelAnimationFrame=l}}},n={};function o(t){var a=n[t];if(void 0!==a)return a.exports;var i=n[t]={exports:{}};return e[t].call(i.exports,i,i.exports,o),i.exports}o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var a={};return(()=>{"use strict";o.d(a,{default:()=>C});var e=o(4087),t=o.n(e);const n=function(e){return new RegExp(/<[a-z][\s\S]*>/i).test(e)},i=function(e,t){return Math.floor(Math.random()*(t-e+1))+e};var r="TYPE_CHARACTER",s="REMOVE_CHARACTER",l="REMOVE_ALL",c="REMOVE_LAST_VISIBLE_NODE",u="PAUSE_FOR",d="CALL_FUNCTION",f="ADD_HTML_TAG_ELEMENT",p="CHANGE_DELETE_SPEED",h="CHANGE_DELAY",m="CHANGE_CURSOR",g="PASTE_STRING",v="HTML_TAG";function y(e){return(y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function S(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(Object(n),!0).forEach((function(t){k(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function T(e){return function(e){if(Array.isArray(e))return w(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return w(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?w(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function k(e,t,n){return(t=I(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function I(e){var t=function(e,t){if("object"!==y(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,"string");if("object"!==y(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===y(t)?t:String(t)}const C=function(){function o(a,y){var b=this;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),k(this,"state",{cursorAnimation:null,lastFrameTime:null,pauseUntil:null,eventQueue:[],eventLoop:null,eventLoopPaused:!1,reverseCalledEvents:[],calledEvents:[],visibleNodes:[],initialOptions:null,elements:{container:null,wrapper:document.createElement("span"),cursor:document.createElement("span")}}),k(this,"options",{strings:null,cursor:"|",delay:"natural",pauseFor:1500,deleteSpeed:"natural",loop:!1,autoStart:!1,devMode:!1,skipAddStyles:!1,wrapperClassName:"Typewriter__wrapper",cursorClassName:"Typewriter__cursor",stringSplitter:null,onCreateTextNode:null,onRemoveNode:null}),k(this,"setupWrapperElement",(function(){b.state.elements.container&&(b.state.elements.wrapper.className=b.options.wrapperClassName,b.state.elements.cursor.className=b.options.cursorClassName,b.state.elements.cursor.innerHTML=b.options.cursor,b.state.elements.container.innerHTML="",b.state.elements.container.appendChild(b.state.elements.wrapper),b.state.elements.container.appendChild(b.state.elements.cursor))})),k(this,"start",(function(){return b.state.eventLoopPaused=!1,b.runEventLoop(),b})),k(this,"pause",(function(){return b.state.eventLoopPaused=!0,b})),k(this,"stop",(function(){return b.state.eventLoop&&((0,e.cancel)(b.state.eventLoop),b.state.eventLoop=null),b})),k(this,"pauseFor",(function(e){return b.addEventToQueue(u,{ms:e}),b})),k(this,"typeOutAllStrings",(function(){return"string"==typeof b.options.strings?(b.typeString(b.options.strings).pauseFor(b.options.pauseFor),b):(b.options.strings.forEach((function(e){b.typeString(e).pauseFor(b.options.pauseFor).deleteAll(b.options.deleteSpeed)})),b)})),k(this,"typeString",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(n(e))return b.typeOutHTMLString(e,t);if(e){var o=(b.options||{}).stringSplitter,a="function"==typeof o?o(e):e.split("");b.typeCharacters(a,t)}return b})),k(this,"pasteString",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return n(e)?b.typeOutHTMLString(e,t,!0):(e&&b.addEventToQueue(g,{character:e,node:t}),b)})),k(this,"typeOutHTMLString",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2?arguments[2]:void 0,o=function(e){var t=document.createElement("div");return t.innerHTML=e,t.childNodes}(e);if(o.length>0)for(var a=0;a<o.length;a++){var i=o[a],r=i.innerHTML;i&&3!==i.nodeType?(i.innerHTML="",b.addEventToQueue(f,{node:i,parentNode:t}),n?b.pasteString(r,i):b.typeString(r,i)):i.textContent&&(n?b.pasteString(i.textContent,t):b.typeString(i.textContent,t))}return b})),k(this,"deleteAll",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"natural";return b.addEventToQueue(l,{speed:e}),b})),k(this,"changeDeleteSpeed",(function(e){if(!e)throw new Error("Must provide new delete speed");return b.addEventToQueue(p,{speed:e}),b})),k(this,"changeDelay",(function(e){if(!e)throw new Error("Must provide new delay");return b.addEventToQueue(h,{delay:e}),b})),k(this,"changeCursor",(function(e){if(!e)throw new Error("Must provide new cursor");return b.addEventToQueue(m,{cursor:e}),b})),k(this,"deleteChars",(function(e){if(!e)throw new Error("Must provide amount of characters to delete");for(var t=0;t<e;t++)b.addEventToQueue(s);return b})),k(this,"callFunction",(function(e,t){if(!e||"function"!=typeof e)throw new Error("Callback must be a function");return b.addEventToQueue(d,{cb:e,thisArg:t}),b})),k(this,"typeCharacters",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!e||!Array.isArray(e))throw new Error("Characters must be an array");return e.forEach((function(e){b.addEventToQueue(r,{character:e,node:t})})),b})),k(this,"removeCharacters",(function(e){if(!e||!Array.isArray(e))throw new Error("Characters must be an array");return e.forEach((function(){b.addEventToQueue(s)})),b})),k(this,"addEventToQueue",(function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return b.addEventToStateProperty(e,t,n,"eventQueue")})),k(this,"addReverseCalledEvent",(function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return b.options.loop?b.addEventToStateProperty(e,t,n,"reverseCalledEvents"):b})),k(this,"addEventToStateProperty",(function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3?arguments[3]:void 0,a={eventName:e,eventArgs:t||{}};return b.state[o]=n?[a].concat(T(b.state[o])):[].concat(T(b.state[o]),[a]),b})),k(this,"runEventLoop",(function(){b.state.lastFrameTime||(b.state.lastFrameTime=Date.now());var e=Date.now(),n=e-b.state.lastFrameTime;if(!b.state.eventQueue.length){if(!b.options.loop)return;b.state.eventQueue=T(b.state.calledEvents),b.state.calledEvents=[],b.options=S({},b.state.initialOptions)}if(b.state.eventLoop=t()(b.runEventLoop),!b.state.eventLoopPaused){if(b.state.pauseUntil){if(e<b.state.pauseUntil)return;b.state.pauseUntil=null}var o,a=T(b.state.eventQueue),y=a.shift();if(!(n<=(o=y.eventName===c||y.eventName===s?"natural"===b.options.deleteSpeed?i(40,80):b.options.deleteSpeed:"natural"===b.options.delay?i(120,160):b.options.delay))){var w=y.eventName,k=y.eventArgs;switch(b.logInDevMode({currentEvent:y,state:b.state,delay:o}),w){case g:case r:var I=k.character,C=k.node,x=document.createTextNode(I),E=x;b.options.onCreateTextNode&&"function"==typeof b.options.onCreateTextNode&&(E=b.options.onCreateTextNode(I,x)),E&&(C?C.appendChild(E):b.state.elements.wrapper.appendChild(E)),b.state.visibleNodes=[].concat(T(b.state.visibleNodes),[{type:"TEXT_NODE",character:I,node:E}]);break;case s:a.unshift({eventName:c,eventArgs:{removingCharacterNode:!0}});break;case u:var $=y.eventArgs.ms;b.state.pauseUntil=Date.now()+parseInt($);break;case d:var D=y.eventArgs,M=D.cb,_=D.thisArg;M.call(_,{elements:b.state.elements});break;case f:var P=y.eventArgs,N=P.node,B=P.parentNode;B?B.appendChild(N):b.state.elements.wrapper.appendChild(N),b.state.visibleNodes=[].concat(T(b.state.visibleNodes),[{type:v,node:N,parentNode:B||b.state.elements.wrapper}]);break;case l:var O=b.state.visibleNodes,L=k.speed,R=[];L&&R.push({eventName:p,eventArgs:{speed:L,temp:!0}});for(var A=0,j=O.length;A<j;A++)R.push({eventName:c,eventArgs:{removingCharacterNode:!1}});L&&R.push({eventName:p,eventArgs:{speed:b.options.deleteSpeed,temp:!0}}),a.unshift.apply(a,R);break;case c:var F=y.eventArgs.removingCharacterNode;if(b.state.visibleNodes.length){var U=b.state.visibleNodes.pop(),H=U.type,V=U.node,K=U.character;b.options.onRemoveNode&&"function"==typeof b.options.onRemoveNode&&b.options.onRemoveNode({node:V,character:K}),V&&V.parentNode.removeChild(V),H===v&&F&&a.unshift({eventName:c,eventArgs:{}})}break;case p:b.options.deleteSpeed=y.eventArgs.speed;break;case h:b.options.delay=y.eventArgs.delay;break;case m:b.options.cursor=y.eventArgs.cursor,b.state.elements.cursor.innerHTML=y.eventArgs.cursor}b.options.loop&&(y.eventName===c||y.eventArgs&&y.eventArgs.temp||(b.state.calledEvents=[].concat(T(b.state.calledEvents),[y]))),b.state.eventQueue=a,b.state.lastFrameTime=e}}})),a)if("string"==typeof a){var w=document.querySelector(a);if(!w)throw new Error("Could not find container element");this.state.elements.container=w}else this.state.elements.container=a;y&&(this.options=S(S({},this.options),y)),this.state.initialOptions=S({},this.options),this.init()}var a,y;return a=o,(y=[{key:"init",value:function(){var e;this.setupWrapperElement(),this.addEventToQueue(m,{cursor:this.options.cursor},!0),this.addEventToQueue(l,null,!0),!window||window.___TYPEWRITER_JS_STYLES_ADDED___||this.options.skipAddStyles||((e=document.createElement("style")).appendChild(document.createTextNode(".Typewriter__cursor{-webkit-animation:Typewriter-cursor 1s infinite;animation:Typewriter-cursor 1s infinite;margin-left:1px}@-webkit-keyframes Typewriter-cursor{0%{opacity:0}50%{opacity:1}100%{opacity:0}}@keyframes Typewriter-cursor{0%{opacity:0}50%{opacity:1}100%{opacity:0}}")),document.head.appendChild(e),window.___TYPEWRITER_JS_STYLES_ADDED___=!0),!0===this.options.autoStart&&this.options.strings&&this.typeOutAllStrings().start()}},{key:"logInDevMode",value:function(e){this.options.devMode&&console.log(e)}}])&&function(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,I(o.key),o)}}(a.prototype,y),Object.defineProperty(a,"prototype",{writable:!1}),o}()})(),a.default})(),e.exports=n()}).call(this,n(261))},262:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(136);var o=l(n(4)),a=l(n(72)),i=l(n(137)),r=l(n(263)),s=l(n(264));n(16);function l(e){return e&&e.__esModule?e:{default:e}}var c,u;a.default.infoScroll;o.default.subscribe("changeNetWsStatus",(function(e,t){DataService.getDataByName("websocketStatus")==o.default.Constants.websocketStoped&&t?o.default.publish("changeDom",{name:"#networkDisconnected",cls:"toast-network-showbtn",removeCls:"hide"}):t?o.default.publish("changeDom",{name:"#networkDisconnected",cls:"hide"}):o.default.publish("changeDom",{name:"#networkDisconnected",removeCls:["hide","toast-network-showbtn"]})})),u=function(e){c=e,r.default.init(e),i.default.init(e),s.default.init(),$("#sa_advise").on("blur",(function(){window.scrollTo(0,0)})),$("#content").on("click",(function(e){c.getInputDocBody().blur()})),$("#networkDisconnected").on("click",(function(e){o.default.publish("__openWebsocket")}))};t.default={init:u}},263:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(10);var o=r(n(8)),a=r(n(42)),i=r(n(4));function r(e){return e&&e.__esModule?e:{default:e}}var s,l,c,u=a.default.callEchatNative,d=null,f=null,p=-1;i.default.subscribe("recordEvent",(function(e,t){if(0==t.type||1==t.type)d&&d(t.type);else if(2==t.type&"number"==typeof t.db){var n;n=t.db<40?0:(n=parseInt((t.db-40)/10))>5?5:n<1?1:n,$(".icon-record-sound").results[0].className="icon-record-sound echat icon-record-sound"+n}else 3==t.type&&"number"==typeof t.timeout?(console.log("record-countdown",t.timeout),$("body").addClass("record-countdown"),$(".icon-record-countdown").html(t.timeout)):4==t.type?f&&f():5==t.type?(f&&f(),i.default.showTip(lanRes.vis_24)):7==t.type&&f&&f()})),s=function(){var e=o.default.getVisitorInfo().companyId;function t(e){u("voice",{type:5}),f&&f()}e&&"522166"!=e&&$(".record-switch").removeClass("limit-hide"),$(".record-switch").on("click",(function(){$("#chatText").hasClass("recording")?$("#chatText").removeClass("recording"):$("#chatText").addClass("recording")})),l="getSelection"in window?function(){window.getSelection().removeAllRanges()}:function(){document.selection.empty()},$(".btn-record").on("contextmenu",(function(e){e.preventDefault&&e.preventDefault()})).on("touchstart",(function(e){l();var n,o,a=c?e:e.touches[0];(c=function(e,t){return e.type=="pointer"+t||e.type.toLowerCase()=="mspointer"+t}(e,"down"))&&("touch"!=(o=e).pointerType&&o.pointerType!=o.MSPOINTER_TYPE_TOUCH||!o.isPrimary)||(n={x1:a.pageX,y1:a.pageY,start:(new Date).getTime()},p=0,d=function(e){d=null,0===p&&(1==e?($("body").addClass("record-touching").removeClass("record-canceling").removeClass("record-countdown"),$(".btn-record").html(lanRes.visitor194),u("voice",{type:2}),p=1,i.default.hideTip()):i.default.showTip(lanRes.vis_25))},setTimeout((function(){0==p&&u("voice",{type:1,record_time:60})}),0),f=function(){p=-1,$("body").removeClass("record-touching").removeClass("record-canceling"),$(".btn-record").html(lanRes.visitor193),$(document).off("touchmove",r).off("touchend",t),f=null,d=null,l()},$(document).on("touchmove",r).on("touchend",t),!1!==e.cancelable&&e.preventDefault&&e.preventDefault());function r(e){l(),a=c?e:e.touches[0],n.x2=a.pageX,n.y2=a.pageY,1!=p&&2!=p||(Math.abs(n.y1-n.y2)>30?1==p&&($("body").addClass("record-canceling"),u("voice",{type:3}),p=2):2==p&&($("body").removeClass("record-canceling"),u("voice",{type:4}),p=1))}}))};t.default={init:s}},264:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(54),n(136);var o=s(n(42)),a=s(n(4)),i=s(n(8)),r=n(16);function s(e){return e&&e.__esModule?e:{default:e}}var l=o.default.callEchatNative;a.default.subscribe("showURLLink",(function(e,t,n,o){var a={url:n,openType:(o=o||{}).openType||"half"};o&&o.workorder?(a.openType=o.openType||"coverChat",a.registerBridge=8191,a.isCanOtherHandle=0):o&&5==o.from&&(a.registerBridge=7,a.isCanOtherHandle=1),l("openUrl",a)}));t.default={init:function(){$("#urlList").on("click",".list-url-item",(function(e){var t=i.default.getConfig("urlListConfig"),n=t&&t[this.getAttribute("data-index")],o=n&&n.url;n&&o&&(o=(0,r.getADURL)(!0,n.openWindowParamList.concat(n.afterConnectParamList||[]),o),l("openUrl",{url:o,openType:1==n.openType?"default":"half"}))})),$("body").on("click","a",(function(e){var t,n,o=this;if($.fn.contains(_$("list_his"),o)||$.fn.contains(_$("innerADWrap"),o))return t=o.getAttribute("href"),n=o.getAttribute("target"),!!t&&(t=(0,r.addFixedParam)(t),"inner"==n||"menuSiteIframe"==n?l("openUrl",{url:t,openType:"half"}):n&&"cover"==n?l("openUrl",{url:t,openType:"coverChat"}):n&&"_blank"==n||n&&_$(n)?l("openUrl",{url:t,openType:"default"}):l("openUrl",{url:t,openType:"half"}),e.preventDefault&&e.preventDefault(),!1)}))}}},265:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(3),n(11),n(10);var o=r(n(4)),a=r(n(8)),i=n(16);function r(e){return e&&e.__esModule?e:{default:e}}var s={innerAD:{notEnableParam:!1,params:"[]",element:"#inner_frame",hash:!0,srcUrl:void 0,attr:"src",url:""},innerImgUrl:{attr:"href"},rightAD:null,leftAD:null,innerURL:{},merchantLink:null,staffInfo:null,urlList:null};o.default.subscribe("updateChatStaffInfo",(function(){function e(e){if(e.srcUrl){var t,n=(0,i.getADURL)(!e.notEnableParam,e.params,e.srcUrl,e.hash);$(e.element).each((function(o,a){t=n,"IFRAME"==a.tagName&&(t=(0,i.addEchatInnerFrameParam)(n)),"src"==e.attr?a.src=t:"href"==e.attr?a.href=t:$(a).attr(e.attr,t)})),e.url=t}}var t,n,a;for(t in s)if(n=s[t])if(o.default.isArray(n))for(a=0;a<n.length;a++)e(n[a]);else e(n)}));t.default={init:function(){o.default.subscribe("setTheme",(function(){!function(){console.log("**************** set config set theme ***************");var e=o.default.setCss,t=a.default.getChatbox(),n=a.default.getConfig("config649"),i=n.robotWordsInfo;if(t){a.default.setConfigs({echatSourceTagEnable:"1"==n.echatSourceTagEnable,showAvatar:"1"==t.chatBoxStaffImgEnable,busyCanSend:"1"!=t.busyNotAllowSendStatus,robotFeedback:i&&"1"==i.enableFedBack}),t.chatColor=t.chatColor||t.chatThemeBackColor,e(".bg0",[{attr:"color",value:t.chatThemeTxtColor},{attr:"backgroundColor",value:t.chatColor}]),e(".border0",{attr:"borderColor",value:t.chatColor}),e(".color0",{attr:"color",value:t.chatColor}),e(".bg1",[{attr:"backgroundColor",value:t.chatStaffBackColor},{attr:"borderColor",value:t.chatStaffBackColor},{attr:"color",value:t.chatStaffTxtColor}]),e(".msg-item .circle-item",{attr:"backgroundColor",value:t.chatStaffTxtColor}),e(".colorbg1",{attr:"color",value:t.chatStaffBackColor}),e(".bg3",[{attr:"backgroundColor",value:t.chatVisitorBackColor},{attr:"borderColor",value:t.chatVisitorBackColor},{attr:"color",value:t.chatVisitorTxtColor}]),e(".colorbg3",{attr:"color",value:t.chatVisitorBackColor}),e(".msg-info",[{attr:"backgroundColor",value:t.sysMsgBackground},{attr:"color",value:t.sysMsgFontColor}]);var r=o.default.getBackground(t.windowThemeBackColor,t.windowThemeBackTransparency);return t.sysMsgBackground&&(e(".color1",{attr:"color",value:t.windowTextColor}),e(".msg-staff-name",{attr:"color",value:t.windowTextColor}),e(".hr-left",{attr:"backgroundColor",value:t.windowTextColor}),e(".hr-right",{attr:"backgroundColor",value:t.windowTextColor})),t.windowThemeBackColor&&(e(".bg4",{attr:"backgroundColor",value:r}),e(".hr-left",{attr:"background",value:"linear-gradient(to right,"+r+" 0%, "+t.windowTextColor+" 40%, "+t.windowTextColor+" 100%)"}),e(".hr-right",{attr:"background",value:"linear-gradient(to left,"+r+" 0%, "+t.windowTextColor+" 40%, "+t.windowTextColor+" 100%)"})),t.evaluateThemeColor&&(e("body .sub-selected",[{attr:"color",value:"#fff"},{attr:"backgroundColor",value:t.evaluateThemeColor}]),e(".emcolor",{attr:"color",value:t.evaluateThemeColor}),e(".embgcolor",{attr:"backgroundColor",value:t.evaluateThemeColor})),i?(e(".feedback-btn-solve",{attr:"backgroundColor",value:(t=i).solvedBackColor}),e(".sub-solved-li",{attr:"backgroundColor",value:t.solvedBackColor}),e(".feedback-btn-solve-sel",{attr:"backgroundColor",value:t.solvedSelectColor}),e(".feedback-sub-sel1",{attr:"backgroundColor",value:t.solvedSelectColor}),e(".feedback-btn-unsolve",{attr:"backgroundColor",value:t.unsolvedBackColor}),e(".sub-unsolved-li",{attr:"backgroundColor",value:t.unsolvedBackColor}),e(".feedback-btn-unsolve-sel",{attr:"backgroundColor",value:t.unsolvedSelectColor}),e(".feedback-sub-sel2",{attr:"backgroundColor",value:t.unsolvedSelectColor}),t):t}console.log("没有对话窗口配置")}(),function(){if(a.default.getConfig("companyVersionType")!=o.default.Constants.companyCommon){var e=a.default.getConfig("config649"),t=a.default.getConfig("config600"),n=a.default.getChatbox(),r=1==n.chatLogoImgEnable?1==n.chatLogoImgType?t.platformLogo:e.companyLogo:void 0,s=1==n.subcompanyUrlEnable&&n.subcompanyButtonUrl?n.subcompanyButtonUrl:void 0,l=1==n.subcompanyUrlType?e.companyWebSite:n.subcompanyUrl,c=1==n.subcompanyUrlType||1!=n.subcompanyAdPostEnable?void 0:n.subcompanyAdPostParamList;s?l&&c&&(l=(0,i.getADURL)(!0,c,l,!1)):l=void 0,o.default.publish("__setTitleShop",{title:e.companyName,logo:r,shopEnter:s?{imageUrl:s,openUrl:l||""}:void 0})}}(),2==a.default.getStatusByKey("chatStatus")&&function(){var e,t,n,r,l=a.default.getChatbox(),c=l.chatBoxAdHeight,u=1==l.chatBoxAdImgLinkFixed;function d(){o.default.publish("changeDom",{name:"#innerADWrap",removeCls:"hide"})}c=c?parseInt(c):0,$(".innerAD").each((function(){$("#list_msg").contains(this)||$(this).remove()})),2==l.chatBoxInnerAdType?e=l.chatBoxInnerAdContent:3==l.chatBoxInnerAdType?e=c&&l.chatBoxInnerAdImg:1==l.chatBoxInnerAdType&&(e=c&&l.chatBoxInnerAdUrl),e&&(2==l.chatBoxInnerAdType?t='<li class="clearfix innerAD innerAD-text"><div>'+e+"</div></li>":3==l.chatBoxInnerAdType?(r=(new Date).getTime(),window["resetInnerAdHeight"+r]=function(e,t,n){if(n==r){var o=(t>e?e:t)+20;u&&$("#innerADWrap").css("height",o+"px"),d()}},o.default.needHttps&&(e=e.replace(/^http:/,o.default.needHttps)),l.chatBoxInnerAdImgLinkUrl?(n=(0,i.getADURL)(l.chatBoxAdPostEnable,l.chatBoxInnerAdPostParamList||"{}",l.chatBoxInnerAdImgLinkUrl,1!=l.chatBoxInnerAdParamAppendType),t='<li class="clearfix innerAD innerAD-img"><a id="innerADLink" target="'+(1==l.chatBoxInnerAdImgLinkOpenType?window.SDK?"cover":"_blank":"inner")+'" href="'+n+'"><img onload="resetInnerAdHeight'+r+"(this.height,"+c+","+r+')" onerror="resetInnerAdHeight'+r+"(this.height,"+c+","+r+')" style="max-height:'+c+'px" src="'+e+'"/></a></li>',$.extend(s.innerImgUrl,{notEnableParam:1!=l.chatBoxAdPostEnable,srcUrl:l.chatBoxInnerAdImgLinkUrl,url:e,params:l.chatBoxInnerAdPostParamList||"{}",hash:1!=l.chatBoxInnerAdParamAppendType,element:"#innerADLink"})):t='<li class="clearfix innerAD innerAD-img"><img onload="resetInnerAdHeight'+r+"(this.height,"+c+","+r+')" style="max-height:'+c+'px" src="'+e+'"/></li>'):1==l.chatBoxInnerAdType&&(o.default.needHttps&&(e=e.replace(/^http:/,o.default.needHttps)),e=(0,i.getADURL)(l.chatBoxAdPostEnable,l.chatBoxInnerAdPostParamList||"{}",e,1!=l.chatBoxInnerAdParamAppendType),t='<li class="clearfix innerAD innerAD-url"><iframe id="inner_frame" class="ps-child" height="'+l.chatBoxAdHeight+'px" border="0" allowtransparency="true" scrolling="no" frameborder="0" style="width:100%;height:'+l.chatBoxAdHeight+'px" src="'+(0,i.addEchatInnerFrameParam)(e)+'" ></iframe></li>',$.extend(s.innerAD,{notEnableParam:1!=l.chatBoxAdPostEnable,srcUrl:l.chatBoxInnerAdUrl,url:e,params:l.chatBoxInnerAdPostParamList||"{}",hash:1!=l.chatBoxInnerAdParamAppendType,element:"#inner_frame"})),u?($("#innerADWrap").html(t).removeClass("hide"),d()):($("#list_msg").append(t),o.default.publish("changeDom",{name:"#innerADWrap",cls:"hide"})),2==l.chatBoxInnerAdType&&(setTimeout(d,1e3),setTimeout(d,5e3)))}()}))}}},266:function(e,t,n){"use strict";n(54),n(35),n(26),n(32),n(19),n(3),n(11),n(10);var o=l(n(4));n(182),n(183);var a=l(n(8)),i=l(n(16)),r=l(n(72)),s=n(184);function l(e){return e&&e.__esModule?e:{default:e}}var c,u,d,f,p,h,m,g=o.default.isMobile,v=!g&&2==o.default.windowType;function y(){function e(){var e;$("#verify_change").hasClass("loadin")||($("#verify_change").addClass("loadin"),e={et:122,windowType:o.default.windowType,content:"refresh code"},"1"==o.default.queryParams.autoPop&&(e.isAutoPop=1),o.default.publish("sendMessage",e))}$("#verify_change").removeClass("loadin"),$("#verify_input").removeClass("error").val(""),$("#verify_img").off("click").on("click",e),$("#verify_change").off("click").bind("click",e),$("#verify_input").off("click").bind("keydown",(function(){$("#verify_input").removeClass("error")})),$("#verify_ok").off("click").bind("click",(function(){if(!$("#verify_change").hasClass("loadin")){var e,t=$("#verify_input").val();t?($("#verify_change").addClass("loadin"),e={et:106,captcha:t,windowType:o.default.windowType},"1"==o.default.getQueryParams.autoPop&&(e.isAutoPop=1),o.default.publish("sendMessage",e)):$("#verify_input").addClass("error")}}))}o.default.subscribe("displayCode",(function(e,t){c(t)})),o.default.subscribe("displayEntryDom",(function(e,t){if(o.default.dji&&1==t.entranceInfo.entranceLevel)return a.default.setStatusByKey("isInEntryOrCode",!1),o.default.triggerEventOnPoint("registChat"),!1;var n,i=t.entranceInfo,r=2==a.default.getStatusByKey("status"),l=!1,c=i.buzFieldSettings||[],d=i.fieldSettings||[],p=a.default.getVisitorInfo(),h=p.visitorId,m=p.companyId,g=r&&"0"==i.offlineStartType,v=decodeURIComponent($.store("ECHAT_"+m+"_"+h+"_ENTRY_HIS")||"{}");d=d.concat(c),v=JSON.parse(v),1!=i.entranceLevel&&g&&(i.entranceLevel=1,l=!0,d=[{enable:1,field:"gender",fieldId:7106,isSystem:1,label:lanRes.vis_34,lan:"default",settings:[{configs:[{item:lanRes.male,sort:1,value:"1"},{item:lanRes.female,sort:2,value:"2"}],lan:"default"}],type:4},{enable:1,field:"maritalStatus",fieldId:7107,isSystem:1,label:lanRes.vis_35,lan:"default",settings:[{configs:[{item:lanRes.married,sort:1,value:"2"},{item:lanRes.unmarried,sort:2,value:"1"}],lan:"default"}],type:4},{enable:1,field:"age",fieldId:7109,isSystem:1,label:lanRes.vis_36,lan:"default",settings:[{configs:{end:127,start:1,stepSize:1},lan:"default"}],type:7},{enable:1,field:"birthday",fieldId:7108,isSystem:1,label:lanRes.vis_37,settings:[],type:6}],i.upgradeOfflineVisitorInfoConfiguration=i.offlineVisitorInfoConfiguration,i.upgradeOfflineWelcomeWord=i.offlineWelcomeWord),$("#entry").remove(),n=1==i.entranceLevel?u(i,v,l,d):f(i,v),o.default.publish("__setTitle",r?lanRes.leaveWord:lanRes.onlineService),(0,s.resetOptionField)(n,d,"entrance",i)})),f=function(e,t){var n,i,r,s,l,c,u=2==a.default.getStatusByKey("status"),f=(u?e.offlineVisitorInfoConfiguration:e.visitorInfoConfiguration)||[],h=f&&f.length||0,g=!a.default.getStatusByKey("captChaToken")&&function(e){var t,n=!0;for(t=0;t<e.length&&(n=n&&"1"==e[t].configInline);t++);return n?"1":"0"}(f),v=a.default.getConfig("isVip"),y=0,b=0,S="",T=0;for(e=$.extend({},e),!0===u&&(e.welcomeWord=e.offlineWelcomeWord,e.welcomeWordPos=e.offlineWelcomeWordPos,e.entryCanClose=e.offlineEntryCanClose,e.visitorInfoCloseImg=e.offlineVisitorInfoCloseImg,e.visitorInfoClosePos=e.offlineVisitorInfoClosePos,e.visitorInfoFormPos=e.offlineVisitorInfoFormPos,e.visitorInfoBackImg=e.offlineVisitorInfoBackImg,e.visitorInfoLabelColor=e.offlineVisitorInfoLabelColor,e.visitorInfoInputColor=e.offlineVisitorInfoInputColor,e.visitorInfoSubmitPos=e.offlineVisitorInfoSubmitPos,e.visitorInfoSubmitTxt=e.offlineVisitorInfoSubmitTxt,e.buttonBackgroundColor=e.offlineButtonBackgroundColor,e.visitorInfoBackgroundColor=e.offlineVisitorInfoBackgroundColor,e.visitorInfoSubmitImg=e.offlineVisitorInfoSubmitImg),o.default.needHttps&&(e.visitorInfoCloseImg&&(e.visitorInfoCloseImg=e.visitorInfoCloseImg.replace(/^http:/,o.default.needHttps)),e.visitorInfoBackImg&&(e.visitorInfoBackImg=e.visitorInfoBackImg.replace(/^http:/,o.default.needHttps)),e.visitorInfoSubmitImg&&(e.visitorInfoSubmitImg=e.visitorInfoSubmitImg.replace(/^http:/,o.default.needHttps))),console.log(e.visitorInfoBackImg),s=' <div id="entryWrap" class="'+("1"==g?"book-all-line ":"")+'" >'+(1==e.entryCanClose&&e.visitorInfoCloseImg?'<div id="cancelEntryBtn" style="'+e.visitorInfoClosePos+'"><img src="'+e.visitorInfoCloseImg+'" onload="imgLoadResizeSelf(this)" /></div>':"")+(e.visitorInfoBackImg?'<div><img id="entryWrapImg" class="book-table-img hide" src="'+e.visitorInfoBackImg+'" onload="imgLoadResize(this,-1)" /></div>':"")+'<form id="entryForm" name="entryForm" class="book-items" ><div class="book-form-title0" style="'+e.welcomeWordPos+'">'+(e.welcomeWord||"")+'</div> <div class="clearfix book-items-list" style="'+e.visitorInfoFormPos+';">',c=0;c<h;c++)S=1==(l=f[c]).configRequired?" req ":"","1"==l.configInline?y=parseInt(y+1.5):y+=.5,"1"==l.configWebVipVisitor&&v||"1"==l.configWebVisitor&&!v?("1"==l.configInline?b=parseInt(b+1.5):b+=.5,i=t[n=l.configName],r=window.ltIE10?"text":"birthday"==n?"date":"age"==n?"number":"text",s+='<div class="book-half book-item'+S+("1"==l.configInline?" book-one-line":"")+("gender"==n||"maritalStatus"==n?" book-item-opts":"")+'"><label class="book-label" style="color:'+e.visitorInfoLabelColor+'"><span class="req-span color0">*</span><span class="name-span">'+l.configDesc+"</span></label>"+("gender"==n?'<label class="input-radio-lb" style="color:'+e.visitorInfoLabelColor+'"><input type="radio" class="book-radio '+S+'" name="gender" value="1" '+(1==i?'checked="checked"':"")+' lb="'+l.configDesc+'"/><span class="radio-span">'+lanRes.male+'</span></label><label class="input-radio-lb" style="color:'+e.visitorInfoLabelColor+'"><input type="radio" class="book-radio '+S+'" name="gender" value="2" '+(2==i?'checked="checked"':"")+' lb="'+l.configDesc+'" /><span class="radio-span">'+lanRes.female+"</span></label>":"maritalStatus"==n?'<label class="input-radio-lb" style="color:'+e.visitorInfoLabelColor+'"><input type="radio" class="book-radio '+S+'" name="maritalStatus" value="1" '+(1==i?'checked="checked"':"")+' lb="'+l.configDesc+'"/><span class="radio-span">'+lanRes.unmarried+'</span></label><label class="input-radio-lb" style="color:'+e.visitorInfoLabelColor+'"><input type="radio" class="book-radio '+S+'" name="maritalStatus" value="2" '+(2==i?'checked="checked"':"")+' lb="'+l.configDesc+'"/><span class="radio-span">'+lanRes.married+"</span></label>":'<input autocomplete="off" type="'+r+'" lb="'+l.configDesc+'" class="book-ipt '+S+'" name="'+n+'" value="'+(i||"")+'" style="border-bottom-color:'+e.visitorInfoInputColor+";color:"+e.visitorInfoInputColor+';"/>')+"</div>"):(f[c].disabled=!0,T++);if(a.default.getStatusByKey("captChaToken")&&(s+='<div class="clearfix"><div class="book-half book-item req" id="verifyInner"><label class="book-label" style="color:'+e.visitorInfoLabelColor+'"><span class="req-span color0">*</span><span class="name-span">'+lanRes.validateCode+'</span></label><input autocomplete="off" type="text" id="verify_input" class="book-ipt req" lb="'+lanRes.validateCode+'" style="border-color:'+e.visitorInfoInputColor+'"/></div><div class="book-half book-item verify-line"><img onerror="this.className=this.className.replace(\'loadin\',\'\')" alt="'+lanRes.validateCode+'" id="verify_img" src="'+m(e)+'"/><span class="color0 cursor-p" id="verify_change">'+lanRes.nextPic+"</span></div></div>"),s+="</div>",s+='<div id="submitBtnentry" style="'+e.visitorInfoSubmitPos+'" class="book-btn"> <span class="book-btn-text">'+(e.visitorInfoSubmitTxt||"")+"</span></div>",s+="</form></div>",$("body").append('<div id="entry" class="entry-wrap0" style="display:block">'+s+"</div>"),$("body").addClass("entry"),1==o.default.windowType&&(y=parseInt(y+.5),b=parseInt(b+.5),T=y-b),T>0&&setTimeout((function(){$(".book-items-list").css("paddingBottom",view.px2rem?view.px2rem(30*T):30*T+"px")}),10),e.visitorInfoSubmitImg){var w=new Image;w.onload=function(){var t=_$("submitBtnentry").style;t.backgroundImage="url('"+e.visitorInfoSubmitImg+"')",t.backgroundSize=(view.px2rem?view.px2rem(this.width):this.width+"px")+" "+(view.px2rem?view.px2rem(this.height):this.height+"px"),t.lineHeight=view.px2rem?view.px2rem(this.height):this.height+"px",t.height=view.px2rem?view.px2rem(this.height):this.height+"px",t.width=view.px2rem?view.px2rem(this.width):this.width+"px",t=null,w=null},w.src=e.visitorInfoSubmitImg}return d({list:f,entry:e,submitSelector:"#submitBtnentry"}),$("#cancelEntryBtn").on("click",p),setTimeout((function(){var e=_$("entryForm").offsetHeight+20+_$("entryForm").offsetTop;_$("entry").style.minHeight=e+"px"}),100),f},u=function(e,t,n,i){var r,l,c,u,f,h,y,b,S=a.default.getConfig("config600").lan||e.lan||"default",T=a.default.getConfig("isVip"),w=2==a.default.getStatusByKey("status"),k=w&&"0"==e.offlineStartType,I='<div class="entry2-item"><div class="entry2-label {{req}}"><span class="req-span">*</span><span class="entry2-name">{{configDesc}}:</span></div><div class="entry2-typeline {{req}}" lb="{{configDesc}}">{{typeline}}</div></div>',C=!0===w?e.upgradeOfflineVisitorInfoConfiguration:e.upgradeVisitorInfoConfiguration,x=C&&C.length||0,E="",D="",M=[],_={};for(!0===w&&(e.upgradeVisitorInfoSubmitTxt=e.upgradeOfflineVisitorInfoSubmitTxt,e.upgradeWelcomeWord=e.upgradeOfflineWelcomeWord),M.push(1!=o.default.windowType||o.default.dji?"entry2-mb":"entry2-pc"),!g&&v&&M.push("entry2-pc-mini"),M.push(k?"entry2-form":"entry2-half"),u=_,f=0;f<i.length;f++)if(c=u[i[f].field]=i[f],r=null,(c=i[f]).settings&&c.settings.length>0)if(1==c.settings.length)c.configs=c.settings[0].configs;else{for(h=0;h<c.settings.length;h++){if(c.settings[h].lan==S){c.configs=c.settings[h].configs;break}"default"==c.settings[h].lan&&(r=c.settings[h].configs)}!c.configs&&(c.configs=r||c.settings[0].configs)}for(y=0;y<x;y++)if(0==(l=C[y]).configWebVipVisitor&&T||0==l.configWebVisitor&&!T)l.disabled=!0;else{if(!_[l.configName]){if(!n){l.disabled=!0;continue}_[l.configName]={type:1}}var P=_[l.configName].type,N=t[l.configName];E=(0,s.getElementByFieldType)(_,P,l,N),D+=I.replace("{{typeline}}",E).replace(/\{\{configName\}\}/g,l.configName).replace(/\{\{configDesc\}\}/g,l.configDesc).replace(/\{\{wordDesc\}\}/g,"").replace(/\{\{value\}\}/g,N||"").replace(/\{\{req\}\}/g,1==l.configRequired?"req":"")}return k&&(D+=I.replace(/\{\{req\}\}/g,"req").replace(/\{\{configDesc\}\}/g,lanRes.leaveWordContent).replace("{{typeline}}",'<textarea autocomplete="off" rows="4" lb="'+lanRes.leaveWordContent+'" autoHeight="true"  class="entry2-textarea leave-entry-text req"></textarea>')),a.default.getStatusByKey("captChaToken")&&(D+=I.replace(/\{\{req\}\}/g,"req").replace(/\{\{configDesc\}\}/g,lanRes.validateCode).replace("{{typeline}}",'<input autocomplete="off" type="text" id="verify_input" lb="'+lanRes.validateCode+'" class="entry2-input entry2-input-code req" /><img alt="'+lanRes.validateCode+'" id="verify_img" src="'+m(e)+'" onerror="this.className=this.className.replace(\'loadin\',\'\')" /><span class="color0 cursor-p" id="verify_change">'+lanRes.nextPic+"</span>")),D='<div id="entry" class="{{entryClass}}"><form id="entryForm" class="entry2-wrap"><div class="entry2-title bg0">{{upgradeWelcomeWord}}</div><div class="entry2-content"><div class="entry2-items">{{list}}</div>{{btns}}</form></div>'.replace("{{entryClass}}",M.join(" ")).replace("{{list}}",D).replace("{{upgradeWelcomeWord}}",e.upgradeWelcomeWord).replace("{{btns}}",1==o.default.windowType&&!o.default.dji&&k?"":'<div class="entry2-submit"><div class="entry2-btn-submit bg0">{{upgradeVisitorInfoSubmitTxt}}</div></div></div>').replace("{{upgradeVisitorInfoSubmitTxt}}",k?lanRes.submit:e.upgradeVisitorInfoSubmitTxt).replace("{{close}}",lanRes.close).replace("{{submit}}",lanRes.submit),k?(1!=o.default.windowType||o.default.dji?$("body").append(D):$("#leave").html(D).removeClass("hide"),$("html").addClass("page-leave entry2"),b=1==o.default.windowType&&!o.default.dji&&k?".leave-enter-btn":".entry2-btn-submit"):($("body").append(D),$("html").addClass("entry2"),$(".entry2-btn-close").on("click",p),b=".entry2-btn-submit"),d({list:C,entry:e,submitSelector:b}),$("textarea[autoHeight]").autoHeight(),C},p=function(e){a.default.setStatusByKey("visitorClose",!1),o.default.publish("chatEnded"),delete o.default.queryParams.autoPop,delete o.default.queryParams.autoChat},d=function(e,t){var n=e.list,r=e.entry,l=e.submitSelector,c=2==a.default.getStatusByKey("status")&&"0"==r.offlineStartType,u=o.default.checkIpt.bind(o.default),d=!1;function f(e){if(d)return!1;var r,l,f,p,h,m,g,v=_$("entryForm"),y={windowType:o.default.windowType},b="",S=!0;for(f=0,r=n.length;f<r;f++)if(null,"",h=n[f].configName,p=v[h],!n[f].disabled){if(l=(m=(0,s.getFormItemValue)(null,p,h)).val,!(S=u(p,l,h,(function(e){p.nodeType?e?$(p).removeClass("error"):$(p).addClass("error"):p[0]&&p[0].nodeType&&$(p[0].parentNode.parentNode).addClass("error")}))&&S))return!1;l&&S&&(b+=m.label+" "+(m.inputValue||l)+"\r\n "),y[h]=l}if(i.default.handleNetwork())return!1;if(y.leaveContent=void 0,c&&(g=$(".leave-entry-text").results[0],u(g,g.value,"content",(function(e){g.nodeType&&(e?$(g).removeClass("error"):$(g).addClass("error"))})),!g.value))return!1;if(a.default.getStatusByKey("captChaToken")){if($("#verify_change").hasClass("loadin"))return!1;var T=$("#verify_input").val();if(!T)return $("#verify_input").addClass("error"),!1;$("#verify_change").addClass("loadin"),y.captcha=T}return y.et=106,"1"==o.default.queryParams.autoPop&&(y.isAutoPop=1),d=!0,a.default.setStatusByKey("visitorEntryInput",{entryParam:y,entryVisitorMsg:b,entryLeaveContent:c?g&&g.value:void 0}),o.default.publish("sendMessage",y,(function(e){e&&e.successful&&t&&t(),a.default.getStatusByKey("captChaToken")&&$("#verify_change").removeClass("loadin"),d=!1})),!1}a.default.getStatusByKey("captChaToken")&&h(),$("input",_$("entryForm")).bind("blur",(function(){var e=this.name,t=(0,s.getFormItemValue)(null,this,e).val;u(this,t,e,(function(e){}))})),$("textarea",_$("entryForm")).bind("blur",(function(){var e=this.value.replace(/^[\s]+|[\s]+$/gi,"");u(this,e,"textarea",(function(e){}))})),$("select",_$("entryForm")).bind("change",(function(){var e=this.value;u(this,e,"select",(function(e){}))})),$(".date-input",_$("entryForm")).bind("change",(function(e){var t=$(".date-show",this.parentNode);t&&t.val(this.value)})),d=!1,_$("entryForm").onsubmit=f,$(l).off("click").on("click",f)},m=function(){return a.default.getVisitorInfo().dataHost+"/chatCaptCha.jpg?captChatToken="+a.default.getStatusByKey("captChaToken")},h=function(e){$(".verify-change").attr("id",""),$(".verify-img").attr("id",""),$(".verify-ok").attr("id",""),$(".verify-input").attr("id",""),y()},c=function(e){$("#entry").html("").addClass("hide"),$(".verify-change").attr("id","verify_change"),$(".verify-img").attr("id","verify_img"),$(".verify-ok").attr("id","verify_ok"),$(".verify-input").attr("id","verify_input"),y(),$("#verify_img").attr("src",m(e)),$("#verify").show(),$("#mask").show()},o.default.subscribe("refreshCode",(function(e,t){$("#verify_change").removeClass("loadin"),0==t.status||1==t.status&&$("#verify_input").addClass("error"),$("#verify_img").attr("src",m(t))})),o.default.subscribe("entryCallback",(function(e,t){if(t.success&&(o.default.publish("changeDom",{name:"#footer",bottom:0,scrollTime:500}),t.mid&&(delete o.default.queryParams.autoPop,delete o.default.queryParams.autoChat),a.default.setStatusByKey("captChaToken",void 0),a.default.setStatusByKey("isInEntryOrCode",!1),t.mt)){var n=a.default.getConfig("config649").eventId;o.default.triggerEventOnPoint("registChat",{et:103,eventId:n});var i,r=a.default.getStatusByKey("visitorEntryInput").entryParam,s=a.default.getVisitorInfo(),l="ECHAT_"+s.companyId+"_"+s.visitorId+"_ENTRY_HIS";r&&(delete r.et,delete r.captcha,i=(i=$.store(l))?JSON.parse(i):{},r=$.extend(i,r),$.store(l,JSON.stringify(r)))}})),window.imgLoadResizeSelf=function(e){o.default.px2rem&&(e.style.width=o.default.px2rem(e.naturalWidth||e.width))},window.imgLoadResize=function(e,t){Math.random();var n=-1==t?"entry":"inviteBook"+t,a=-1==t?"entryWrapImg":"inviteBookImg"+t;function i(){var e=1==o.default.windowType?600:260,i=this.naturalWidth||this.width,s=_$(n);s&&(i>e&&(i=e),s.style.width=o.default.px2rem?o.default.px2rem(i):i+"px",console.log('Util.px2rem ? (Util.px2rem(w)) : (w + "px");',o.default.px2rem?o.default.px2rem(i):i+"px"),-1==t&&(s.style.marginLeft=o.default.px2rem?o.default.px2rem(-i/2):-i/2+"px"),$("#"+a).removeClass("hide").css("width",o.default.px2rem?o.default.px2rem(i):i+"px"),r.default.scrollToBottom())}if(e.naturalWidth)i.call(e);else{var s=new Image;s.onload=i,s.src=e.src}}},267:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(3),n(11),n(10);var o=l(n(4)),a=n(16),i=l(n(8)),r=l(n(137)),s=l(n(106));function l(e){return e&&e.__esModule?e:{default:e}}var c,u,d,f,p,h=!1,m={satisfyFocus:!1};function g(e){$("#satisfy").removeClass("satisfy-show").hide(),$("#mask").hide(),_$("sa_advise").blur(),$("#footer").removeClass("hide-satisfy"),o.default.publish("changeDom",{name:"#footer",bottom:0}),!0!==e&&(2!=i.default.getStatusByKey("chatStatus")?(o.default.publish("__evaluate","0-2"),o.default.publish("_closeWin")):o.default.publish("__evaluate","0-1"))}function v(e){var t=$(".menu-satisfy"),n="hide",o="limit-hide";1==e?t.addClass(n).removeClass("show"):2==e?t.removeClass(n):3==e?t.addClass(o):4==e?t.removeClass(o):5==e?t.addClass("show").removeClass(n):6==e&&t.hide(),r.default.checkMenuNums()}function y(){var e=i.default.getStatusByKey("sendMsgNum"),t=i.default.getEvaluateAndLimit();if(!t.config)return u=!1,void v(3);t.enable?(u=!0,t.limit>0&&(e<t.limit?v(3):v(4))):(u=!1,v(3)),c||function(e){var t,n,r,s=!1;if(c=!0,(n=(t=h=1==e.evaluateType)?1==e.bestEnable?5:1==e.betterEnable?4:1==e.commonEnable?3:1==e.worseEnable?2:1==e.worstEnable&&1:5)||(n=5,s=!0),$("#satisfy_ipt").val(n),r='<div class="sa-title tc"><div class="sa-title-left"></div><div class="sa-title-content"><span langs="evaluateTip">'+lanRes.evaluateTip+'</span><span class="sa-name sa-name5 emcolor">'+o.default.HTMLDecode(e.bestDesc)+'</span><span class="sa-name sa-name4 emcolor">'+o.default.HTMLDecode(e.betterDesc)+'</span><span class="sa-name sa-name3 emcolor">'+o.default.HTMLDecode(e.commonDesc)+'</span><span class="sa-name sa-name2 emcolor">'+o.default.HTMLDecode(e.worseDesc)+'</span><span class="sa-name sa-name1 emcolor">'+o.default.HTMLDecode(e.worstDesc)+'</span></div><div class="sa-title-right"></div></div>',t&&!s?(r+='<ul class="sa-imgs clearfix">',1==e.worstEnable&&(r+='<li class="sa-img sa-img1" v="1"><img class="sa-s-img" v="1" src="'+e.worstSelected.replace(/^http:/,o.default.needHttps||"http:")+'"/><img class="sa-un-img" v="1" src="'+e.worstUnSelected.replace(/^http:/,o.default.needHttps||"http:")+'"/></li>'),1==e.worseEnable&&(r+='<li class="sa-img sa-img2" v="2"><img class="sa-s-img" v="2" src="'+e.worseSelected.replace(/^http:/,o.default.needHttps||"http:")+'"/><img class="sa-un-img" v="2" src="'+e.worseUnSelected.replace(/^http:/,o.default.needHttps||"http:")+'"/></li>'),1==e.commonEnable&&(r+='<li class="sa-img sa-img3" v="3"><img class="sa-s-img" v="3" src="'+e.commonSelected.replace(/^http:/,o.default.needHttps||"http:")+'"/><img class="sa-un-img" v="3" src="'+e.commonUnSelected.replace(/^http:/,o.default.needHttps||"http:")+'"/></li>'),1==e.betterEnable&&(r+='<li class="sa-img sa-img4" v="4"><img class="sa-s-img" v="4" src="'+e.betterSelected.replace(/^http:/,o.default.needHttps||"http:")+'"/><img class="sa-un-img" v="4" src="'+e.betterUnSelected.replace(/^http:/,o.default.needHttps||"http:")+'"/></li>'),1==e.bestEnable&&(r+='<li class="sa-img sa-img5 sa-sli5" v="5"><img class="sa-s-img" v="5" src="'+e.bestSelected.replace(/^http:/,o.default.needHttps||"http:")+'"/><img class="sa-un-img" v="5" src="'+e.bestUnSelected.replace(/^http:/,o.default.needHttps||"http:")+'"/></li>'),r+="</ul>"):r+='<ul class="sa-stars clearfix"><li class="sa-sli sa-star emcolor" v="1">&#xe62c;</li><li class="sa-sli sa-star emcolor" v="2">&#xe62c;</li><li class="sa-sli sa-star emcolor" v="3">&#xe62c;</li><li class="sa-sli sa-star emcolor" v="4">&#xe62c;</li><li class="sa-sli sa-star emcolor sa-sli5" v="5">&#xe62c;</li></ul>',!t||!s){r+='<div class="sub-tabs clearfix " >',r+="<div>";var l,u,d,m,v,y=["worstConfiguration","worseConfiguration","commonConfiguration","betterConfiguration","bestConfiguration"];for(l=5;l>0;l--){for(r+='<ul class="sub-tab sub-tab'+l+'" '+((v=(d=e[y[l-1]]||[]).length)>0?"":'style="display:none"')+' id="subEvaluate'+l+'"> ',u=0;u<v;u++)r+='<li class="sa-cli" dataname="'+(m=d[u]).configName+'">'+o.default.HTMLDecode(m.configDesc)+"</li>";r+="</ul>"}r+="</div>",r+="</div>"}$("#satisfyConfig").html(r).addClass("sa-sel-"+n).attr("default",n);var b=i.default.getStaff();b&&$(".sa-avatar").html('<img src="'+b.img+'"/>'),f(s,t,n),$("#sa_ok").on(o.default.isMobile?"touchend":"click",(function(e){if((0,a.handleNetwork)())return!1;o.default.isMobile&&e.preventDefault();var t,n,r,l=o.default.HTMLDecode($("#sa_advise").val()),c=$("#satisfy_ipt").val(),u="";if("0"!=c&&c){if(!s&&(n=(t=$(".sa-cli",_$("subEvaluate"+c)).results||[]).length)>0)for(r=0;r<n;r++)u+="&"+[$(t[r]).attr("dataname")]+"="+($(t[r]).hasClass("sub-selected")?1:0);var d=i.default.getVisitorInfo(),f=i.default.getStatusData(),h=d.dataHost+"/ces?companyId="+d.companyId+u,m={talkId:f.talkId,visitorId:d.visitorId,encryptVID:d.encryptVID,appId:d.appId,mainItem:c,evaluateType:p,comment:l,media:d.media,windowType:o.default.windowType,lan:d.lan};d.metaData&&(m.metaData=d.metaData),h+=o.default.addMapParams(m),console.log("评价 url***",h),$.ajax({url:h,type:"jsonp",jsonpCB:"jsonpCallback",success:function(e){if(console.log(e),i.default.updateNativeH5DataByKey("satisfyLastTalkId",i.default.getStatusByKey("talkId")),1==e)c,o.default.showTip(lanRes.successSubmitEval,"ok"),0==i.default.getStatusByKey("chatStatus")?o.default.publish("__evaluate","1-2"):o.default.publish("__evaluate","1-1"),l&&o.default.publish("__evaluateComment",{comment:l,chatting:2==i.default.getStatusByKey("chatStatus")}),0==i.default.getStatusByKey("chatStatus")&&o.default.publish("_closeWin");else{var t=lanRes.unkownErrorSubmitEval;129==e?t=lanRes.evaluateTimeout:130==e?t=lanRes.evaluateRepeat:133==e&&(t=lanRes.evaluateRepeatTime),o.default.showTip(t)}},error:function(){o.default.showTip(lanRes.unkownErrorSubmitEval)}}),g(!0)}})),$("#sa_cancel").on(o.default.isMobile?"touchend":"click",(function(e){g(),o.default.isMobile&&e.preventDefault()}))}(t.config)}function b(e){var t=i.default.getEvaluateAndLimit(),n=i.default.getStatusByKey("talkId"),o=i.default.getStatusByKey("sendMsgNum");if(t.limit>o&&1==e)return!1;if(c||y(),c){if(p=e,2==e||3==e||1==e&&u&&i.default.getNativeH5DataByKey("satisfyLastTalkId")!=n){s.default.inputBlur(),d(),r.default.hideMenus();var a=setTimeout((function(){clearTimeout(a),$("#mask").show(),$("#satisfy").show()}),0);return!0}return!1}}f=function(e,t,n){function o(e,n){var o,a,i=parseInt(e)-1;if(!t)for(a=$(".sa-sli").results,o=0;o<5;o++)o<=i?$(a[o]).addClass("sa-star").html("&#xe62c;"):$(a[o]).removeClass("sa-star").html("&#xe62e;");_$("satisfyConfig").className="sa-sel-"+(i+1),n&&$("#satisfy_ipt").val(i+1)}function a(){var e,n,o=parseInt($("#satisfy_ipt").val()||5)-1;if(!t)for(e=$(".sa-sli").results,n=0;n<5;n++)n<=o?$(e[n]).addClass("sa-star"):$(e[n]).removeClass("sa-star");_$("satisfyConfig").className="sa-sel-"+(o+1),$(".sub-tab-sel").removeClass("sub-tab-sel"),$(".sub-tab"+(o+1)).addClass("sub-tab-sel")}n&&$(".sub-tab"+n).addClass("sub-tab-sel"),$(".sa-stars").on("touchstart touchmove touchend",(function(e){var t;if(e.touches&&e.touches.length&&e.clientX)try{t=document.elementFromPoint(e.touches[0].pageX,e.touches[0].pageY)}catch(n){t=document.elementFromPoint(e.clientX,e.clientY)}else;t=t||e.target||e.srcElement,$(t).hasClass("sa-sli")&&o($(t).attr("v"),!0)})),$(".sa-stars").on("touchend",a),$(".sa-imgs").on("touchend",a),$(".sa-imgs").on("touchstart touchmove touchend",(function(e){var t;if(e.touches&&e.touches.length&&e.clientX)try{t=document.elementFromPoint(e.touches[0].pageX,e.touches[0].pageY)}catch(n){t=document.elementFromPoint(e.clientX,e.clientY)}else;t=t||e.target||e.srcElement,($(t).hasClass("sa-un-img")||$(t).hasClass("sa-s-img"))&&o($(t).attr("v"),!0)})),$(".sa-cli").on("click",(function(e){$(this).hasClass("sub-selected")?$(this).removeClass("sub-selected"):$(this).addClass("sub-selected")})),$("#sa_advise").on("focus",(function(e){m.satisfyFocus=!0})).on("blur",(function(e){m.satisfyFocus=!1,_$("satisfyContent").style.marginBottom="0"}))},d=function(){var e,t,n;if($("#sa_advise").val(""),!h)for(e=$(".sa-sli").results,t=0;t<e.length;t++)$(e[t]).addClass("sa-star").html("&#xe62c;");n=$("#satisfyConfig").attr("default"),$("#satisfyConfig").attr("class","sa-sel-"+n),$(".sub-tab-sel").removeClass("sub-tab-sel"),$(".sub-tab"+n).addClass("sub-tab-sel"),$("#satisfy_ipt").val(n)},o.default.subscribe("inviteSatisfy",(function(e,t){b(2),o.default.publish("__newMsg",{f:"s",m:0,c:"[evaluate]:"+lanRes.vis_39})})),o.default.subscribe("showSatisfy",(function(e,t){"number"!=typeof t&&(t=1);var n=b(t);i.default.setStatusByKey("hasSatisfy",n)})),o.default.subscribe("initEvaluate",y);t.default=m},268:function(e,t,n){"use strict";n(25),n(33),n(35),n(26),n(32),n(19),n(3),n(11),n(10);var o=s(n(4));n(182),n(183);var a=s(n(8));n(185);var i=n(16),r=n(184);function s(e){return e&&e.__esModule?e:{default:e}}var l,c,u,d=window.fileUtil,f=(!o.default.isMobile&&o.default.windowType,d.orderUploadData),p=[],h=(new Date).getTime(),m=-1;o.default.subscribe("uploadLogsStatus",(function(e,t){d.uploadLogsStatus&&d.uploadLogsStatus(t)})),d.uploadLogsStatus=function(e){var t="ticket_"+a.default.getVisitorInfo("companyId")+"_"+h;if(e.id===t)if(m=e.status,-1==e.status)$("#logUpload").text(lanRes.vis_67),$("#logUpload").attr("class","entry2-log-upload");else if(1==e.status)$("#logUpload").text(e.filename),$("#logUpload").attr("class","entry2-log-upload loading");else if(2==e.status)$("#logUpload").text(e.filename),$("#logUpload").attr("class","entry2-log-upload loading");else if(3==e.status)$("#logUpload").text(lanRes.vis_68),$("#logUpload").attr("class","entry2-log-upload error");else if(4==e.status&&e.result){var n=e.result;$("#logUpload").text(e.filename),$("#logUpload").attr("class","entry2-log-upload success"),window.uploadLogInfo={type:1,fileValue:{bucket:n.bucket,fileType:n.fileType,key:n.key,name:n.fileName,url:n.fileUrl}}}},o.default.subscribe("enterWorkorder",(function(e,t){var n,i,s,u,f,p,h="",m="",g=[],v=a.default.getConfig("config600"),y=a.default.getVisitorInfo(),b=t.jobWindowInfo,S=b.configuration;for(d.setParamData({token:b.token,nonce:b.nonce,visitorId:y.visitorId,companyId:y.companyId,apiServerDomain:a.default.getApiDomain(),interfaceVersion:y.interfaceVersion,isLogExist:y.isLogExist}),g.push(1!=o.default.windowType||o.default.dji?"entry2-mb":"entry2-pc"),!o.default.isMobile&&o.default.mini&&g.push("entry2-pc-mini"),g.push("entry2-form"),$("#orderSubmit")&&$("#orderSubmit").remove(),n='<div id="orderSubmit" class="{{entryClass}} order-form"><header class="ordertitle"><div class="margin-b5">{{title}}</div><div class="order-tip">{{description}}</div></header><div class="entry2-wrap entry2-items order-content"><form id="orderForm">{{element}}</form><div class="order-upload-title">'+lanRes.selectFile+'</div><span class="order-button magr0 bg-c order-upload-button"><form class="order-upload" name="orderUploadForm" id="orderUploadForm" enctype="multipart/form-data" method="post"><input type="file" name="file" id="orderUpload"></form></span><div id="orderFileslist" class="order-fileslist"></div></div><footer class="order-footer"><span class="order-submit order-button bg0">{{submit}}</span></footer></div>',i='<div class="entry2-item"><div class="entry2-label {{req}}"><span class="req-span">*</span><span class="entry2-name">{{configDesc}}:</span></div><div class="entry2-typeline {{req}}" lb="{{configDesc}}">{{typeline}}</div></div>',s=0;s<S.length;s++)u=S[s],f=c(u.configName,b.fieldSettings,u.lan,(function(e,t,n){if(f=t||u,2!=u.filedType||"8"==u.configType&&y.interfaceVersion>=6&&1==y.isLogExist){var o=f.type||u.configType;h=(0,r.getElementByFieldType)(e,o,u,"","workorder"),m+=i.replace("{{typeline}}",h).replace(/\{\{configName\}\}/g,u.configName).replace(/\{\{configDesc\}\}/g,u.configDesc).replace(/\{\{wordDesc\}\}/g,u.wordDesc).replace(/\{\{value\}\}/g,"").replace(/\{\{req\}\}/g,1==u.configRequired?"req":"")}}));if(p=o.default.SDKNative?"jpg，png，gif，bmp，avi，mov，rmvb，rm，flv，mp4，3gp":"jpg，png，gif，txt，rar，zip，doc，docx，xls，xlsx，bmp，avi，mov，rmvb，rm，flv，mp4，3gp",m=n.replace("{{entryClass}}",g.join(" ")).replace("{{element}}",m).replace(/\{\{title\}\}/g,b.title).replace(/\{\{description\}\}/g,b.description).replace(/\{\{cancel\}\}/g,lanRes.cancel).replace(/\$\{uploadFileSize\}/g,v.uploadFileSize/1024/1024).replace(/\$\{filesTip\}/g,p).replace(/\{\{submit\}\}/g,lanRes.submit),1!=o.default.windowType||o.default.dji?$("body").append(m):$("#leave").html(m).removeClass("hide"),(0,r.resetOptionField)(b.fieldSettings,"workorder",b),o.default.isMobile&&$("#orderSubmit").off("click").bind("click","img",(function(e){setTimeout((function(){}),500)})),o.default.isMobile||1!=o.default.windowType||o.default.dji)self===window.top&&($(".btn-close").addClass("hide"),setTimeout((function(){$(".btn-close").addClass("hide")}),100)),$("#chat").addClass("hide");else{$("#chat").addClass("hide"),$("#orderSubmit footer").remove(),window.opener||($(".btn-close").addClass("hide"),setTimeout((function(){$(".btn-close").addClass("hide")}),100));var T='<div class="order-submit order-button bg0">'+lanRes.submit+"</div>";$(".leave-entry-foot").html(T)}$("html").addClass("page-leave entry2"),$("#footer").addClass("hide"),setTimeout((function(){$("#mask").hide()}),100),$("#orderUpload").off("click").bind("click",(function(e){e.stopPropagation()})),d.bindOrderUpload(".order-upload-button","#orderUpload"),l(S,".order-submit")})),c=function(e,t,n,o){var a,i,r,s,l,c={};for(n=n||"default",s=0;s<t.length;s++){if(i=null,(a=c[t[s].field]=t[s]).settings&&a.settings.length>0)if(1==a.settings.length)a.configs=a.settings[0].configs;else{for(l=0;l<a.settings.length;l++){if(a.settings[l].lan==n){a.configs=a.settings[l].configs;break}"default"==a.settings[l].lan&&(i=a.settings[l].configs)}!a.configs&&(a.configs=i||a.settings[0].configs)}t[s].field===e&&(r=t[s])}o&&o(c,r,i)},l=function(e,t){var n=o.default.checkIpt.bind(o.default),s=!1,l=_$("orderForm");function c(e,t){var n=a.default.getConfig("config649"),i=a.default.getVisitorInfo(),r="1"===n.jobWindowInfo.jobQRCodeEnable,s=n.jobWindowInfo.commitSuccessHint;e.companyId=i.companyId,e.requesterVisitorId=i.visitorId,e.title||(e.title=(e.content||"").substring(0,50)),$.ajax({url:a.default.getApiDomain()+"/chatapi/jobh/cmj",type:"post",data:e,contentType:"application/x-www-form-urlencoded; charset=UTF-8",success:function(e){if("string"==typeof e&&e.length>4)try{e=JSON.parse(e)}catch(e){}e.successful?(t&&t(!0),u(e.result.data,r,s)):(t&&t(!1),o.default.showDialog({tip:e.errorMsg,cancel:!1}))}})}function g(t){if(t.stopPropagation(),s)return!1;var u,h,m,g,v,y,b,S=l,T={},w=!0,k=!0,I=a.default.getConfig("config649"),C=a.default.getConfig("config600"),x=I.jobWindowInfo,E=(0,i.getParamChat)();for(h=0,m=e.length;h<m;h++)if(null,"",y=(g=e[h]).configName,v=S[y],!e[h].disabled&&v){if(u=(0,r.getFormItemValue)(S,v,y).val,!(w=n(v,u,y,(function(e){v.nodeType?e?$(v).removeClass("error"):$(v).addClass("error"):v[0]&&v[0].nodeType&&$(v[0].parentNode.parentNode).addClass("error")}))&&w))return!1;T[y]=u}if((0,i.handleNetwork)())return!1;if(T.eventId=I.eventId,T.routeId=I.routeId,T.token=x.token,T.nonce=x.nonce,T.styleId=I.styleId,T.jobTemplateId=x.jobTemplateId,T.requesterLan=C.lan,T.echatTag=E.echatTag||"",T.metaData=E.metaData||"",T.myData=E.myData||"",T.robotInfoId=E.talkType==o.default.Constants.talkTypeRobot?E.talkId:"",T.media=4,o.default.SDKNative&&(f.length>0||window.uploadLogInfo))T.attachments=[],p=[],k=d.getSubmitItems(T.attachments),window.uploadLogInfo&&T.attachments.push(window.uploadLogInfo),T.attachments=JSON.stringify(T.attachments);else if(p.length>0){for(T.attachments=[],b=0;b<p.length;b++)(g=p[b]).name=encodeURIComponent(g.name),g.fileValue?T.attachments.push({type:g.type,fileValue:g.fileValue}):k=!1;T.attachments=JSON.stringify(T.attachments)}if(E.acdStaffId&&(T.acdStaffId=E.acdStaffId),E.acdType&&(T.acdType=E.acdType),s=!0,k)return c(T,(function(e){s=!!e})),!1;o.default.showDialog({tip:lanRes.visitor190,ok:function(){for(b=0;b<p.length;b++)p[b].xhr&&p[b].xhr.abort();c(T,(function(e){s=!!e}))},cancel:function(){s=!1}})}$(".entry2-input",l).bind("blur",(function(){var e=this.name,t=(0,r.getFormItemValue)(l,this,e).val;n(this,t,e,(function(e){}))})),$("textarea",l).bind("blur",(function(){var e=this.value.replace(/^[\s]+|[\s]+$/gi,"");n(this,e,"textarea",(function(e){}))})),$("input",l).bind("change",(function(){var e=this.name,t=(0,r.getFormItemValue)(l,this,e).val;n(this,t,e,(function(e){}))})),$("#logUpload").bind("click",(function(){m<3&&m>-1||d.__uploadLogs(h,"ticket")})),$("select",l).bind("change",(function(){var e=this.value;n(this,e,"select",(function(e){}))})),$(".entry2-select",l).bind("click",(function(e){var t=window.innerHeight||Math.max(document.documentElement.clientHeight,document.body.clientHeight),n=e.currentTarget.getBoundingClientRect(),o=(n.y,t-(n.y+n.height)-$(".order-entry-foot").height()),a=e.currentTarget.querySelector(".entry2-select-dropdown");$(a).height()>0?a.className="entry2-select-dropdown":(o>=146&&(a.style.top="57px",a.style.bottom="none"),a.className="entry2-select-dropdown show")})),$(".entry2-select",l).bind("blur",(function(e){e.currentTarget.querySelector(".entry2-select-dropdown").className="entry2-select-dropdown"})),$(".entry2-select-option",l).bind("click",(function(e){e.stopPropagation&&e.stopPropagation();this.value;try{var t=this.getAttribute("inputvalue"),n=this.getAttribute("value"),o=this.getAttribute("name"),a=this.parentElement.getAttribute("lb");this.parentElement.previousElementSibling.innerHTML=t+'<input lb="'+a+'" value="'+n+'" name="'+o+'" />'}catch(e){}$(".entry2-select").blur()})),$(".date-input",l).bind("change",(function(e){var t=$(".date-show",this.parentNode);t&&t.val(this.value)})),_$("orderForm").onsubmit=g,$(t).off("click").bind("click",g)},u=function(e,t,n){if(e.codeUrl){$("html").removeClass("entry2"),$("html").removeClass("page-leave"),$("#orderSubmit")&&$("#orderSubmit").remove();var i=a.default.getConfig("locationBase")||location.origin,r='<div class="tip2">'+lanRes.visitor184+"</div>",s='<div id="orderSubmit" class="order-success"><div class="order-complete"><img src="'+i+'/res/imgs/orderSuccess.svg" /><div class=""></div><div class="tip1">'+(n||lanRes.visitor183)+"</div>"+r+"</div></div>";1==o.default.windowType?$("#leave").html(s).removeClass("hide"):$("body").append(s),$(".leave-entry-foot")&&$(".leave-entry-foot").remove(),$("#container_leave").css({"padding-bottom":0})}}},269:function(e,t,n){"use strict";n(25),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(32),n(15),n(3),n(22),n(21),n(180),n(10);var o=c(n(4)),a=c(n(42)),i=n(16),r=c(n(8)),s=c(n(108)),l=["allExtra","h5Extra","isForward","sendStatus","tm"];function c(e){return e&&e.__esModule?e:{default:e}}var u,d,f=a.default.callEchatNative,p=!1;function h(e){var t=$(e).parents(".msgli").attr("id"),n=r.default.getMsgFromHistory(t);return n&&n.msg}function m(){$(".msg-voice").each((function(e,t){$(t).removeClass("playing")}))}t.default={init:function(e){function t(e){var t=[],n=0;$(".msg-img",_$("content")).each((function(o,a){var i,r,s,l,c=h(a);c&&(i=c.clientFileId||c.identityKey||c.fileIdentity)?(s=c.fileName,t.push({bigImg:c.bigImg||c.localFile,smallImg:c.smallImg,sourceImg:c.sourceImg,identityKey:c.identityKey||c.fileIdentity,clientFileId:c.clientFileId,localFile:c.localFile})):(i=(new Date).getTime()+"",s=r=$(a).attr("src"),t.push({bigImg:r,smallImg:r,sourceImg:r,identityKey:i,clientFileId:i,isOrignal:1})),e==a&&(n=t.length),l=(l=(s||"temp.png").match(/[^.]+$/))&&l[0]||"png",t[t.length-1].fileName=i+"."+l})),f("previewImage",{urls:t,current:n})}u=e,o.default.subscribe("recordEvent",(function(e,t){t&&6==t.type&&(d=null,m())})),o.default.subscribe("downloadEvent",(function(e,t){var n=t.identityKey,o=t.fileIdentity,a=t.nativeExtra,i=a.loadStatus,s=a.progress,l=a.localFile,c=n||o,d=r.default.getMsgFromHistory(n||o).msg;l=d.localFile||l,r.default.updateMsgByIndetity(d.clientFileId||c,{localFile:l}),r.default.updateHistoryMsgNativeExt(d.clientFileId||c,"loadStatus",i),r.default.updateHistoryMsgNativeExt(d.clientFileId||c,"progress",s),d.allExtra.nativeExtra||(d.allExtra.nativeExtra={}),d.allExtra.nativeExtra.loadStatus=i,d.allExtra.nativeExtra.progress=s,u.updateMsg(d)})),$("#content").on("click",".msg-voice",(function(e){var t=h(this),n=d&&d.clientFileId,o=t.clientFileId||t.fileIdentity;n&&(f("voice",{type:7,clientFileId:t.clientFileId,localFile:t.localFile}),m()),n!=o?(f("voice",{type:6,url:t.remoteFileUrl,identityKey:t.identityKey||t.fileIdentity,clientFileId:t.clientFileId,localFile:t.localFile}),d=t,$(this).addClass("playing")):d=null})).on("click",".msg-video",(function(e){var t=h(this),n=t.remoteVideoPath||t.remoteFileUrl||t.fileUrl||t.localVideoPath;if(!n){if(!(n=$(this).attr("videourl")))return void console.log(lanRes.vis_49);t={identityKey:(new Date).getTime(),remoteVideoPath:n}}var o,a,i=t.fileName||(new Date).getTime()+".mp4";o="video",a={type:"play",identityKey:t.identityKey||t.fileIdentity,clientFileId:t.clientFileId,url:n,localVideoPath:t.localVideoPath,fileName:i,downloadUrl:n+(-1==n.indexOf("?")?"?":"&")+"attname="+encodeURIComponent(i)},p||(p=!0,f(o,a),setTimeout((function(){p=!1}),700))})).on("click",".msg-imgs",(function(){t($(".msg-img",this).results[0])})).on("click",".msg-img",(function(e){$(this).parents(".msg-imgs").length||t(this)})).on("click",".file-resend",(function(e){if(!(0,i.handleNetwork)()){if(!(2==r.default.getStatusData().chatStatus))return o.default.showTip(lanRes.vis_52);var t=h(this);t&&o.default.showDialog({tip:lanRes.vis_50,ok:function(){f("resendFile",t.clientFileId)}}),$(this).attr("resend","1")}})).on("click",".msg-file",(function(e){var t,n,o,a,s=h(this),l=s.allExtra.nativeExtra||{},c=l.loadStatus,u=void 0===c?0:c,d=l.localFile;if(s){if(o=s.identityKey||s.fileIdentity,t=s.fileUrl||s.remoteFileUrl,t+=(-1==t.indexOf("?")?"?":"&")+"attname="+encodeURIComponent(s.fileName),0==u||3==u||4==u){if((0,i.handleNetwork)())return;n=2,f("downloadFile",{identityKey:o,url:t,isNeedOpen:0,downloadType:0,fileName:s.fileName,windowType:0}),a="0%",$(".file-load-progress0",this).css("width","0px")}else 2==u?(f("cancelDownloadFile",{identityKey:o,url:t}),n=3,a=lanRes.vis_51):1==u&&f("openFile",{identityKey:o,clientFileId:s.clientFileId,localFile:d||s.localFile});n&&(r.default.updateHistoryMsgNativeExt(s.clientFileId||o,"loadStatus",n),r.default.updateHistoryMsgNativeExt(s.clientFileId||o,"progress",0)),this.className="msg-file file-load-status"+u,a&&$(".file-load-bar-info",this).html(a)}})).on("click",".msg-leave",(function(e){var t=$(this).parents(".msgli").attr("id"),n=t&&r.default.getMsgFromHistory(t);if(n){var a,i=n.msg,s=658==i.mt,l=r.default.getConfig("locationBase"),c=r.default.getVisitorInfo(),u=r.default.getConfig("config600"),d=r.default.getApiDomain()+"/chatapi/paodm/qd?companyId="+c.companyId+o.default.addMapParams({visitorId:i.oldVisitorId||c.visitorId,chatInfoType:i.chatInfoType||9,talkId:i.newsMsgId||i.jobId,tm:i.tm,token:i.signature}),f="in"==window.lanResName?"id":window.lanResName,p=l+"/visitor/common/"+(s?"order.html":"record.html")+"?lan="+(s?u.lan:f)+"&sdkVersion=21&url="+encodeURIComponent(d);s&&(p+=o.default.addMapParams({token:i.token,nonce:i.nonce,uploadFileSize:u.uploadFileSize,fileUploadInfos:(a=u.fileUploadInfos.reduce((function(e,t){return e.push(t.uploadServiceType),e}),[]),JSON.stringify(a)),photo:r.default.getVisitorImg(),isLogExist:c.isLogExist,interfaceVersion:c.interfaceVersion})),o.default.publish("showURLLink",s?lanRes.visitor173:lanRes.leaveMsgTitle,p,{needOpen:!0,from:5,workorder:s?1:void 0}),1!=i.allExtra.h5Extra.read&&($(this).parents(".msgli").addClass("unfold"),r.default.updateHistoryMsgExt(t,{read:1}),o.default.publish("setExtraMessage",i,{read:1}))}})),$(".action-close").on("touchend",(function(){o.default.publish("visitorClose")})),$("#pre_his").on("touchend",(function(){o.default.publish("loadHistory")})),$(document).on("click",".resend",(function(e){if(!(0,i.handleNetwork)()){var t,n,a=(t=$(this).parents(".msgli").attr("id"),(n=r.default.getMsgFromHistory(t))&&n.originData),c=r.default.getStatusData(),u=2==c.chatStatus,d=2==c.chatStatus&&c.talkType==o.default.Constants.talkTypeRobot;if(!u)return o.default.showTip(lanRes.vis_52);if(d&&127==a.data.et)return o.default.showTip(lanRes.vis_53);var f=a.data,p=(f.allExtra,f.h5Extra,f.isForward,f.sendStatus,f.tm,function(e,t){if(null==e)return{};var n,o,a=function(e,t){if(null==e)return{};var n={};for(var o in e)if({}.hasOwnProperty.call(e,o)){if(-1!==t.indexOf(o))continue;n[o]=e[o]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}(f,l));a.data=p,(0,s.default)(a)}})).on("click",".btn-restart",(function(){setTimeout((function(){o.default.publish("restartChat")}),10),u.removeMsg({id:"restartChat"}),$(this).text(lanRes.chatContinued)}))}}},270:function(e,t,n){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}n(25),n(33),n(39),n(60),n(51),n(34),n(61),n(44),n(52),n(62),n(19),n(15),n(40),n(21),n(53),n(30),n(31),n(41),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(26),n(3),n(11),n(10);var a,i,r=d(n(4)),s=d(n(8)),l=n(16),c=d(n(55)),u=(n(186),d(n(105)));function d(e){return e&&e.__esModule?e:{default:e}}function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function p(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=o(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!=o(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==o(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function h(e){e&&i&&e.mid<i.mid||(a&&clearTimeout(a),a=null,r.default.publish("__clearTitleTyping"))}function m(e,t){var n=lanRes.staffInput;r.default.publish("__setTitleTyping",n),a&&clearTimeout(a),a=setTimeout(h,3e3),i=t}t.default={init:function(e){e.subscribe("startChat",(function(){var t;r.default.publish("__chatStatus","chatting"),s.default.setStatusByKey("statusName","chatting"),delete r.default.queryParams.autoPop,delete r.default.queryParams.autoChat,r.default.publish("__chatStart",s.default.getStaff().name),e.unSubscribe("getMsgTyping"),e.unSubscribe("clearMsgTyping"),e.subscribe("getMsgTyping",m),e.subscribe("clearMsgTyping",h),e.unSubscribe("textInputChangeEvt"),e.subscribe("textInputChangeEvt",(0,l.debounce)((t=null,function(){var e=u.default.input.getInput(!1),n=e;function o(e){r.default.publish("sendMessage",{et:104,content:e})}e&&(e=e.replace(/^[\n\r\s]+$/,""))&&t!=e&&(t=e,u.default.input.plainText&&(n=(0,l.plainTextToSendMsg)(e)),1!=r.default.filterMsg&&3!=r.default.filterMsg||!n?o(n):r.default.filterAndSendToServer({},(function(e,t,n){n||o(t)}),n))}),1e3)),r.default.publish("initEvaluate")})),e.subscribe("startQueue",(function(){r.default.publish("__chatStatus","waiting"),s.default.setStatusByKey("statusName","waiting"),r.default.publish("__setTitle",lanRes.waitting)})),e.subscribe("getPosMsg",(function(e,t){var n=s.default.getConfig("config649"),o=n.queueTxt||n.mobileQueueTxt;(t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){p(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},t)).id="positionInfo",t.content=o.replace("${waitcount}",t.position),c.default.removeMsg(t),c.default.showMsg(t),r.default.publish("__chatQueue",t.position)}))}}},271:function(e,t,n){"use strict";n(25),n(33),n(39),n(60),n(51),n(34),n(61),n(44),n(52),n(62),n(40),n(53),n(41),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(176),n(135),n(86),n(19),n(15),n(3),n(22),n(11),n(21),n(30),n(177),n(31),n(10);var o=h(n(42)),a=h(n(4)),i=n(16),r=n(108),s=h(n(8)),l=h(n(272)),c=h(n(273)),u=h(n(55)),d=h(n(181)),f=h(n(274));n(185),n(186);var p=["data","sendStatus"];function h(e){return e&&e.__esModule?e:{default:e}}function m(e){return(m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){y(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function y(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=m(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=m(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==m(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var b,S,T,w,k,I,C,x,E,$={12545:1,800:1},D=a.default.Browser.isAndorid,M=a.default.Constants,_=window.fileUtil,P=o.default.callEchatNativeConnect,N=!1,B=!0,O=!1,L={},R=!1;function A(e){e?(s.default.setDataByName("hasPreHistory",!0),a.default.publish("changeDom",{name:"#pre_his",removeCls:"hide"})):(s.default.setDataByName("hasPreHistory",!1),a.default.publish("changeDom",{name:"#pre_his",cls:"hide"}))}_.setUtil(a.default),_.setNative(o.default.callEchatNative);var j=2e7,F=2e7;function U(e,t){return a.default.isArray(e)||(e=[e]),D&&$[x]&&e.sort((function(e,t){return e.createTime-t.createTime})),e.forEach((function(e){if(e.data&&(e.data.mt||e.data.et)||(e.data=v({},e)),!e.data.tm&&e.createTime&&(e.data.tm=e.createTime),e.data.et&&(e.data.et=parseInt(e.data.et)),e.data.mt&&(e.data.mt=parseInt(e.data.mt)),D&&$[x]&&2147483646==e.mid){var n=2147483646;n+=t?--j:++F,e.mid=n,e.data.mid=n}e.data.id||(e.mid&&e.mt&&e.data.bin?e.data.id=e.mid:e.data.id=e.echatId),e.data.visitorId&&e.data.visitorId!=e.visitorId&&(e.data.oldVisitorId=e.data.visitorId,e.data.visitorId=e.visitorId),e.data.isForward=e.isForward,!e.data.bridgeMsgId&&e.bridgeMsgId&&(e.data.bridgeMsgId=e.bridgeMsgId);e.data;var o=e.sendStatus,a=function(e,t){if(null==e)return{};var n,o,a=function(e,t){if(null==e)return{};var n={};for(var o in e)if({}.hasOwnProperty.call(e,o)){if(-1!==t.indexOf(o))continue;n[o]=e[o]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}(e,p);return e.data.allExtra=a||{},void 0===e.data.sendStatus&&(e.data.sendStatus=o),e.data.allExtra.h5Extra=e.data.allExtra.h5Extra||{},e.fromHis=t,e})),e}function H(e,t){var n=(e=U(e)[0]).data,o=s.default.getStatusByKey("isInWorkOrder"),a=s.default.getMsgFromHistory(n.clientFileId);if(a&&a.msg.sendStatus==M.sendStatus.error&&((0,r.removeToResend)(e),a=void 0),a){if(a.msg.sendStatus==M.sendStatus.success)return;s.default.updateMsgByIndetity(n.clientFileId,n)}else e.data.isInWorkOrder=o,s.default.updateMsgList(e,"push");if(o)return"prepareUpload"==t?_.prepareAddOrderFile(n):"uploadSuccess"==t?_.successOrderFile(n):_.updateOrderFile(n);a?u.default.updateMsgProgress(n):u.default.showMsg(n)}function V(){var e=s.default.getVisitorInfo(),t=e.visitorId,n=e.companyId;P("getSyncMessage",{visitorId:t,companyId:n}),s.default.setStatusByKey("needSync",1)}function K(e,t){return function(n){!(e=e.replace(n+",",""))&&t&&(t()||(t=null))}}function W(){var e=s.default.getMsgListFirst()||{};e.echatId&&s.default.setDataByName("historyLastEchatId",e.echatId),a.default.publish("changeDom",{name:"#pre_his",cls:"loading-spin"}),P("getChatMessage",{mid:e.mid,visitorId:s.default.getVisitorInfo().visitorId,companyId:x,selectCount:20})}function q(){setTimeout((function(){a.default.publish("changeDom",{name:"#pre_his",removeCls:"loading-spin"})}),800)}b={forwardConfigMessage:function(e,t){if(e&&a.default.isArray(e)&&0!=e.length){var n,o,i=s.default.getConfig("config600").mt;for(o=0;o<e.length;o++)if((n=e[o].data).visitorId!=e[o].visitorId&&(n.visitorId=e[o].visitorId),n.mt=parseInt(n.mt),s.default.setConfig("config"+n.mt,n),600==n.mt){var r=n,l=r.encryptVID,u=r.city,d=r.province,f=r.country,p=r.photo,h=r.visitorId,m=r.firstUrl,g=r.keyword,v=r.referrer,y=r.searcher,b=r.apiServerDomain;s.default.setVisitorInfo({city:u,province:d,country:f,firstUrl:m,keyword:g,referrer:v,searcher:y,photo:p,apiServerDomain:b,visitorId:h}),l&&s.default.setVisitorInfo({encryptVID:l}),s.default.setConfigs({inputMaxLength:"1"==n.limitVisitorInputContentLengthEnable?n.visitorInputContentMaxLength:2e3,companyVersionType:n.companyVersionType,isVip:1==n.visitorType})}else 649==n.mt?((i||1==s.default.getStatusByKey("chatStatus"))&&(t||(0,c.default)(n)),i&&!N&&2==s.default.getStatusByKey("chatStatus")?a.default.publish("startSession"):(!N&&s.default.getStatusByKey("chatStatus")<=1||N&&2==s.default.getStatusByKey("chatStatus")||i&&2==s.default.getStatusByKey("chatStatus"))&&a.default.publish("setTheme",n),N=!0):(0,c.default)(n);(N||2!=s.default.getStatusByKey("chatStatus"))&&(T("forwardConfigMessage"),k("forwardConfigMessage"),I("forwardConfigMessage"),N&&w("forwardConfigMessage"))}},forwardStaffInfo:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n={};for(e=0;e<t.length;e++)n[t[e].staffId]=t[e];s.default.setStaffInfo(n),T("forwardStaffInfo"),k("forwardStaffInfo"),I("forwardStaffInfo")},forwardHistoryMessage:function(e){var t,n,o;if(s.default.getVisitorInfo().interfaceVersion>=5||e&&e.action){if("roam"==e.action){if(n=s.default.getMsgListFirst())u.default.removeAllMsg(),s.default.setDataByName("historyLastEchatId","");else if(!O)return}else"error"==e.action&&(t=!0,q(),a.default.publish("showToast",{type:"error",content:lanRes.vis_61}));(o=e.messages)||(o=[])}else o=e&&a.default.isArray(e)?e:[];return O=!0,o=U(o,!0),E&&o.length&&o[o.length-1].mid<=E.mid?(E=void 0,void a.default.publish("checkHistory",o)):(s.default.updateMsgList(o,"unshift"),D&&$[x]?A(!1):!t&&A(o.length>=1),q(),B?(k("forwardHistoryMessage"),I("forwardHistoryMessage"),void w("forwardHistoryMessage")):void(n?o:o.reverse()).forEach((function(e){return(0,c.default)(e.data)})))},forwardChatMessage:function(e){if(e&&(!a.default.isArray(e)||e.length)){e=U(e);var t=[];B&&(e.forEach((function(e){1==e.show?L[e.echatId]=e:t.push(e)})),!t.length)||(s.default.updateMsgList(e,"push"),e.forEach((function(e){return(0,c.default)(e.data)})))}},forwardSyncConfigMessage:function(e){s.default.setStatusData({chatStatus:2,canChatNow:1}),this.forwardConfigMessage(e,!0);var t=s.default.getStatusData();2==t.chatStatus&&(t.talkType==M.talkTypeChat?(a.default.publish("startChat"),a.default.publish("updateChatStaffInfo")):t.talkType==M.talkTypeRobot?a.default.publish("startRobot"):t.talkType==M.talkTypeLeave?a.default.publish("startLeave"):t.talkType==M.talkTypeQueue&&a.default.publish("startQueue"))},forwardSyncChatMessage:function(e){for(var t,n,o=s.default.getStatusData(),i=o.chatStatus,r=o.talkId,l=o.talkType==M.talkTypeChat,c=0,d=a.default.Constants.visitorEventTypes,f=0;f<e.length;f++)n=e[f],l&&d[n.mt]&&n.data&&n.data.talkId==r&&c++,t||(t=s.default.getMsgFromHistory(n.mid))&&s.default.clearMsgList(t.index);2!=i&&1!=i||(s.default.setStatusByKey("sendMsgNum",c),a.default.publish("initEvaluate",n)),t&&(u.default.removeMsgAndSiblings(t.msg),0===t.index&&s.default.setDataByName("historyLastEchatId",e[0].echatId)),this.forwardChatMessage(e)},syncMessage:function(e){d.default.setSyncMessageEvent();var t=s.default.getStatusByKey("talkId");t&&e.talkId&&e.talkId!=t||("errorAndStop"==e.action?0!=s.default.getMsgList().length&&0!=document.getElementById("list_msg").childNodes.length||d.default.setSyncMessageEvent(!0):"finish"==e.action&&V())},forwardMessageCallback:function(e){if(e){var t=e.successful,n=e.bridgeMsgId;null!=m(t)&&n&&(s.default.updateMsgByIndetity(e.bridgeMsgId,{mid:e.mid,sendStatus:M.sendStatus.success}),f.default.callback(e))}},nativeReady:function(e){s.default.setVisitorInfo(e),R&&C.noVisitorInfoReinit(),1==e.needSync&&V(),T("nativeReady"),I("nativeReady")},forwardChatStatus:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=s.default.getStatusData(),n=-1==t.fisrtChatstatus;if(n&&(e.fisrtChatstatus=e.chatStatus,0==e.chatStatus&&(e.talkId="",e.talkType="")),s.default.setStatusData(e),n||t.chatStatus==e.chatStatus||(console.log("可能是异常状态后，收到了最新的状态",e),S(t,!0)),!n&&0===e.chatStatus&&(1===t.chatStatus&&t.statusName&&t.statusName.match(/entry/)||0===t.chatStatus&&t.statusName&&t.statusName.match(/router/)))return s.default.setConfig("config672",{}),void a.default.publish("chatEnded",s.default.getStatusData(),t.chatStatus);if(n||0!==e.chatStatus?a.default.unSubscribe("websocketReadyAndRegist"):a.default.publish("websocketReadyAndRegist"),n||t.chatStatus!=e.chatStatus||t.talkType!=M.talkTypeRobot||2!=e.chatStatus||e.talkType!=M.talkTypeRobot||t.talkId!=e.talkId||a.default.publish("backViewInRobot",e),n){if(e.unreadCount){var o=s.default.getStatusByKey("unreadCount")||0,i=lanRes.hasUnreadMsgNum.replace("${num}",o);u.default.updateMsg({id:"unreadMarkLine",mt:40,tm:(new Date).getTime(),content:'<div class="tc color1"><i class="hr-left"></i> <span>'+i+'</span> <i class="hr-right"></i></div>'})}T("forwardChatStatus"),2==e.chatStatus&&e.talkType==M.talkTypeChat||T("forwardStaffInfo"),w("forwardChatStatus"),I("forwardChatStatus")}},h5DataCallback:function(e){if(e&&e.data){var t=e.data;if("string"==typeof t)try{t=JSON.parse(t)}catch(e){return void console.log("setNativeH5Data","数据json转化错误",t)}"object"==m(t)&&s.default.setNativeH5Data(t,!1)}},ackChangeStatus:function(e){if(e){var t=(0,i.isWSReady)();if(e.successful){if(t)return;(0,i.networkStatusChange)(!0),(0,i.isWSReady)()||setTimeout((function(e){(0,i.isWSReady)()&&(2==s.default.getStatusByKey("chatStatus")?(f.default.flashMsg(!1),f.default.flashMsg(!0)):f.default.flashMsg(!1))}),1e3)}}},prepareUpload:function(e){H(e,"prepareUpload")},uploadStart:function(e){H(e)},uploadProgress:function(e){H(e)},uploadSuccess:function(e){H(e,"uploadSuccess")},uploadFailure:function(e){var t=s.default.getMsgFromHistory(e).originData;t.data.sendStatus=M.sendStatus.error,H(t)}},o.default.initNativeAPI(b,"callEchatJsConnect"),w=K("forwardChatStatus,forwardConfigMessage,forwardHistoryMessage,",(function(){var e,t,n=s.default.getStatusData();2!=n.chatStatus||n.talkType!=M.talkTypeChat||n.needSync||((e=(0,i.checkHistory)()).noLimit?e.last673&&(0,c.default)(e.last673):(t=s.default.getMsgListFirst())&&(a.default.subscribe("checkHistory",(function(e,t){var n=(0,i.checkHistory)(t).last673;n&&(0,c.default)(n)})),E=t,s.default.setDataByName("historyLastEchatId",t.echatId),P("getChatMessage",{mid:t.mid,visitorId:s.default.getVisitorInfo().visitorId,companyId:x,selectCount:D&&$[x]?1e3:50})))})),S=function(e){var t=s.default.getStatusData();2!=t.chatStatus?1==t.chatStatus&&4!=t.status||(e&&0!=e.chatStatus&&0==t.chatStatus&&a.default.publish("chatEnded",t,e),t.unreadCount>0?a.default.publish("enterUnread"):e||a.default.triggerEventOnPoint("registChat")):t.talkType==M.talkTypeChat?(a.default.publish("startChat"),a.default.publish("updateChatStaffInfo")):t.talkType==M.talkTypeRobot?a.default.publish("startRobot"):t.talkType==M.talkTypeLeave?a.default.publish("startLeave"):t.talkType==M.talkTypeQueue&&a.default.publish("startQueue")},T=K("forwardChatStatus,forwardConfigMessage,forwardStaffInfo,nativeReady,",(function(){S(),a.default.publish("sendInitVisEvt")})),I=K("forwardHistoryMessage,forwardChatStatus,forwardConfigMessage,forwardStaffInfo,nativeReady,",(function(){a.default.publish("removeLoading")})),k=K("forwardHistoryMessage,forwardStaffInfo,forwardConfigMessage,",(function(){var e=s.default.getMsgList(),t=!1;function n(e){var n=e.echatId;if(L[n]&&(e=L[n],delete L[n]),!t&&0===e.isForward&&e.data.mt){t=!0;var o=s.default.getStatusByKey("unreadCount")||0,a=o?lanRes.hasUnreadMsgNum.replace("${num}",o):lanRes.vis_21;u.default.showMsg({id:"unreadMarkLine",mt:40,tm:(new Date).getTime(),content:'<div class="tc color1"><i class="hr-left"></i> <span>'+a+'</span> <i class="hr-right"></i></div>'})}(0,c.default)(e.data)}for(var o in B=!1,a.default.publish("changeDom",{name:"#content",cls:"fading"}),e.forEach(n),L)n(L[o]);setTimeout((function(e){a.default.publish("changeDom",{name:"#content",removeCls:"fading"})}),100)})),a.default.subscribe("loadHistory",W),a.default.subscribe("setExtraMessage",(function(e,t,n){if(n){var o,a=t.allExtra.h5Extra;for(o in a&&(n=Object.assign(a,n)),n)void 0!==n[o]&&s.default.updateHistoryMsgExt(t.mid||t.bridgeMsgId,o,n[o]);P("setExtraMessage",{companyId:x,visitorId:s.default.getVisitorInfo().visitorId,rowId:t.allExtra.echatId,bridgeMsgId:t.allExtra.bridgeMsgId,h5Extra:n})}})),C={callNative:P,getInitVisparam:function(){var e=s.default.getVisitorInfo();return{visitorId:e.visitorId,companyId:e.companyId}},pageReady:function(){var e,t,n=this.getInitVisparam();if(n.companyId&&(x=n.companyId,o.default.setCurrentCompanyId(x)),!x)throw lanRes.vis_22;R=!n.visitorId,P("pageReady",{interfaceVersion:1}),P("checkWebsocketStatus"),P("getH5Data"),n.visitorId&&P("getChatMessage",v(v({},n),{},{selectCount:D&&$[x]?1e3:20})),n.visitorId&&P("getConfigMessage",n),P("getStaffInfo",n),a.default.publish("_changeCloseBtn","0"),(e=a.default.getQueryString("noConsole"))&&"1"==e&&(t=0,l.default.map((function(e){t+=e.delay||200,"evt"==e.type?setTimeout(e.value,t):setTimeout((function(){window.callEchatJsConnect(e)}),t)})))},noVisitorInfoReinit:function(){P("getConfigMessage",this.getInitVisparam()),W()},init:function(){}},a.default.subscribe("setChatStatus",(function(e,t){var n=s.default.getVisitorInfo(),o=n.visitorId,a=n.companyId;P("setChatStatus",{visitorId:o,companyId:a,chatStatus:t||1}),s.default.setStatusData({chatStatus:t})})),a.default.subscriber.call(C,"connect"),C.setSub("handle"),C.subscribe("sendMessage",f.default.send);t.default=C},272:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default=[{functionName:"nativeReady",value:{echatTag:"lh"}},{functionName:"forwardStaffInfo",value:[]},{functionName:"forwardChatStatus",value:{}},{functionName:"forwardHistoryMessage",value:[]},{functionName:"forwardConfigMessage",value:[{companyId:521582,createTime:1626922603138,data:{apiServerDomain:"devapi.rainbowred.com",bin:2,companyId:521582,companyLogo:"https://devfile.rainbowred.com/group1/M00/00/A1/rBAKCGBdQeiAUcETAAC3JrgD8sQ582.jpg",companyName:"多商户SDK平台",companyVersionType:2,country:"本地局域网",encryptVID:"C2BJ3RvTqRk=",fileUploadInfos:[{fileBucketDomain:"http://tqn.rainbowred.com/",fileBucketHttpsDomain:"https://tqn.rainbowred.com/",fileUploadHttpsUrl:"https://up-z2.qbox.me/",fileUploadParam:"key=${qiniuKey},token=${token}",fileUploadUrl:"http://up-z2.qiniu.com/",uploadServiceType:1},{fileUploadHttpsUrl:"https://test-release-02.oss-cn-hangzhou.aliyuncs.com",fileUploadParam:"key=${aliyunKey},success_action_status=200,Content-Disposition=${Content-Disposition},OSSAccessKeyId=${ossAccessKeyId},policy=${policy},Signature=${signature},callback=${callback},x:filename=${x:filename}",fileUploadUrl:"http://test-release-02.oss-cn-hangzhou.aliyuncs.com",uploadServiceType:2},{fileBucketDomain:"http://devprofile.rainbowred.com",fileBucketHttpsDomain:"https://devprofile.rainbowred.com",fileUploadHttpsUrl:"https://dev.rainbowred.com/fup",fileUploadParam:"token=${token},uploadServiceType=${uploadServiceType}",fileUploadUrl:"http://dev.rainbowred.com/fup",uploadServiceType:3}],lan:"zh",localPushRule:'{"version":"1.1","rules":[{"content":{"value":"您的对话已接通"},"interval":0,"mst":3,"mt":"604","title":{"value":"${staffNickName}"},"msgType":256},{"content":{"value":"您的对话已结束"},"interval":0,"mst":3,"mt":"605","title":{"value":"会话消息"},"msgType":256},{"content":{"value":"${content,0,30,1}"},"interval":0,"mst":2,"mt":"640","title":{"value":"${staffNickName}"},"msgType":1},{"content":{"value":"[图片]"},"interval":0,"mst":2,"mt":"641","title":{"value":"${staffNickName}"},"msgType":16},{"content":{"value":"[文件]"},"interval":0,"mst":2,"mt":"642","title":{"value":"${staffNickName}"},"type":"0","msgType":8},{"content":{"value":"[语音]"},"interval":0,"mst":2,"mt":"642","title":{"value":"${staffNickName}"},"type":"1","msgType":64},{"content":{"value":"[视频]"},"interval":0,"mst":2,"mt":"642","title":{"value":"${staffNickName}"},"type":"2","msgType":32},{"content":{"value":"${content,0,30,1}"},"interval":0,"mst":3,"mt":"647","title":{"value":"${staffNickName}"},"type":"1,2,3,4,5,6","msgType":256},{"content":{"value":"等待接入会话，排队位置:${position}"},"interval":20000,"mst":3,"mt":"648","title":{"value":"会话消息"},"msgType":128},{"content":{"value":"[图片]"},"interval":0,"mst":2,"mt":"653","title":{"value":"${staffNickName}"},"msgType":16},{"content":{"value":"您有新的消息"},"interval":0,"mst":2,"mt":"655","title":{"value":"${staffNickName}"},"msgType":2},{"content":{"value":"请您对本次服务进行评价"},"interval":0,"mst":2,"mt":"673","title":{"value":"${staffNickName}"},"msgType":256},{"content":{"value":"[链接]"},"interval":0,"mst":2,"mt":"680","title":{"value":"${staffNickName}"},"unreadCount":1,"msgType":4},{"content":{"value":"[图文消息]"},"interval":0,"mst":3,"mt":"10011","title":{"value":"${staffNickName}"},"msgType":2},{"content":{"value":"客服回复了您的留言"},"interval":0,"mst":2,"mt":"675","title":{"value":"会话消息"},"msgType":256},{"content":{"value":"当前对话被转接给客服:${toStaffNickName}"},"interval":0,"mst":3,"mt":"10001","title":{"value":"会话消息"},"msgType":256},{"content":{"value":"您有新的消息"},"interval":0,"mst":0,"mt":"0","title":{"value":"会话消息"},"msgType":1},{"content":{"value":"${content,0,30,0}"},"interval":0,"mst":1,"et":"105","title":{"value":"访客"},"msgType":1},{"content":{"value":"${content,0,30,0}"},"interval":0,"mst":1,"et":"130","title":{"value":"访客"},"msgType":1},{"content":{"value":"[地理位置]"},"interval":0,"mst":1,"et":"127","title":{"value":"访客"},"msgType":512},{"content":{"value":"[图片]"},"interval":0,"mst":1,"et":"161","title":{"value":"访客"},"msgType":16},{"content":{"value":"[视频]"},"interval":0,"mst":1,"et":"162","title":{"value":"访客"},"msgType":64},{"content":{"value":"[语音]"},"interval":0,"mst":1,"et":"163","title":{"value":"访客"},"msgType":32},{"content":{"value":"[消息]"},"interval":0,"mst":1,"et":"0","title":{"value":"访客"},"msgType":1}]}',mid:98592,mst:3,mt:"600",platformId:521582,platformLogo:"https://devfile.rainbowred.com/group1/M00/00/A1/rBAKCGBdQeiAUcETAAC3JrgD8sQ582.jpg",platformName:"多商户SDK平台",rph:0,sdkHtmlForceUpdate:0,sdkHtmlVersion:"1.4.18.8",sessionId:"25m5d4czmwsi4s1u936pctj3gpt",tm:1626922603583,uploadFileSize:1073741824,uploadFileType:"txt,doc,docx,xls,xlsx,amr,mp3,mp4,rar,zip,pdf,wav,log,mov,ppt,pptx,3gp,aac,ogg,webm,ts,3g2,3gpp,3gpp2,avi,m4v,mkv,ogg,webm,log,p12,jpg,png,gif,jpeg,webp,bmp",vcs:0,visitorId:"sdk12057",visitorInputContentMaxLength:350,visitorSessionSize:0,visitorType:2},echatId:1,isForward:1,isPublic:1,mt:"600",updateTime:0,visitorId:"sdk12057"}]},{functionName:"forwardConfigMessage",value:[{companyId:521582,createTime:1626922603138,data:{apiServerDomain:"devapi.rainbowred.com",bin:2,companyId:521582,companyLogo:"https://devfile.rainbowred.com/group1/M00/00/A1/rBAKCGBdQeiAUcETAAC3JrgD8sQ582.jpg",companyName:"多商户SDK平台",companyVersionType:2,country:"本地局域网",encryptVID:"C2BJ3RvTqRk=",fileUploadInfos:[{fileBucketDomain:"http://tqn.rainbowred.com/",fileBucketHttpsDomain:"https://tqn.rainbowred.com/",fileUploadHttpsUrl:"https://up-z2.qbox.me/",fileUploadParam:"key=${qiniuKey},token=${token}",fileUploadUrl:"http://up-z2.qiniu.com/",uploadServiceType:1},{fileUploadHttpsUrl:"https://test-release-02.oss-cn-hangzhou.aliyuncs.com",fileUploadParam:"key=${aliyunKey},success_action_status=200,Content-Disposition=${Content-Disposition},OSSAccessKeyId=${ossAccessKeyId},policy=${policy},Signature=${signature},callback=${callback},x:filename=${x:filename}",fileUploadUrl:"http://test-release-02.oss-cn-hangzhou.aliyuncs.com",uploadServiceType:2},{fileBucketDomain:"http://devprofile.rainbowred.com",fileBucketHttpsDomain:"https://devprofile.rainbowred.com",fileUploadHttpsUrl:"https://dev.rainbowred.com/fup",fileUploadParam:"token=${token},uploadServiceType=${uploadServiceType}",fileUploadUrl:"http://dev.rainbowred.com/fup",uploadServiceType:3}],lan:"zh",localPushRule:'{"version":"1.1","rules":[{"content":{"value":"您的对话已接通"},"interval":0,"mst":3,"mt":"604","title":{"value":"${staffNickName}"},"msgType":256},{"content":{"value":"您的对话已结束"},"interval":0,"mst":3,"mt":"605","title":{"value":"会话消息"},"msgType":256},{"content":{"value":"${content,0,30,1}"},"interval":0,"mst":2,"mt":"640","title":{"value":"${staffNickName}"},"msgType":1},{"content":{"value":"[图片]"},"interval":0,"mst":2,"mt":"641","title":{"value":"${staffNickName}"},"msgType":16},{"content":{"value":"[文件]"},"interval":0,"mst":2,"mt":"642","title":{"value":"${staffNickName}"},"type":"0","msgType":8},{"content":{"value":"[语音]"},"interval":0,"mst":2,"mt":"642","title":{"value":"${staffNickName}"},"type":"1","msgType":64},{"content":{"value":"[视频]"},"interval":0,"mst":2,"mt":"642","title":{"value":"${staffNickName}"},"type":"2","msgType":32},{"content":{"value":"${content,0,30,1}"},"interval":0,"mst":3,"mt":"647","title":{"value":"${staffNickName}"},"type":"1,2,3,4,5,6","msgType":256},{"content":{"value":"等待接入会话，排队位置:${position}"},"interval":20000,"mst":3,"mt":"648","title":{"value":"会话消息"},"msgType":128},{"content":{"value":"[图片]"},"interval":0,"mst":2,"mt":"653","title":{"value":"${staffNickName}"},"msgType":16},{"content":{"value":"您有新的消息"},"interval":0,"mst":2,"mt":"655","title":{"value":"${staffNickName}"},"msgType":2},{"content":{"value":"请您对本次服务进行评价"},"interval":0,"mst":2,"mt":"673","title":{"value":"${staffNickName}"},"msgType":256},{"content":{"value":"[链接]"},"interval":0,"mst":2,"mt":"680","title":{"value":"${staffNickName}"},"unreadCount":1,"msgType":4},{"content":{"value":"[图文消息]"},"interval":0,"mst":3,"mt":"10011","title":{"value":"${staffNickName}"},"msgType":2},{"content":{"value":"客服回复了您的留言"},"interval":0,"mst":2,"mt":"675","title":{"value":"会话消息"},"msgType":256},{"content":{"value":"当前对话被转接给客服:${toStaffNickName}"},"interval":0,"mst":3,"mt":"10001","title":{"value":"会话消息"},"msgType":256},{"content":{"value":"您有新的消息"},"interval":0,"mst":0,"mt":"0","title":{"value":"会话消息"},"msgType":1},{"content":{"value":"${content,0,30,0}"},"interval":0,"mst":1,"et":"105","title":{"value":"访客"},"msgType":1},{"content":{"value":"${content,0,30,0}"},"interval":0,"mst":1,"et":"130","title":{"value":"访客"},"msgType":1},{"content":{"value":"[地理位置]"},"interval":0,"mst":1,"et":"127","title":{"value":"访客"},"msgType":512},{"content":{"value":"[图片]"},"interval":0,"mst":1,"et":"161","title":{"value":"访客"},"msgType":16},{"content":{"value":"[视频]"},"interval":0,"mst":1,"et":"162","title":{"value":"访客"},"msgType":64},{"content":{"value":"[语音]"},"interval":0,"mst":1,"et":"163","title":{"value":"访客"},"msgType":32},{"content":{"value":"[消息]"},"interval":0,"mst":1,"et":"0","title":{"value":"访客"},"msgType":1}]}',mid:98592,mst:3,mt:"600",platformId:521582,platformLogo:"https://devfile.rainbowred.com/group1/M00/00/A1/rBAKCGBdQeiAUcETAAC3JrgD8sQ582.jpg",platformName:"多商户SDK平台",rph:0,sdkHtmlForceUpdate:0,sdkHtmlVersion:"1.4.18.8",sessionId:"25m5d4czmwsi4s1u936pctj3gpt",tm:1626922603583,uploadFileSize:1073741824,uploadFileType:"txt,doc,docx,xls,xlsx,amr,mp3,mp4,rar,zip,pdf,wav,log,mov,ppt,pptx,3gp,aac,ogg,webm,ts,3g2,3gpp,3gpp2,avi,m4v,mkv,ogg,webm,log,p12,jpg,png,gif,jpeg,webp,bmp",vcs:0,visitorId:"sdk12057",visitorInputContentMaxLength:350,visitorSessionSize:0,visitorType:2},echatId:1,isForward:1,isPublic:1,mt:"600",updateTime:0,visitorId:"sdk12057"}]},{functionName:"forwardChatMessage",value:[{companyId:521582,createTime:1626922603443,data:{bin:8,companyId:521582,country:"本地局域网",keywordType:"0",mid:98595,mst:3,mt:"671",rph:0,tm:1626922603924,vcs:0,visitorId:"sdk12057"},echatId:0,isForward:0,mid:98595,mt:"671",sendStatus:0,show:1,updateTime:0,visitorId:"sdk12057"}]},{functionName:"forwardChatMessage",value:[{companyId:521582,createTime:1626922603505,data:{bin:8,canChatNow:0,chatStatus:0,companyId:521582,mid:98596,mst:3,mt:"610",rph:0,status:4,tm:1626922603928,vcs:0,visitorId:"sdk12057"},echatId:0,isForward:0,mid:98596,mt:"610",sendStatus:0,show:1,updateTime:0,visitorId:"sdk12057"}]},{functionName:"forwardConfigMessage",value:[{companyId:521582,createTime:1626922603518,data:{bin:2,canChatNow:0,chatStatus:0,companyId:521582,companyLogo:"https://devfile.rainbowred.com/group1/M00/00/A1/rBAKCGBdQeiAUcETAAC3JrgD8sQ582.jpg",companyName:"多商户SDK平台",echatSourceTagEnable:"1",enableEchatHyperlink:"1",enableEchatUrl:"1",jobWindowInfo:{commitSuccessHint:"工单已提交成功",configuration:[{configDesc:"标题",configName:"title",configRequired:"1",configSort:"1",wordDesc:"请填写"},{configDesc:"内容",configName:"content",configRequired:"1",configSort:"2",wordDesc:"请填写"}],description:"默认描述",fieldSettings:[{enable:1,field:"title",fieldId:1087,isSystem:1,label:"标题",settings:[],type:1},{enable:1,field:"content",fieldId:1088,isSystem:1,label:"内容",settings:[],type:2}],jobQRCodeEnable:"1",jobTemplateId:58,lan:"default",nonce:"gxcR53sdsu",styleId:"204",title:"默认标题",token:"1874110482c3aab29d4eeee7c672a6808139372e"},media:"6",mid:98597,mst:3,mt:"649",notThroughStatus:0,routeId:"57",rph:0,sdkChatBoxInfo:{busyNotAllowSendStatus:"1",busyNotAllowTips:"当前客服忙碌，请等待客服接入后发送聊天消息。",chatAd1Html:"http://chats.rainbowred.com/res/style/e/s1/chat_right.png",chatAdWidth:"349",chatBoxAdHeight:"40",chatBoxAdImgLinkFixed:"1",chatBoxAdImgLinkOpenType:"1",chatBoxInnerAdImg:"https://devfile.rainbowred.com/group1/M00/00/A2/rBAKCGB5UkqAJH40AAAVZWq_QqY898.png",chatBoxInnerAdImgLinkOpenType:"2",chatBoxInnerAdImgLinkUrl:"http://www.baidu.com",chatBoxInnerAdType:"3",chatBoxRightAdImg:"http://chats.rainbowred.com/res/style/e/s1/chat_right.png",chatBoxRightAdType:"3",chatBoxStaffImgEnable:"1",chatBoxTitle:"Echat对话",chatColor:"rgb(86,131,26)",chatEndBtnBackColor:"#484a4a",chatEndBtnTxtColor:"#3bc47a",chatLogoImg:"http://vs.rainbowred.com/res/style/e/s1/pc_logo.png",chatStaffBackColor:"rgb(174,207,175)",chatStaffTxtColor:"rgb(220,244,251)",chatThemeBackColor:"#ffa726",chatThemeTxtColor:"rgb(241,214,244)",chatVisitorBackColor:"rgb(190,164,238)",chatVisitorTxtColor:"rgb(129,64,64)",defaultStaffImg:"http://vs.rainbowred.com/res/imgs/staff.png",defaultVisitorImg:"http://es.echatsoft.com/res/style/e/s3/visitor.png",enableChatEndBtn:"1",enableQRCode:"1",evaluateThemeColor:"rgb(24,56,122)",qrCodeType:"1",styleId:"204",sysMsgBackground:"rgb(163,91,91)",sysMsgFontColor:"rgb(250,243,243)",sysMsgIcon:"http://vs.rainbowred.com/res/imgs/sysinfo.png",toolAlbum:"1",toolCamera:"1",toolEmoji:"1",toolFile:"1",toolImg:"1",toolLocation:"1",toolSatisfaction:"1",toolScreenshot:"1",toolTelephone:"1",toolVoice:"1",type:"6",windowTextColor:"#888888",windowThemeBackColor:"#eeeeee"},status:4,styleId:"204",tm:1626922603929,unreadMsgNumber:0,vcs:0,visitorId:"sdk12057"},echatId:2,isForward:1,isPublic:0,mt:"649",updateTime:1626922603518,visitorId:"sdk12057"}]},{functionName:"forwardConfigMessage",value:[{data:{bin:2,binDefine:2,canChatNow:0,chatBoxInfo:{busyNotAllowSendStatus:"0",busyNotAllowTips:"当前客服忙碌，请等待客服接入后发送聊天消息。",chatAd1Html:"https://vs.rainbowred.com/res/style/e/s1/chat_right.png",chatAdWidth:"349",chatBoxAd1ParamAppendType:"1",chatBoxAdHeight:"0",chatBoxAdImgLinkFixed:"1",chatBoxAdPostEnable:"0",chatBoxInnerAdImgLinkEnable:"1",chatBoxInnerAdImgLinkOpenType:"1",chatBoxInnerAdParamAppendType:"1",chatBoxLAdParamAppendType:"1",chatBoxLeftAdImgLinkEnable:"1",chatBoxLeftAdImgLinkOpenType:"1",chatBoxRightAdImg:"https://es.echatsoft.com/res/style/e/s3/chat_right.png",chatBoxRightAdImgLinkEnable:"1",chatBoxRightAdImgLinkOpenType:"1",chatBoxRightAdType:"3",chatBoxStaffImgEnable:"3",chatBoxTitle:"预发布测试-客服",chatColor:"#ffa726",chatEndBtnBackColor:"#ffffff",chatEndBtnTxtColor:"#ffffff",chatLogoImg:"https://es.echatsoft.com/res/style/e/s3/logo.png",chatLogoImgEnable:"1",chatLogoImgType:"1",chatStaffBackColor:"#ffffff",chatStaffTxtColor:"#323232",chatThemeBackColor:"#ffa726",chatThemeTxtColor:"#ffffff",chatVisitorBackColor:"#ffa726",chatVisitorTxtColor:"#ffffff",companyName:"预发布测试",companyNameEnable:"1",companyNameType:"2",customIconEnable:"1",defaultStaffImg:"https://es.echatsoft.com/res/style/e/s3/staff.png",defaultVisitorImg:"https://es.echatsoft.com/res/style/e/s3/visitor.png",enableChatEndBtn:"1",enableQRCode:"1",evaluateThemeColor:"#ffb545",msgboxNoChatTip:"当前暂无对话",qrCodeType:"1",staffInfoChattingEnable:"0",staffInfoEnable:"0",styleId:"157",subcompanyUrlEnable:"0",subcompanyUrlType:"1",sysMsgBackground:"#c6c6c6",sysMsgFontColor:"#ffffff",sysMsgIcon:"https://vs.rainbowred.com/res/imgs/sysinfo.png",toolAlbum:"1",toolCamera:"1",toolEmoji:"1",toolFile:"1",toolImg:"1",toolLocation:"1",toolSatisfaction:"1",toolScreenshot:"1",toolTelephone:"1",toolVoice:"1",type:"1",windowTextColor:"#888888",windowThemeBackColor:"#eeeeee",windowThemeBackTransparency:"100%",windowType:"1"},chatStatus:0,companyId:521664,companyLogo:"https://yfbfile.echatsoft.com/group1/M00/00/2A/rBAKDmbFunOAL3tNAAEXVmU0MyY943.png",companyName:"预发布测试",companyWebSite:"http://www.baidu.com",echatSourceTagEnable:"1",enableEchatHyperlink:"1",enableEchatUrl:"1",eventId:"AEbntx1cm38=",jobWindowInfo:{commitSuccessHint:"工单已提交成功",configuration:[{configDesc:"内容",configName:"content",configRequired:"1",configSort:"2",configType:"2",filedType:1,wordDesc:"请输入"},{configDesc:"备注",configName:"memo",configRequired:"0",configSort:"3",configType:"2",filedType:1,wordDesc:"请填写"},{configDesc:"上传日志",configName:"c1",configRequired:"0",configSort:"6",configType:"1",filedType:1,wordDesc:"上传"},{configDesc:"标题",configName:"title",configRequired:"1",configSort:"7",configType:"1",filedType:1,wordDesc:"请输入"},{configDesc:"长文本",configName:"c2",configRequired:"1",configSort:"8",configType:"2",filedType:1,wordDesc:"请填写"},{configDesc:"单选",configName:"c4",configRequired:"0",configSort:"9",configType:"4",filedType:1,wordDesc:"请选择"},{configDesc:"列表",configName:"c3",configRequired:"0",configSort:"10",configType:"3",filedType:1,wordDesc:"请选择"},{configDesc:"多选",configName:"c5",configRequired:"0",configSort:"11",configType:"5",filedType:1,wordDesc:"请选择"},{configDesc:"日期",configName:"c6",configRequired:"0",configSort:"12",configType:"6",filedType:1,wordDesc:"请填写"},{configDesc:"邮箱",configName:"email",configRequired:"1",configSort:"12",configType:"1",filedType:1,wordDesc:"请填写"},{configDesc:"数值",configName:"c7",configRequired:"0",configSort:"13",configType:"7",filedType:1,wordDesc:"请选择"},{configDesc:"t11",configName:"t11",configRequired:"0",configSort:"13",configType:"7",filedType:1,wordDesc:"请选择"},{configDesc:"日志",configName:"log",configRequired:"1",configSort:"13",configType:"8",filedType:1,wordDesc:"请填写"}],description:"默认描述",fieldSettings:[{enable:1,field:"content",fieldId:68,isSystem:1,label:"内容",settings:[],type:2},{enable:1,field:"memo",fieldId:55,isSystem:1,label:"备注",settings:[],type:2},{enable:1,field:"c1",fieldId:137,isSystem:0,label:"短文本",settings:[],type:1},{enable:1,field:"title",fieldId:67,isSystem:1,label:"标题",settings:[],type:1},{enable:1,field:"c2",fieldId:138,isSystem:0,label:"长文本",settings:[],type:2},{enable:1,field:"c4",fieldId:140,isSystem:0,label:"单选",lan:"default",settings:[{configs:[{item:"你奥术大师大所大所多你奥术大师大所大所多你奥术大师大所大所多你奥术大师大所大所多你奥术大师大所大所多dasd大叔大婶打算打算打你奥术大师大所大所多你奥术大师大所大所多你奥术大师大所大所多你奥术大师大所",sort:1,value:"1"},{item:"率",sort:2,value:"2"}],lan:"default"}],type:4,valueOverlength:!1},{enable:1,field:"c3",fieldId:139,isSystem:0,label:"列表",lan:"default",settings:[{configs:[{item:"11",sort:1,value:"1"},{item:"22",sort:2,value:"2"},{item:"33",sort:3,value:"3"}],lan:"default"}],type:3,valueOverlength:!1},{enable:1,field:"c5",fieldId:141,isSystem:0,label:"多选",lan:"default",settings:[{configs:[{item:"钱",sort:1,value:"1"},{item:"人",sort:2,value:"2"},{item:"自由",sort:3,value:"3"},{item:"你奥术大师大所大所多你奥术大师大所大所多你奥术大师大所大所多你奥术大师大所大所多你奥术大师大所大所多你奥术大师大所大所多你奥术大师大所大所多你奥术大师大所大所多你奥术大师大所大所多你奥术大师大所大所多",sort:4,value:"4"}],lan:"default"}],type:5,valueOverlength:!1},{enable:1,field:"c6",fieldId:142,isSystem:0,label:"日期",settings:[],type:6},{enable:1,field:"email",fieldId:52,isSystem:1,label:"邮箱",settings:[],type:1},{enable:1,field:"c7",fieldId:143,isSystem:0,label:"数值",lan:"default",settings:[{configs:{end:100,start:1,stepSize:1},lan:"default"}],type:7,valueOverlength:!1},{enable:1,field:"t11",fieldId:555,isSystem:0,label:"t11",lan:"default",settings:[{configs:{end:100,start:1,stepSize:1},lan:"default"}],type:7,valueOverlength:!1}],jobQRCodeEnable:"1",jobTemplateId:4,lan:"default",nonce:"gvhIKS77MX",styleId:"157",title:"默认标题",token:"7de6ff4f2fd72d93fe5f87ec1bbb9aa36e441c09"},media:"1",mid:418625,mst:3,mt:"649",notThroughStatus:0,routeId:"120",rph:0,status:4,styleId:"157",tm:1724295361047,unreadMsgNumber:0,vcs:0,visitorId:"web25814"},channel:"/visitor/selfmsg"}]},{functionName:"forwardChatStatus",value:{canChatNow:0,chatStatus:0,companyId:521582,createTime:1626922603493,echatId:1,hide:0,icon:"https://devfile.rainbowred.com/group1/M00/00/A1/rBAKCGBdQeiAUcETAAC3JrgD8sQ582.jpg",staffId:0,status:4,talkType:0,title:"多商户SDK平台",top:0,unreadCount:0,updateTime:1626922603493,visitorId:"sdk12057"}},{functionName:"prepareUpload",value:{clientFileId:"22f5b678-91ab-48e0-9516-a1293422af7c",companyId:521582,createTime:1626922611278,data:{bigLenth:0,smallLenth:0,sourceLenth:0,clientFileId:"22f5b678-91ab-48e0-9516-a1293422af7c",companyId:521582,et:"161",fileType:1,isOrder:!0,isOtherProcess:!1,isUploading:!1,loadStatus:0,localFile:"content://media/external/images/media/1534887",mid:0,msgType:1,progress:0,sendStatus:1,staffId:0,tm:0,visitorId:"sdk12057"},echatId:1,et:"161",isForward:1,sendStatus:0,show:0,updateTime:0,visitorId:"sdk12057"}},{functionName:"uploadStart",value:{clientFileId:"22f5b678-91ab-48e0-9516-a1293422af7c",companyId:521582,createTime:1626922611278,data:{bigLenth:0,smallLenth:0,sourceLenth:0,clientFileId:"22f5b678-91ab-48e0-9516-a1293422af7c",companyId:521582,et:"161",fileType:1,identityKey:"job/1/8598775a-5020-4935-a26e-988a6f6fc608",isOrder:!0,isOtherProcess:!1,isUploading:!1,loadStatus:0,localFile:"content://media/external/images/media/1534887",mid:0,msgType:1,progress:0,sendStatus:1,staffId:0,tm:0,visitorId:"sdk12057"},echatId:1,et:"161",identityKey:"job/1/8598775a-5020-4935-a26e-988a6f6fc608",isForward:1,sendStatus:0,show:0,updateTime:0,visitorId:"sdk12057"}},{functionName:"uploadProgress",value:{clientFileId:"22f5b678-91ab-48e0-9516-a1293422af7c",companyId:521582,createTime:1626922611278,data:{bigLenth:0,smallLenth:0,sourceLenth:0,clientFileId:"22f5b678-91ab-48e0-9516-a1293422af7c",companyId:521582,et:"161",fileType:1,identityKey:"job/1/8598775a-5020-4935-a26e-988a6f6fc608",isOrder:!0,isOtherProcess:!1,isUploading:!1,loadStatus:0,localFile:"content://media/external/images/media/1534887",mid:0,msgType:1,progress:73,sendStatus:1,staffId:0,tm:0,visitorId:"sdk12057"},echatId:1,et:"161",identityKey:"job/1/8598775a-5020-4935-a26e-988a6f6fc608",isForward:1,sendStatus:0,show:0,updateTime:0,visitorId:"sdk12057"}},{functionName:"uploadProgress",value:{clientFileId:"22f5b678-91ab-48e0-9516-a1293422af7c",companyId:521582,createTime:1626922611278,data:{bigLenth:0,smallLenth:0,sourceLenth:0,clientFileId:"22f5b678-91ab-48e0-9516-a1293422af7c",companyId:521582,et:"161",fileType:1,identityKey:"job/1/8598775a-5020-4935-a26e-988a6f6fc608",isOrder:!0,isOtherProcess:!1,isUploading:!1,loadStatus:0,localFile:"content://media/external/images/media/1534887",mid:0,msgType:1,progress:93,sendStatus:1,staffId:0,tm:0,visitorId:"sdk12057"},echatId:1,et:"161",identityKey:"job/1/8598775a-5020-4935-a26e-988a6f6fc608",isForward:1,sendStatus:0,show:0,updateTime:0,visitorId:"sdk12057"}},{functionName:"uploadSuccess",value:{clientFileId:"22f5b678-91ab-48e0-9516-a1293422af7c",companyId:521582,createTime:1626922611278,data:{bigLenth:0,smallLenth:0,sourceLenth:0,clientFileId:"22f5b678-91ab-48e0-9516-a1293422af7c",companyId:521582,et:"161",fileType:1,identityKey:"job/1/8598775a-5020-4935-a26e-988a6f6fc608",isOrder:!0,isOtherProcess:!1,isUploading:!1,loadStatus:0,localFile:"content://media/external/images/media/1534887",mid:0,msgType:1,progress:100,sendStatus:2,staffId:0,tm:0,visitorId:"sdk12057"},echatId:1,et:"161",identityKey:"job/1/8598775a-5020-4935-a26e-988a6f6fc608",isForward:1,nativeExtra:{bucket:"test",smallUrl:"https://tqn.rainbowred.com/job/1/8598775a-5020-4935-a26e-988a6f6fc608?imageView2/1/w/200/h/150",sourceUrl:"https://tqn.rainbowred.com/job/1/8598775a-5020-4935-a26e-988a6f6fc608",sourceWidth:1080,sourceHeight:2340,bigUrl:"https://tqn.rainbowred.com/job/1/8598775a-5020-4935-a26e-988a6f6fc608?imageView2/1/w/553/h/1200",fileType:4,key:"job/1/8598775a-5020-4935-a26e-988a6f6fc608"},sendStatus:0,show:0,updateTime:0,visitorId:"sdk12057"}}]},273:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(15),n(21),n(30),n(31);var o=s(n(4)),a=s(n(45)),i=s(n(8)),r=s(n(55));function s(e){return e&&e.__esModule?e:{default:e}}t.default=function(e){if(!e)return!1;var t,n,s=!1,l=parseInt(e.mt||e.et);switch(l){case 600:break;case 605:2==i.default.getStatusByKey("chatStatus")&&(i.default.setStatusByKey("visitorClose",1==e.closeRease),o.default.publish("chatEnded",e,i.default.getStatusData()),i.default.setStatusByKey("chatStatus",0));break;case 610:var c=e.canChatNow,u=e.status;e.chatStatus;i.default.setStatusData({canChatNow:c,status:u});break;case 105:case 130:case 641:case 642:case 647:case 658:case 655:case 680:case 688:case 959:case 10011:s=!0;break;case 161:case 162:case 163:case 864:case 865:case 866:case 902:s=!0,0==e.isForward&&(t=i.default.getStatusData()).talkId&&e.talkId==t.talkId&&2===t.chatStatus&&t.talkType==o.default.Constants.talkTypeChat&&o.default.publish("_addSendMsgNum",e);break;case 640:if(s=!0,0==e.isForward&&o.default.publish("clearMsgTyping",e),e.relateId){i.default.updateMsgByIndetity(e.relateId,{mt:647,content:lanRes.backMsgTip});var d=i.default.getMsgFromHistory(e.relateId);d&&r.default.replaceMsg(d.msg)}break;case 644:o.default.publish("getMsgTyping",e);break;case 648:2==(t=i.default.getStatusData()).chatStatus&&t.talkId==e.talkId&&o.default.publish("getPosMsg",e);break;case 646:break;case 649:o.default.publish("waitingChat",e);break;case 650:0==e.isForward&&(i.default.setStatusByKey("captChaToken",e.captChaToken),o.default.publish("refreshCode",e));break;case 651:break;case 652:console.log(e);break;case 670:o.default.publish("entryCallback",e);break;case 672:case 696:i.default.setVisitorInfo(e);break;case 673:e.talkId==i.default.getStatusByKey("talkId")&&0==e.isForward&&o.default.publish("inviteSatisfy",e);break;case 677:case 678:t={talkType:a.default.talkTypeLeave,chatStatus:2,staffId:"",talkId:e.talkId},i.default.setStatusData(t),o.default.publish("startLeave",e);break;case 697:t={talkType:a.default.talkTypeQueue,chatStatus:2,staffId:"",talkId:e.talkId},i.default.setStatusData(t),o.default.publish("startQueue",e);break;case 603:i.default.setStatusData({status:e.status});break;case 604:case 679:!function(e,t){var n,r=i.default.getStatusData(),s={talkId:e.talkId},l=2==r.chatStatus&&r.talkType==a.default.talkTypeChat,c=e.staffNickName,u=e.staffId,d=e.staffDetailInfo||{},f=d.staffHead,p=d.staffPhone;l||(s.talkType=a.default.talkTypeChat,s.chatStatus=2),e.staffId&&(s.staffId=e.staffId),i.default.setStatusData(s),l||o.default.publish("startChat",e),e.staffId&&e.staffDetailInfo&&((n={})[u]={staffNickName:c,staffHead:f,staffPhone:p,staffId:u},i.default.setStaffInfo(n)),604==t&&o.default.publish("updateChatStaffInfo")}(e,l);break;case 687:case 691:t={talkType:a.default.talkTypeRobot,chatStatus:2,staffId:"",talkId:e.talkId},i.default.setStatusData(t),o.default.publish("startRobot",e);break;case 684:case 685:o.default.publish("getNewUnreadMsgCount",e);break;case 689:n=i.default.getStatusByKey("staffId"),e.staffInfoList&&(e.staffInfoList.forEach((function(e){var t=e.staffId,a={};t==n&&o.default.publish("updateChatStaffInfo"),a[t]=e,i.default.setStaffInfo(a)})),r.default.updateMsgStaff());break;case 695:i.default.setConfig("config695",e),o.default.publish("displayRouter",e);break;case 876:o.default.publish("overLength",e);break;case 923:!function(e){var t=e.newVisitorId,n=e.oldVisitorId;o.default.publish("updateVisitorInfo",{visitorId:t,photo:e.metaDataInfo.photo}),n!=t&&i.default.setVisitorInfo({oldVisitorId:e.oldVisitorId,visitorId:t})}(e);break;case 928:break;case 12001:s=!0,o.default.publish("getMsgRobot",e);break;case 12005:o.default.publish("getMsgStreamInput",e);break;case 12006:o.default.publish("getRobotStreamEnd",e);break;case 10001:s=!0,o.default.publish("updateChatStaffInfo");break;case 10021:o.default.changeToPlatform(e);break;default:s=!0,console.log("没有处理的消息，目前走了一下显示逻辑",e)}return s&&r.default.showMsg(e),s}},274:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(51),n(88),n(15),n(21),n(53),n(10);var o=r(n(42)),a=r(n(4)),i=r(n(8));function r(e){return e&&e.__esModule?e:{default:e}}var s,l,c=o.default.callEchatNativeConnect,u=[],d=[],f={105:1,130:1,127:1},p={105:1,130:1,127:1},h={109:1,104:1,132:1,105:1,130:1,127:1},m={};function g(e,t){if(!e.successful)return!1;if(p[t.et]&&!!!e.mid)return e.successful=!1,e.wsSuccessful=!0,e.failure={reason:"no-chat-session"},!1;return!0}s=function(e){var t,n,o=e?d:u;if(o.length>0)for(n=0;n<o.length&&(t=o[n])&&(t.sending||(t.sending=!0,t.data.isResend=1,l(t.data,t.cb,t,e)));n++);},l=function(e,t,n){var o=1==e.isSave,a=o?d:u;if(e.bridgeMsgId&&!n){var r=a.filter((function(t){return t.data.bridgeMsgId==e.bridgeMsgId}));if(r.length>0&&(n=r[0]),n&&n.sending&&n.data.isResend)return}var l=n?n.time:(new Date).getTime(),f=n||{data:e,cb:t,time:l,sending:!0};function p(){for(var e=a.length-1;e>-1;e--)if(a[e]&&a[e].time==l){a.splice(e,1);break}}return!n&&!h[e.et]&&a.push(f),function(e,t){e.bridgeMsgId=e.bridgeMsgId||i.default.getNextBridgeMsgId(),c("sendMessage",e),m[e.bridgeMsgId]=t}(e,(function(n){var a=g(n,e);t&&t.apply(this,arguments),a?(p(),setTimeout((function(e){s(o)}))):f.sending=!1})),!0},a.default.subscribe("clearSendingMsg",(function(e,t){var n,o,a=d;if(a.length>0){for(o=0;o<a.length;o++)(n=a[o]).cb&&n.cb({successful:!1,failure:{type:"new session"},autoResend:!1});a.length=0}}));t.default={flashMsg:s,send:function(e,t,n){var o=i.default.getVisitorInfo();t.companyId=o.companyId,t.visitorId=o.visitorId,0!==t.isSave&&(t.isSave=f[t.et]?1:0),l(t,n,null,!0)},callback:function(e){var t=e.bridgeMsgId;m[t]&&m[t](e)}}},4:function(e,t,n){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}n(25),n(33),n(39),n(60),n(34),n(61),n(44),n(52),n(62),n(40),n(30),n(31),n(41),Object.defineProperty(t,"__esModule",{value:!0}),t.checkFirstMsg=function(e){if(!e)return;try{e=JSON.parse(e)}catch(e){return}function t(e,t){return e&&(e+"").replace(/<(?:.|\s)*?>/gi,"").substring(0,t||100)}if("text"==e.msgType&&e.content)return{msgType:"text",content:t(e.content),translation:e.translation&&t(e.translation)};if("image"==e.msgType&&e.picUrl)return{msgType:"image",picUrl:e.picUrl,thumbUrl:e.thumbUrl||""};if("video"==e.msgType&&e.fileUrl)return{msgType:"video",fileUrl:e.fileUrl,fileSize:e.fileSize||0,fileName:e.fileName||"",thumbUrl:e.thumbUrl};if("file"==e.msgType&&e.fileUrl)return{msgType:"file",fileUrl:e.fileUrl,fileSize:e.fileSize||0,fileName:e.fileName||""}},t.default=void 0,t.isArray=b,n(51),n(35),n(86),n(19),n(15),n(63),n(69),n(3),n(71),n(87),n(50),n(22),n(11),n(122),n(170),n(21),n(53),n(10);var a=s(n(233)),i=s(n(45)),r=s(n(243));function s(e){return e&&e.__esModule?e:{default:e}}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function c(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=o(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!=o(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==o(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}window.$=a.default,window._$=function(e){return document.getElementById(e)},window._echat0={scrollToBottom:void 0,imgError:void 0,checkImg:function(e){if(window.hotcss){var t=window.hotcss.dpr,n=e.width,o=e.height,a=e.parentNode.clientHeight;e.parentNode.clientWidth/t>n&&a/t>o&&(e.style.width=2*n+"px")}}};var u,d,f,p,h,m,g,v={},y={demo:[{check:function(){},callback:function(){}}]};function b(e){return"[object Array]"===Object.prototype.toString.apply(e)}u={Constants:i.default,bot:/spider|bot/i.test(navigator.userAgent),EchatObjKeyMap:v,isMobile:!0,clickName:"touchend",SDKNative:!0,SDK:!0,dji:!1,mini:!1,windowType:void 0,needHttps:"https:"==location.protocol||"file:"==location.protocol?"https:":"",subMap:{},eventMap:{},eventMapAsync:{},replaceHtml:function(e){return e&&(e+"").replace(/<(?:.|\s)*?>/gi,"").substring(0,100)},addEventPoint:function(e,t){var n;if("function"==typeof t)return(n=y[e]||[]).push({once:!1,check:function(){return!0},callback:t}),void(y[e]=n);e&&"string"==typeof e&&t&&t.check&&"function"==typeof t.check&&(t.callback&&"function"!=typeof t.callback||(n=y[e]||[],!1!==t.once&&(t.once=!0),n.push(t),y[e]=n))},triggerEventOnPoint:function(e){var t,n=arguments,o=this,a=y[e];a&&0!=a.length&&(a=a.filter((function(e){var a=[];for(t=1;t<n.length;t++)a.push(n[t]);return!e.check||!e.check.apply(o,a)||(e.callback&&e.callback.apply(o,a),!e.once)})),y[e]=a)},subscriber:function(e){this.subMap={},this.eventMap={},this.eventMapAsync={},v[e||this.KEY]=this,this.setSub=function(e){this.subMap[e]=e},this.removeSub=function(e){delete this.subMap["string"==typeof e?e:e.KEY]},this.publish=function(e){var t,n,o,a,i,r,s=this.subMap;for(o in s)if((a=v[o])&&a.eventMap&&(a.eventMap[e]||a.eventMapAsync[e])){if((i=a.eventMap[e])&&b(i))for(r=0;r<i.length;r++)try{i[r].apply(a,arguments)}catch(e){console.log(e)}if((t=a.eventMapAsync[e])&&b(t))for(r=0;r<t.length;r++)!function(e,t,n){setTimeout((function(){e.apply(t,n)}))}(t[r],a,arguments)}return n},this.subscribe=function(e,t,n){n?this.eventMapAsync[e]?this.eventMapAsync[e].push(t):this.eventMapAsync[e]=[t]:this.eventMap[e]?this.eventMap[e].push(t):this.eventMap[e]=[t]},this.unSubscribeAll=function(){this.eventMap={},this.eventMapAsync={}},this.unSubscribe=function(e){if(b(e))for(var t=0;t<e.length;t++)delete this.eventMap[e[t]],delete this.eventMapAsync[e[t]];else delete this.eventMap[e],delete this.eventMapAsync[e]}},isArray:b,getQueryString:function(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i"),n=location.search.substr(1).match(t);if(null!=n)return decodeURIComponent(n[2])},escapeHtml:function(e){return e?"string"!=typeof e?e:e.replace(/</g,"&lt;").replace(/>/g,"&gt;"):""},escapeRegExp:(p=/[\\^$.*+?()[\]{}|]/g,h=new RegExp(p.source),function(e){return e&&h.test(e)?e.replace(p,"\\$&"):e}),addMapParams:function(e){var t,n="";for(t in e)n+="&"+t+"="+encodeURIComponent(e[t]||"");return n},addMapParams1:function(e){var t,n=[];for(t in e)n.push(t+"="+encodeURIComponent(e[t]||""));return n.join("&")},getQueryParams:function(e){var t,n,o,a,i,r={};for("string"!=typeof e&&(e=location.search),-1!=e.indexOf("#")&&(e=e.substring(0,e.indexOf("#"))),-1!=e.indexOf("?")&&(e=e.substring(e.indexOf("?")+1)),o=(t=e.split("&")).length,a=0;a<o;a++)t[a]&&(n=t[a].split("="))[0]&&n[1]&&(r[n[0]]=decodeURIComponent(n[1]));if(r.visEvt)try{(i=JSON.parse(r.visEvt))&&i.eventId&&(r.eventId=i.eventId,r.eventid=i.eventId)}catch(e){}return r},hasStorage:function(){var e;try{if(!window.localStorage)return!1;if(window.localStorage.setItem("echt_test_storage","ok"),!(e=window.localStorage.getItem("echt_test_storage")))return!1}catch(e){return!1}return e&&window.localStorage.removeItem("echt_test_storage"),!0}(),hasCookie:($.cookie("echt_test_cookie","ok"),!!$.cookie("echt_test_cookie")&&($.cookie("echt_test_cookie",null),!0)),getBackground:function(e,t){var n,o=[],a=parseInt(t||100)/100,i=(e||"rgb(255,255,255)").toLocaleLowerCase().trim();if(0==i.indexOf("rgb"))i=i.replace("rgb","rgba").replace(")",","+a+")");else if(0==i.indexOf("#")){for(i=i.replace("#","").split(""),n=0;n<i.length;n++)3==i.length?o.push(parseInt("0x"+i[n]+i[n])):n%2==0&&o.push(parseInt("0x"+i[n]+i[n+1]));o.push(a),i="rgba("+o.join()+")"}return i},init:function(){var e=this,t=this;this.queryParams=this.getQueryParams(),this.companyId=this.getQueryString("companyid"),$.store=this.hasStorage?function(e,t,n){return e?arguments.length>1&&(!/Object/.test(Object.prototype.toString.call(t))||null==t)?(n=$.extend({},n),null==t&&(n.expires=-1),t=String(t),n.session?window.sessionStorage.setItem(e,t):window.localStorage.setItem(e,t),t):(n=t||{}).local?window.localStorage.getItem(e):n.session?window.sessionStorage.getItem(e):window.localStorage.getItem(e)||window.sessionStorage.getItem(e)||$.cookie(e):null}:$.cookie,this.checkDomain=function(e,t){function n(e){return e.replace(/^http[s]?:\/\//i,"")}if(!e||!t||!t.length)return!1;e=n(e);for(var o=0;o<t.length;o++)if(t[o]&&(e==n(t[o])||-1!=e.indexOf(t[o].replace(/[^\.]+./,""))))return!0;return!1};var n,o=navigator.userAgent.toLowerCase();function a(e,t){return e.type=="pointer"+t||e.type.toLowerCase()=="mspointer"+t||e.type=="mouse"+t}this.Browser={isMobile:/android|iphone|ipod|windowsphone|mobile/i.test(o),isWindows:/windows/i.test(o)||-1!=o.indexOf("win32"),isMac:-1!=o.indexOf("macintosh")||-1!=o.indexOf("mac os x")||-1!=window.navigator.platform.indexOf("Mac"),isIPhone:-1!=o.indexOf("iPhone"),isIOS:!!o.match(/iphone os\s(\d+)/),isAndorid:/android/i.test(o)},this.Browser.isIOS&&(this.Browser.osVersion=+/\d+/.exec(new RegExp("iphone os \\d+").exec(o)||"")),t.Browser.isPC=!this.Browser.isMobile,t.isMobile=this.Browser.isMobile,t.clickName=t.isMobile?"touchstart":"click",this.Device={OS:this.Browser.isAndorid?"android":this.Browser.isIPhone?"ios":this.Browser.isWindows?"windows":this.Browser.isMac?"osx":"other"},n=window.mobilePage||-1!=location.href.split("?")[0].indexOf("/visitor/mobile/")&&!v.outerId,t.Browser.isMobile||n||!t.Browser.isPC?t.Device.media=2:t.Device.media=1,this.iScrollParam=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({bounce:!this.Browser.isIOS||this.Browser.osVersion<14},i.default.iScrollParam),console.log("iScrollParam",this.iScrollParam,this.Browser.osVersion),this.hasTranslation=this.Browser.isMobile,this.setTransform=function(e,n){var o="translate("+e+"px,"+n+"px)";t.hasTranslation?$(this).css({"-webkit-transform":o,"-o-transfrom":o,"-ms-transform":o,"-moz-transform":o,transform:o}):$(this).css({left:e+"px",top:n+"px"})},d="getSelection"in window?function(){window.getSelection().removeAllRanges()}:function(){document.selection.empty()},this.pageSlide=function(e,n){$(e).attr("x","0"),$(document).on("mousedown touchstart",e,(function(e){if(!a(e=e||window.event,"down")||((o=e).type.indexOf("mouse")>-1||("touch"==o.pointerType||o.pointerType==o.MSPOINTER_TYPE_TOUCH)&&o.isPrimary)){var o,i,r,s,l=a(e,"down"),c={},u=0,f=$(this),p=this.parentNode.clientWidth,h=p/8,m=parseInt(f.attr("x")||this.offsetLeft)||0,g=this.clientWidth,v=-g+p-20;c.x2=void 0,c.y2=void 0,e=l?e:e.touches&&e.touches[0]||e,c.x1=e.clientX,c.y1=e.clientY,f.removeClass("transition"),i=function(e){e.preventDefault()},p=parseInt(g/parseInt(g/p)),document.body.addEventListener&&document.body.addEventListener("touchmove",i,{passive:!1}),r=function(e){if(f){e=l?e:e.touches&&e.touches[0]||e,c.x2=e.clientX,c.y2=e.clientY,u=c.x2-c.x1,c.y2-c.y1;var n=u+m;n>20?n=20:n<v&&(n=v),t.setTransform.call(f,n,0),f.attr("x2",n),d(),e.originalEvent&&(e=e.originalEvent),e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}},s=function(e){if(d(),f){f.addClass("transition");var o,a=0;if(h<Math.abs(u)?u>=h&&m+p<=0?(t.setTransform.call(f,m+p,0),f.attr("x",m+p),a=-1):u<=-h&&m-p+g>p/10?(t.setTransform.call(f,m-p,0),f.attr("x",m-p),a=1):t.setTransform.call(f,m,0):t.setTransform.call(f,m,0),o=n&&n(a),$(document).off("mousemover mousemove touchmove pointermove",r).off("mouseup touchend pointerup",s),f=null,d(),!1===o)return e.stopPropagation&&e.stopPropagation,e.preventDefault&&e.preventDefault(),!1;document.body.removeEventListener&&document.body.removeEventListener("touchmove",i)}},$(document).on("mousemover mousemove touchmove pointermove",r).on("mouseup touchend pointerup",s)}}))},this.getCSSRule=function(e,t,n){if(n=n||window.document,e=e.toLowerCase(),n.styleSheets)for(var o=0;o<n.styleSheets.length;o++){var a=n.styleSheets[o],i=0,r=!1;do{if((r=a.cssRules?a.cssRules[i]:a.rules&&a.rules[i])&&r.selectorText&&r.selectorText.toLowerCase()==e)return"delete"==t?(a.cssRules?a.deleteRule(i):a.removeRule(i),!0):r;i++}while(r)}return!1},this.setCss=function(t,n){if(t&&n){var o=e.getCSSRule(t);if(o)if(e.isArray(n))for(var a=0;a<n.length;a++)n[a].value&&(o.style[n[a].attr]=n[a].value);else n.value&&(o.style[n.attr]=n.value)}},this.killCSSRule=function(e){return this.getCSSRule(e,"delete")},this.addCSSRule=function(e){return document.styleSheets&&(this.getCSSRule(e)||(document.styleSheets[0].addRule?document.styleSheets[0].addRule(e,null,0):document.styleSheets[0].insertRule(e+" { }",0))),this.getCSSRule(e)},this.getBackground=function(e,t){var n,o=[],a=parseInt(t||100)/100,i=(e||"rgb(255,255,255)").toLocaleLowerCase().trim();if(0==i.indexOf("rgb"))i=i.replace("rgb","rgba").replace(")",","+a+")");else if(0==i.indexOf("#")){for(i=i.replace("#","").split(""),n=0;n<i.length;n++)3==i.length?o.push(parseInt("0x"+i[n]+i[n])):n%2==0&&o.push(parseInt("0x"+i[n]+i[n+1]));o.push(a),i="rgba("+o.join()+")"}return i}},base64encode:function(e){var t,n,o,a,i,r,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(o=e.length,n=0,t="";n<o;){if(a=255&e.charCodeAt(n++),n==o){t+=s.charAt(a>>2),t+=s.charAt((3&a)<<4),t+="==";break}if(i=e.charCodeAt(n++),n==o){t+=s.charAt(a>>2),t+=s.charAt((3&a)<<4|(240&i)>>4),t+=s.charAt((15&i)<<2),t+="=";break}r=e.charCodeAt(n++),t+=s.charAt(a>>2),t+=s.charAt((3&a)<<4|(240&i)>>4),t+=s.charAt((15&i)<<2|(192&r)>>6),t+=s.charAt(63&r)}return t},checkHistoryTime:function(e){return(!f||e-f>55e3)&&(f=e,!0)},appendToListMsg:function(e,t){var n,o,a=document.createElement("ul"),i=_$("list_msg"),r=a.childNodes,s=0;if(a.innerHTML=e,t&&(n=_$("list_msg").childNodes[0]),n)for(s=r.length-1;o=r[s--];)1==o.nodeType&&(o=o.cloneNode(!0),i.insertBefore(o,n));else for(;o=r[s++];)1==o.nodeType&&(o=o.cloneNode(!0),i.appendChild(o));r=null,a=null},checkIpt:function(e,t,n,o){var a,r,s=!0,l=!1,c=i.default.validRule;if(1==e.nodeType?a=c[n]||c[e.type]:e.length>1&&e[0]&&(l=!0,e=e[0]),!t&&(e.className.indexOf("req")>-1||$(e).parents(".req").length)){s=!1;r="text"==e.type||"textarea"==e.type?lanRes.inputPlease.replace("${inputName}",e.getAttribute("lb")):lanRes.inputPleaseJa2.replace("${inputName}",l?$(e).parents(".entry2-typeline").attr("lb"):e.getAttribute("lb"))}else if(t&&a)if(a.length&&t.length>a.length){s=!1;r="age"==n?lanRes.ageOverLengthJa.replace("${age}",e.getAttribute("lb")):e.getAttribute("lb")+lanRes.overLength}else a.p&&!t.match(a.p)&&(s=!1,r=a.msg||lanRes.visitor170+e.getAttribute("lb"));return o?(o&&o(s),s&&e.style?this.hideTip():r&&this.showTip(r)):s&&e.style?(e.style.borderColor="#FFFFFF",this.hideTip()):(e.style.borderColor="#FF0000",r&&this.showTip(r)),s},HTMLDecode:function(e){var t,n=document.createElement("div");return null!=n.textContent?n.textContent=e:n.innerText=e,t=n.innerHTML,n=null,t}},m=null,g=!1,u.showToast=function(e,t){g||(g=!0,_$("toast")||$("body").append('<div class="toast" id="toast"><div class="toast-con" id="toast_con"></div></div>')),m&&clearTimeout(m),e&&(_$("toast_con").innerHTML=e),_$("toast").className="toast toast-type"+(t||""),m=setTimeout((function(){$("#toast").addClass("toast-hide")}),3e3)},u.hideToast=function(){m&&clearTimeout(m),$("#toast").addClass("toast-hide")},u.showTip=u.showToast,u.hideTip=u.hideToast,function(){var e=!1,t=u,n=t.clickName;function o(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}function a(){e=!0,$(".dialog-div").on(n,".dialog-cancel",(function(e){$(".dialog-div").remove(),t.publish("_dialogCanel"),o(e)})).on(n,".dialog-ok",(function(e){$(".dialog-div").remove(),t.publish("_dialogOk"),o(e)}))}u.showDialog=function(){var e,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=o.tip;function r(e){var o,a=$(".dialog-div").results,i=$(".dialog-ok").results[0],s=$(".dialog-cancel").results[0];0==a.length?$("body").off(n,r):(o=e.srcElement||e.target,setTimeout((function(){i==o||$.fn.contains(i,o)?(t.publish("_dialogOk"),$(".dialog-div").remove()):(s==o||$.fn.contains(s,o))&&(t.publish("_dialogCanel"),$(".dialog-div").remove())}),50))}$(".dialog-div").remove(),t.publish("_dialogCanel"),i&&(e='<div class="dialog-div dialog-hide""><div class="dialog-mask"></div><div class="dialog"><div class="dialog-title">'+lanRes.tip+'</div><div class="dialog-content">'+i+'</div><div class="dialog-btns">'+(!1!==o.cancel?'<a class="dialog-btn dialog-cancel bg0 has-fade"><span>'+lanRes.cancel+"</span></a>":"")+'<a class="dialog-btn dialog-ok bg0"><div class="bg0 fade-div"></div><span>'+(o.okTip||lanRes.okay)+"</span></a></div></div></div>",$(_$("index")||"body").append(e),t.unSubscribe(["_dialogOk","_dialogCanel"]),t.subscribe("_dialogOk",(function(){$("body").off(n,r),o.ok&&o.ok(),t.unSubscribe(["_dialogOk","_dialogCanel"])})),t.subscribe("_dialogCanel",(function(){$("body").off(n,r),o.cancel&&o.cancel(),t.unSubscribe(["_dialogOk","_dialogCanel"])})),setTimeout((function(){a(),$("body").on(n,r),$(".dialog-div").removeClass("dialog-hide")}),10),t.publish("inputBlur",{from:"dialog"}))},u.showAlertDialog=function(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};$(".dialog-div").remove(),!e&&a();var i,r=o.tip;function s(e){var o=$(".dialog-div").results,a=$(".dialog-ok").results[0];0==o.length?$("body").off(n,s):setTimeout((function(){(a==e.target||$.fn.contains(a,e.target))&&(t.publish("_dialogOk"),$(".dialog-div").remove())}),50)}r&&(i='<div class="dialog-div dialog dialog-hide"><div class="dialog-title">'+lanRes.tip+'</div><div class="dialog-content">'+r+'</div><div class="dialog-btns"><a class="dialog-btn dialog-ok bg0"><div class="bg0 fade-div"></div><span>'+(o.okTip||lanRes.okay)+"</span></a></div></div>",$("body").append(i),$("#mask").show(),t.unSubscribe("_dialogOk"),t.subscribe("_dialogOk",(function(){$("body").off(n,s),o.ok&&o.ok(),t.unSubscribe("_dialogOk"),$("#mask").hide()})),setTimeout((function(){$("body").on(n,s),$(".dialog-div").removeClass("dialog-hide")}),10))}}(),"undefined"==typeof console&&(window.console={log:function(e){}}),"function"!=typeof String.prototype.trim&&(String.prototype.trim=function(){return this.toString().replace(/(^\s+)|(\s+$)/g,"")}),Date.prototype.format=function(e){var t,n={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};for(t in/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))),n)new RegExp("("+t+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?n[t]:("00"+n[t]).substr((""+n[t]).length)));return e},Function.prototype.before=function(e){var t=this;return function(){return!1!==e.apply(this,arguments)&&t.apply(this,arguments)}},Function.prototype.after=function(e){var t=this;return function(){var n=t.apply(this,arguments);return!1!==n&&(e.apply(this,arguments),n)}},Function.prototype.afterFilter=function(e){var t=this;return function(){var n=t.apply(this,arguments);return!1!==n&&(arguments[arguments.length]=n,arguments.length+=1,e.apply(this,arguments))}},u.init.call(u),Object.assign(u,r.default),u.subscriber.call(u,"util"),u.setSub("util"),u.setSub("handle"),u.setSub("connect");t.default=u},42:function(e,t,n){"use strict";n(25),n(33),n(39),n(34),n(15),n(40),n(41),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(32),n(86),n(19);var o=n(4);function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var i,r={},s=1;function l(e){if("string"==typeof e)try{return JSON.parse(e)}catch(e){}return e}function c(e,t,n,o){try{var a={functionName:t,value:n||""};console.log(e,JSON.stringify(a)),o&&"function"==typeof o&&(a.callback="callbackview_"+s,r[a.callback]=function(){console.log("callbackview_***"+a.callback,arguments),o.apply(o,arguments),window[a.callback]=null},s++),window.EchatJsBridge?window.EchatJsBridge&&EchatJsBridge[e](JSON.stringify(a)):window.webkit&&window.webkit.messageHandlers[e].postMessage(JSON.stringify(a))}catch(e){}}t.default={initNativeAPI:function(e,t){window[t]||function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"callEchatJs";window[e]=function(t){try{console.log(e,JSON.stringify(t))}catch(e){}try{var n,s,c,u;if(!(n="string"==typeof t?JSON.parse(t+""):t))return console.log("****error callee****",arguments);if(c=l(n.value),s=n.functionName,c=n.value,!s||!r[s])return;if(i&&"forwardConfigMessage"!==s&&"forwardStaffInfo"!==s&&"nativeReady"!==s)if((0,o.isArray)(c)&&c[0]?u=c[0].companyId:"object"==a(c)&&(u=c),u&&i!=i)return;r[s](c)}catch(e){console.log(e)}}}(t),r=Object.assign(r,e)},callEchatNative:function(e,t,n){e&&("openUrl"==e&&(t.registerBridge||(t.registerBridge=7,t.isCanOtherHandle=1)),c("callEchatNative",e,t,n))},callEchatNativeConnect:function(e,t,n){e&&c("callEchatNativeConnect",e,t,n)},setCurrentCompanyId:function(e){i=e}}},45:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(63),n(69),n(3),n(71),n(50);t.default={talkTypeChat:1,talkTypeQueue:2,talkTypeLeave:3,talkTypeRobot:5,talkTypeWorkOrder:9,netConnected:2,websocketNotConnect:0,websocketConnecting:1,websocketConnected:2,websocketStoped:3,websocketReady:4,companyCommon:1,companyPlatform:2,companyShop:3,chatboxName:"sdkChatBoxInfo",chatboxRobotName:"robotSdkChatBox",contextPath:"/mychat/visitor",regFace:new RegExp("\ud83c[\udf00-\udfff]|\ud83d[\udc00-\ude4f]|\ud83d[\ude80-\udeff]|[#-®]|[‼-㊙]","g"),regEmo:new RegExp("\\[#[a-z0-9A-Z]+(_[a-z0-9A-Z]+)?#\\]","g"),regMail:/\b\w{1,30}([\.-]\w{1,30}){0,10}@\w{1,30}([\.-]\w{1,20}){0,10}(\.\w{1,20}){0,10}\b/g,regPhone:/([^\d]|\b)((\d{11})|((\d{7,8})|(\d{4}|\d{3})[\-\s](\d{7,8})|(\d{4}|\d{3})[\-\s](\d{7,8})[\-\s](\d{4}|\d{3}|\d{2}|\d{1})|(\d{7,8})[\-\s](\d{4}|\d{3}|\d{2}|\d{1})))(?=[^\d]|\b)/gi,regLink:/((http|ftp|https):\/\/)(([\w\._\-]+\.[a-zA-Z]{2,6})|([0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}))(:[0-9]{1,4})?(\/[\w,\&%_\!\*\(\)\'\;\:\@\=\+\.\/\[-~\-#\?]*)?/gi,iScrollParam:{preventDefault:!1,preventDefaultException:/^(A|PRE|INPUT|TEXTAREA|BUTTON|SELECT|LABEL)$/,tap:!1,click:!1,mouseWheel:!1,fadeScrollbars:!1},sendStatus:{error:0,success:1,notSend:2,sending:3},visitorEventTypes:{161:1,162:1,163:1,105:1,127:1,864:1,865:1,866:1,902:1},validRule:{email:{p:/^[\w\d_\-\.]+@.+[\.].+/gi,msg:lanRes.invildEmail,length:50},phone:{p:/^[0-9\-]{0,20}$/,msg:lanRes.invildPhone,length:20},age:{p:/^[1-9][\d]{0,2}$/gi,msg:lanRes.invildAge,length:3},qq:{p:/^[1-9][\d]+$/gi,msg:lanRes.invildQQ,length:50},date:{p:/^[\d]{4}[-\/][\d]{2}[-\/][\d]{1,2}/gi,msg:lanRes.invildDate,length:50},address:{length:255},name:{length:50},wechat:{length:50},nickName:{length:50},birthday:{length:20},content:{length:1e3},memo:{length:255},textarea:{length:500},text:{length:100},number:{p:/^\-?\d*$/,length:50}},ADParams:["companyId","visitorId","echatTag","lan","country","province","city","searcher","keyword","metaData","myData","referrer","firstUrl","chatPage","chatPageTitle","eventId","osName","staffId","staffName","staffPhoto","talkId","staffPhone","staffInfo"]}},55:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(54),n(35),n(26),n(15),n(3),n(22),n(11),n(21),n(30),n(31),n(245);var o=c(n(4)),a=c(n(8)),i=n(16),r=c(n(72)),s=n(178),l=c(n(269));function c(e){return e&&e.__esModule?e:{default:e}}var u,d=window._echat0;function f(){d.scrollToBottom=r.default.scrollToBottom}function p(e,t){var n,o=(0,i.getMsgDomId)(e),a=_$(o);if(!a)return!1;if(t)return t(a,e);if(!(n=(0,s.getMsgContent)(e,e,[""])))return!1;var r=$(".msg-item",a);r.length||(r=$(".info-con",a)),r.length&&n!=r.results[0].innerHTML?$(r).html(n):r.length||n==a.innerHTML||$(a).html(n);var l=h(e);return $(".msg-error",a).remove(),l&&$(".msg-con",a).append(l),!0}function h(e){var t=s.handleMap.getResendClass(e,e.et||e.mt);return t&&'<div class="msg-error '+t+'">&nbsp;</div>'}function m(e){var t=s.handleMap.file(e)||s.handleMap.location(e)?1:s.handleMap.img(e)||s.handleMap.video(e)?2:s.handleMap.voice(e)?3:0;return{itemCls:"clearfix msgli mode"+t+(t>1?" msg-medias":"")}}function g(e){return s.handleMap.staff[e.mt]||s.handleMap.sysToStaff(e)}function v(e,t){var n,r,l=e.mt||e.et,c=(0,i.getMsgDomId)(e);if(!s.handleMap.etmt[l])return!1;if(!t&&_$(c))return console.log("消息已经显示过了,走一下更新消息逻辑",e),161!=e.mt&&162!=e.mt&&163!=e.mt&&164!=e.mt||w(e),p(e),!1;if(n=['<li class="'],!(r=(0,s.getMsgContent)(e,n)))return!1;var u,d,f,v=s.handleMap.robotAnswer(e),y=s.handleMap.sysToRobot(e),b=s.handleMap.visitor[l]||s.handleMap.sysToVisitor(e),S=s.handleMap.sysMsg(e),T=g(e)||v||y,k=!1,I=e.tm||(new Date).getTime();return n=n.concat([m(e).itemCls,'" id="',c,'" >']),k=o.default.checkHistoryTime(I),T?d=function(e,t){var n=t?a.default.getRobotInfo():a.default.getStaff(e.chatStaffId||e.staffId);return{icon:'<div class="avatar-icon fl staff-icons"><img onerror="_echat0.imgError(this)" class="avatar-icon-img '+(t?"avatar-icon-robot":"avatar-icon-staff")+'" src="'+n.img+'"/></div>',name:e.chatStaffNickName||n.name}}(e,v||y):b?d={icon:'<div class="avatar-icon fr"><img onerror="_echat0.imgError(this)" class="avatar-icon-img avatar-icon-visitor" src="'+a.default.getVisitorImg()+'"/></div>'}:S||(k=!1),k&&!t&&n.push('<div class="time-line"><div class="color1 tc">'+new Date(I).format("hh:mm")+"</div></div> "),a.default.getConfig("showAvatar")&&d&&d.icon&&n.push(d.icon),T?(n.push('<div class="msg msg-lf fl">'),n.push('<div class="msg-staff-name">'),n.push(d.name),n.push('</div><div class="msg-con radius4 fl bg1">'),n.push('<i class="msg-angle colorbg1"></i>'),n.push('<div class="msg-item">'),f="</div></div></div>"):b?(u=h(e),n.push('<div class="msg msg-rt fr">'),n.push('<div class="msg-con radius4 fr bg3">'),n.push('<i class="msg-angle colorbg3"></i>'),u&&n.push(u),n.push('<div class="msg-item">'),f="</div></div></div>"):S&&(n[0]=n[0]+"tc ",n.push('<div class="msg-info radius4">'),n.push('<div class="info-con">'),f="</div></div>"),n.push(r),f&&n.push(f),n.push("</li>"),n}function y(e){e&&r.default.scrollKeepElement(e,document.getElementById("list_msg").offsetTop)}function b(e){d.scrollToBottom=function(){r.default.refreshChatScroll.apply(r.default,arguments),y(e)},r.default.refreshAndRemain(),y(e)}function S(e){return r.default.checkIsInBottom()||!r.default.chatScrollTouched||e&&e.bridgeMsgId&&e.sendStatus===o.default.Constants.sendStatus.sending}function T(e){e?(f(),r.default.scrollToBottom(50)):b()}function w(e){p(e,(function(e,t){var n=$(".msg-preview-info",e),o=(0,s.getSendProgess)(t),a=h(t);o?n?$(".msg-preview-progress",e).html((t.progress||0)+"%"):$(e).append(o):n.remove(),$(".msg-error",e).remove(),a&&$(".msg-con",e).append(a)}))}function k(e){(e=e?u.unreadNumBubble+e:0)?$("#unreadNumBubble").removeClass("hide").html(e>99?"99+":e):$("#unreadNumBubble").addClass("hide").html(""),u.unreadNumBubble=e}f(),o.default.subscribe("chatScrollInBottom",(function(e,t){f(),k(0)})),d.imgError=function(){var e=[];function t(e){var t="../common/img/alt1.png";return-1!=e.className.indexOf("avatar-icon-visitor")?t="../common/img/visitor.jpg":-1!=e.className.indexOf("avatar-icon-robot")?t="../common/img/robot.jpg":-1!=e.className.indexOf("avatar-icon-staff")&&(t="../common/img/staff.jpg"),e.src=t,t}return o.default.subscribe("changeNetStatus",(function(t,n){if(n){var o,a,i="";for(a=0;a<e.length;a++)i=e[a].src,e[a].img.src="",e[a].img.src=i;o=e[a-1].img,e=[],r.default.scrollToBottom(500),o&&$(o).on("load",(function e(){r.default.scrollToBottom(500),$(o).off("load",e)}))}})),function(n,o){if(!n.src||n.src.match(/^http/)){var i,r;e.push({src:n.src,defaultBg:t(n),img:n})}else{var s=(i=$(n).parents(".msgli").attr("id"),(r=a.default.getMsgFromHistory(i))&&r.msg);s&&(s.smallImg||s.remoteThumbnaiLPath)&&(n.src=s.smallImg||s.remoteThumbnaiLPath)}}}(),$("#unreadNumBubble").on("click",(function(){r.default.scrollToBottom()})),u={unreadNumBubble:0,showMsg:function e(t){var n=v(t);if(n){var r=a.default.getDataByName("historyLastEchatId"),s=r&&a.default.getMsgFromHistory(r);if(s&&t.allExtra&&t.allExtra.mid&&t.allExtra.mid<s.originData.mid)o.default.appendToListMsg(n.join(""),!0),b((0,i.getMsgDomId)(s.msg));else{var l=S(t);o.default.appendToListMsg(n.join("")),l||t.allExtra&&t.allExtra.echatId&&0==t.isForward&&k(1),T(l)}"restartChat"!=t.id&&$(".btn-restart").length&&$("#restartChat").length&&($("#restartChat").remove(),e({id:"restartChat",mt:20,tm:(new Date).getTime(),content:'<span class="btn-restart">'+lanRes.toContinueChat+"</span>"}))}},updateMsg:p,checkNeedScrollToBottom:S,switchScrollToBottom:T,updateMsgRender:function(e,t){var n=_$(e);return!!n&&($(".render-msg",n).results[0].innerHTML=t,!0)},replaceMsg:function(e){var t,n,o,a,r=(0,i.getMsgDomId)(e),s=_$(r);return!!s&&(!!(o=v(e,!0))&&(t=(o=o.join("")).match(/class="([^"]+)"/)[1],a=o.replace(/^<li[^>]+>/,"").replace(/<\/li>$/,""),(n=$(".time-line",s)).length&&(a='<div class="time-line">'+(n=n.results[0].innerHTML)+"</div>"+a),s.className=t,s.innerHTML=a,!0))},removeMsg:function(e){var t=(0,i.getMsgDomId)(e),n=_$(t);n&&($(n).remove(),r.default.refreshChatScroll())},removeMsgAndSiblings:function(e){var t,n=_$((0,i.getMsgDomId)(e));if(!n)return!1;for(;t=n;)n=t.nextElementSibling,$(t).remove();return r.default.refreshChatScroll(),!0},removeAllMsg:function(){return $(".msgli",_$("list_msg")).remove(),!0},getMsgDomId:i.getMsgDomId,updateMsgProgress:w,updateMsgStaff:function(){a.default.getMsgList.forEach((function(e){p(e.data,(function(e,t){if(g(t)){var n=t.chatStaffId||t.staffId,o=a.default.getStaff(n),i=$(".avatar-icon-img",e).attr("src"),r=$(".msg-staff-name",e).text();i!=o.img&&$(".avatar-icon-img",e).attr("src",o.img),r!=o.name&&$(".msg-staff-name",e).text(o.name)}}))}))}},(0,s.init)(p),l.default.init(u);t.default=u},72:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(10);var o,a=s(n(246)),i=s(n(4)),r=n(16);function s(e){return e&&e.__esModule?e:{default:e}}function l(e){o.chatScrollTouched=!0,o.checkIsInBottom()&&i.default.publish("chatScrollInBottom")}function c(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"content";if(!o[e]){if(!i.default.Browser.isIOS||i.default.Browser.osVersion<14)return $("#"+t).css("overflow","hidden"),void(o[e]=new a.default("#"+t,{zoom:!1,click:!0,movable:!1,tap:"",bounceTime:300,disableTouch:!1,preventDefault:!1,preventDefaultException:/^(A|PRE|INPUT|TEXTAREA|BUTTON|SELECT|LABEL)$/}));document.addEventListener("touchmove",(function(e){return e.stopPropagation(),e.preventDefault(),!1}),!1),_$(t).style.overflowY="auto";var n=$("#"+t),r=$("#"+t).on.bind(n),s=$("#"+t).off.bind(n),l={scrollTo:function(e,n,o){_$(t).scrollTo(e,-n)},refresh:function(){},on:r,off:s};Object.defineProperty(l,"maxScrollY",{enumerable:!1,configurable:!1,get:function(){return-_$(t).scrollHeight+_$(t).clientHeight}}),Object.defineProperty(l,"y",{enumerable:!1,configurable:!1,get:function(){return-_$(t).scrollTop}}),o[e]=l}}o={init:function(){c("chatScroll","content");var e=o.chatScroll;e.options?e.on("scrollEnd",l):(e.on("touchmove scroll",(0,r.throttle)(l,50)),e.on("touchend",(function(){setTimeout((function(){l()}),1e3)})))},initScroll:c,chatScroll:void 0,chatScrollTouched:!1,refreshChatScroll:function(){var e=o.chatScroll;e&&e.refresh()},scrollToElement:function(e,t){var n=o.chatScroll;n&&document.getElementById(e)&&(n.refresh(),setTimeout((function(){var t=document.getElementById(e),n=o.chatScroll,a=t.offsetTop,i=t.offsetHeight,r=document.getElementById("content").clientHeight,s=-n.y;n.refresh(),a>s&&s+r>a+i||n.scrollTo(0,-t.offsetTop+(r-i-20),!0)}),t||0))},scrollToBottom:function(e){var t=o.chatScroll;t&&(t.refresh(),setTimeout(o.imemediateToBottom,e||0))},scrollKeepElement:function(e,t){var n=document.getElementById(e+"");if(n){var a=o.chatScroll;a.refresh();var i=n.offsetTop,r=document.getElementById("content").clientHeight,s=-a.y,l=-a.maxScrollY,c=i-t;c!==s&&(r>=l||a.scrollTo(0,-c,!0))}},refreshAndRemain:function(){var e=o.chatScroll;e&&(e.refresh(),e.y!==e.maxScrollY||o.imemediateToBottom())},imemediateToBottom:(0,r.throttle)((function(){var e=o.chatScroll;e.refresh(),e.scrollTo(0,e.maxScrollY,!0),i.default.publish("chatScrollInBottom")}),30),checkIsInBottom:function(){var e=o.chatScroll;if(e){var t=e.maxScrollY,n=e.y;return t>=n||-t+n<25||void 0}}},window.Scroll=o;t.default=o},8:function(e,t,n){"use strict";n(25),n(33),n(39),n(60),n(34),n(61),n(52),n(62),n(40),n(128),n(30),n(31),n(41),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n(54),n(51),n(88),n(32),n(44),n(86),n(19),n(15),n(3),n(22),n(11),n(122),n(21),n(53);var o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=c(e)&&"function"!=typeof e)return{default:e};var n=r(t);if(n&&n.has(e))return n.get(e);var o={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&{}.hasOwnProperty.call(e,i)){var s=a?Object.getOwnPropertyDescriptor(e,i):null;s&&(s.get||s.set)?Object.defineProperty(o,i,s):o[i]=e[i]}return o.default=e,n&&n.set(e,o),o}(n(4)),a=i(n(45));function i(e){return e&&e.__esModule?e:{default:e}}function r(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(r=function(e){return e?n:t})(e)}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=c(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=c(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==c(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var d,f,p,h=i(n(42)).default.callEchatNativeConnect,m=0,g=(new Date).getTime()+"",v={configs:{locationBase:(p=o.default.getQueryParams(location.search).dataHost,p?p.replace(/^(http[s]?:\/\/)([^\.]+)\./,"$1$2s."):"https://chats.rainbowred.com"),config600:{},config649:{data:{bin:2,binDefine:2,canChatNow:1,chatStatus:0,companyId:521704,echatSourceTagEnable:"0",enableEchatHyperlink:"1",enableEchatUrl:"1",eventId:"f2hlYgzfitI=",media:"6",mid:323439,mst:3,mt:"649",notThroughStatus:0,queueTxt:"亲，目前客服全忙，您正排在队列的第${waitcount}位，请稍候……",routeId:"469",rph:0,sdkChatBoxInfo:{busyNotAllowSendStatus:"0",busyNotAllowTips:"当前客服忙碌，请等待客服接入后发送聊天消息。",chatAd1Html:"https://chats.rainbowred.com/res/style/default/s2/chat_right.png",chatAdWidth:"349",chatBoxAdHeight:"0",chatBoxAdImgLinkFixed:"1",chatBoxAdImgLinkOpenType:"1",chatBoxInnerAdType:"3",chatBoxRightAdImg:"https://chats.rainbowred.com/res/style/default/s2/chat_right.png",chatBoxRightAdType:"3",chatBoxStaffImgEnable:"1",chatBoxTitle:"Echat对话",chatColor:"#ffa726",chatEndBtnBackColor:"#484a4a",chatEndBtnTxtColor:"#3bc47a",chatLogoImg:"https://chats.rainbowred.com/res/style/default/s2/pc_logo.png",chatStaffBackColor:"#ffffff",chatStaffTxtColor:"#323232",chatThemeBackColor:"#ffa726",chatThemeTxtColor:"#ffffff",chatVisitorBackColor:"#ffa726",chatVisitorTxtColor:"#ffffff",customUrlList:'[{"type":2,"openType":1,"msgContent":"????","title":"问号消息"},{"type":"1","openType":2,"title":"图文自定义打开","icon":"","url":"app://visevtDemo","openWindowParamList":[{"paramName":"companyId"}]},{"type":"1","openType":2,"title":"App跳转界面","icon":"","url":"app://activity","openWindowParamList":[]}]',defaultStaffImg:"https://chats.rainbowred.com/res/imgs/staff.png",defaultVisitorImg:"https://chats.rainbowred.com/res/style/default/s2/visitor.png",enableChatEndBtn:"1",enableQRCode:"1",evaluateThemeColor:"#ffb545",qrCodeType:"1",styleId:"376",sysMsgBackground:"#c6c6c6",sysMsgFontColor:"#ffffff",sysMsgIcon:"https://chats.rainbowred.com/res/imgs/sysinfo.png",toolAlbum:"1",toolCamera:"1",toolEmoji:"1",toolFile:"1",toolImg:"1",toolLocation:"1",toolSatisfaction:"1",toolScreenshot:"1",toolTelephone:"1",toolLog:"1",toolVoice:"1",type:"6",windowTextColor:"#888888",windowThemeBackColor:"#eeeeee"},sdkEntranceInfo:{buttonBackgroundColor:"rgb(59, 196, 122)",captChaEnable:"0",captChaName:"chatWindow",captChaType:"0",enableOffline:"0",enableOnline:"0",entranceLevel:1,lan:"default",nonce:"HkYjsxUgVD",offlineButtonBackgroundColor:"rgb(59, 196, 122)",offlineNotVipItemSize:0,offlineStartType:"1",offlineVipItemSize:0,onlineNotVipItemSize:0,onlineVipItemSize:0,requireCondition:"0",styleId:"376",token:"54639d9e50dd507c150d30b065956d5b8dc8109c",type:"6",upgradeOfflineNotVipItemSize:3,upgradeOfflineVipItemSize:0,upgradeOnlineNotVipItemSize:0,upgradeOnlineVipItemSize:0,version:1,visitorInfoEnable:"0"},sdkEvaluateInfo:{allowEvaluateBaseWords:"1",bestDesc:"非常满意",bestDescDefault:"非常满意",bestEnable:"1",bestSelected:"https://chats.rainbowred.com/config/res/img/evaluate/bestSelected.png",bestUnSelected:"https://chats.rainbowred.com/config/res/img/evaluate/bestUnSelected.png",betterDesc:"满意",betterDescDefault:"满意",betterEnable:"1",betterSelected:"https://chats.rainbowred.com/config/res/img/evaluate/betterSelected.png",betterUnSelected:"https://chats.rainbowred.com/config/res/img/evaluate/betterUnSelected.png",commonDesc:"一般",commonDescDefault:"一般",commonEnable:"1",commonSelected:"https://chats.rainbowred.com/config/res/img/evaluate/commonSelected.png",commonUnSelected:"https://chats.rainbowred.com/config/res/img/evaluate/commonUnSelected.png",enable:"1",enableRepeatedEvaluate:"1",enableRepeatedEvaluateTimeLimit:"0",enableValidEvaluateTime:"1",enableVisitorEvaluateLimit:"1",evaluatePicURL:"http://chats.rainbowred.com/weixin/evaluate/weChatEval.html",evaluateType:"0",lan:"default",styleId:"376",type:"6",validEvaluateTime:"120",validRepeatedEvaluateTime:"30",worseDesc:"不满意",worseDescDefault:"不满意",worseEnable:"1",worseSelected:"https://chats.rainbowred.com/config/res/img/evaluate/worseSelected.png",worseUnSelected:"https://chats.rainbowred.com/config/res/img/evaluate/worseUnSelected.png",worstDesc:"非常不满意",worstDescDefault:"非常不满意",worstEnable:"1",worstSelected:"https://chats.rainbowred.com/config/res/img/evaluate/worstSelected.png",worstUnSelected:"https://chats.rainbowred.com/config/res/img/evaluate/worstUnSelected.png"},status:1},isForward:1,isPublic:0,mt:"649"},companyVersionType:a.default.companyCommon,isVip:!1,busyCanSend:!0,showAvatar:!0,enableStreamingRendering:!1,enableInputAssociate:!1,inputMaxLength:2e3,maxRobotLength:100,pageTitle:"",customListConfig:"",urlListConfig:""},staffInfo:u({0:{}},"0",{}),msgList:[],nativeH5Data:{satisfyLastTalkId:""},statusData:{fisrtChatstatus:-1,canChatNow:0,chatStatus:0,statusName:"",status:0,talkType:0,unreadCount:0,sendMsgNum:0,hasSatisfy:!1,currentProcess:0,lastMsgTM:0,lasMid:0,isInWorkOrder:!1,isInEntryOrCode:!1,visitorClose:!1,visitorEntryInput:{},captChaToken:void 0},visitorInfo:(f=o.default.getQueryParams(location.search),f.companyId=Number(f.companyId),f.fm=(0,o.checkFirstMsg)(f.fm)||void 0,f),otherData:{emoCodeTolan:{},emoLanToCode:{},emoMap:null,netConnected:!0,websocketStatus:2,hasPreHistory:!0,historyLastEchatId:0,doms:{unread:[{name:"#leaveBar",removeCls:"hide",config:function(e){var t=v.statusData;t.isInWorkOrder?$("#leaveBar").html(lanRes.visitor186):2==t.status?$("#leaveBar").html(lanRes.leaveToLeaveBtn):$("#leaveBar").html(lanRes.leaveToChatBtn)}},{name:"#chatText",cls:"hide"}],queue:[{name:"html",removeCls:["entry2","page-leave"]},{name:"body",removeCls:["robot","entry2","page-leave"]},{name:"#leaveBar",cls:"hide"},{name:"#chatText",removeCls:"hide"},{name:"#textInput",attr:{placeholder:""},isHtml:!0,config:function(e){e.attr.placeholder=lanRes.inputPlaceholder2}},{name:"#robotToStaff",cls:"hide"},{name:".robot-staff",removeCls:["robot-staff"],show:!1},{name:".menu-emo",cls:"hide"},{name:".record-switch",cls:"hide"},{name:".tool-menu-item",cls:"hide"},{name:".url-list-item",cls:"hide"},{name:"#busyTipLine",cls:"hide",config:function(e){var t=d.getChatbox();t.busyNotAllowTips&&$("#busyTip").html(t.busyNotAllowTips)}},{name:"#inputSuggest",cls:"hide"},{name:"#inputLengthTip",cls:"hide"},{name:"#entry",cls:"hide"},{name:"#verify",cls:"hide"}],staff:[{name:"html",removeCls:["entry2","page-leave"]},{name:"body",removeCls:["robot","entry2","page-leave"]},{name:"#leaveBar",cls:"hide"},{name:"#chatText",removeCls:"hide"},{name:"#textInput",attr:{placeholder:""},isHtml:!0,config:function(e){e.attr.placeholder=lanRes.inputPlaceholder2}},{name:"#robotToStaff",cls:"hide"},{name:".robot-staff",removeCls:["robot-staff"],show:!1},{name:".menu-emo",removeCls:"hide"},{name:".record-switch",removeCls:"hide"},{name:".tool-menu-item",removeCls:"hide"},{name:".url-list-item",removeCls:"hide"},{name:"#busyTipLine",cls:"hide"},{name:"#inputSuggest",cls:"hide"},{name:"#inputLengthTip",cls:"hide"},{name:"#entry",cls:"hide"},{name:"#verify",cls:"hide"}],leave:[{name:"html",removeCls:["entry2","page-leave"]},{name:"body",removeCls:["robot","entry2","page-leave"]},{name:"#leaveBar",cls:"hide"},{name:"#chatText",removeCls:"hide"},{name:"#textInput",attr:{placeholder:""},isHtml:!0,config:function(e){e.attr.placeholder=lanRes.inputPlaceholder2}},{name:"#robotToStaff",cls:"hide"},{name:".robot-staff",removeCls:["robot-staff"],show:!1},{name:".menu-emo",removeCls:"hide"},{name:".record-switch",removeCls:"hide"},{name:".tool-menu-item",removeCls:"hide"},{name:".url-list-item",removeCls:"hide"},{name:".menu-satisfy",cls:"hide"},{name:".menu-phone",cls:"hide"},{name:"#busyTipLine",cls:"hide"},{name:"#inputSuggest",cls:"hide"},{name:"#inputLengthTip",cls:"hide"},{name:"#entry",cls:"hide"},{name:"#verify",cls:"hide"}],robot:[{name:"html",removeCls:["entry2","page-leave"]},{name:"body",cls:"robot"},{name:"#leaveBar",cls:"hide"},{name:"#chatText",removeCls:"hide"},{name:"#textInput",attr:{placeholder:""},isHtml:!1,config:function(e){var t=v.configs.config649;e.attr.placeholder=t.robotWordsInfo.inputBoxWords||lanRes.inputPlaceholder2}},{name:"#robotToStaff",config:function(){var e=v.configs.config649,t=v.statusData,n=d.getConfig("isVip")?e.sdkVipVisitorRobotConfig||e.webVipVisitorRobotConfig:e.sdkVisitorRobotConfig||e.webVisitorRobotConfig;1==t.status?$("#robotToStaffWord").html(e.robotWordsInfo.onlineButtonWords||lanRes.robotToStaff):$("#robotToStaffWord").html(e.robotWordsInfo.offlineButtonWords||lanRes.robotToStaff),$("#toHumanWords").html(e.robotWordsInfo.toHumanWords||""),"1"!=n.enableManualSwitch?$("#robotToStaff").addClass("limit-hide"):("1"==n.enableLeaveBtnWhenStaffOffline&&2==t.status||"1"==n.enableSwitchBtnWhenStaffOnline&&2!=t.status)&&$("#robotToStaff").removeClass("hide")}},{name:".robot-staff",show:!0},{name:".menu-emo",cls:"hide"},{name:".record-switch",cls:"hide"},{name:".tool-menu-item",cls:"hide"},{name:".url-list-item",removeCls:"hide"},{name:"#busyTipLine",cls:"hide"},{name:"#inputSuggest",cls:"hide"},{name:"#inputLengthTip",cls:"hide"},{name:"#entry",cls:"hide"},{name:"#verify",cls:"hide"}],reset:[{name:"html",removeCls:["entry2","page-leave"]},{name:"body",removeCls:["robot","entry2","page-leave"]},{name:"#leaveBar",cls:"hide"},{name:"#chatText",removeCls:["hide","recording"]},{name:"#textInput",attr:{placeholder:""},isHtml:!0,config:function(e){e.attr.placeholder=lanRes.inputPlaceholder2}},{name:"#robotToStaff",cls:"hide"},{name:".robot-staff",removeCls:["robot-staff"],show:!1},{name:".menu-emo",cls:"hide"},{name:".record-switch",cls:"hide"},{name:".tool-menu-item",cls:"hide"},{name:".url-list-item",cls:"hide"},{name:"#busyTipLine",cls:"hide"},{name:"#inputSuggest",cls:"hide"},{name:"#inputLengthTip",cls:"hide"},{name:"#entry",cls:"hide"},{name:"#verify",cls:"hide"}]}}};window.DataObject=v,window.Util=o.default,d={setConfig:function(e,t){var n=v.configs[e];n&&"object"==c(n)?v.configs[e]=Object.assign(n,t):v.configs[e]=t},setConfigs:function(e){var t,n;for(n in e)(t=v.configs[n])&&"object"==c(t)?v.configs[n]=Object.assign(t,e[n]):v.configs[n]=e[n]},getConfig:function(e){return v.configs[e]},getDataByName:function(e){return v.otherData[e]},setDataByName:function(e,t){v.otherData[e]=t},getVisitorInfo:function(e){return e?v.visitorInfo[e]:v.visitorInfo},setVisitorInfo:function(e){Object.assign(v.visitorInfo,e)},getStaffInfo:function(){return v.staffInfo},setStaffInfo:function(e){Object.assign(v.staffInfo,e)},setNativeH5Data:function(e,t){"object"==c(e)?(v.nativeH5Data=Object.assign({},e),t&&h("setH5Data",JSON.stringify(v.nativeH5Data))):console.log("setNativeH5Data","数据格式不对",e)},updateNativeH5DataByKey:function(e,t){v.nativeH5Data[e]=t,h("setH5Data",JSON.stringify(v.nativeH5Data))},getNativeH5Data:function(){returnObject.assign({},v.nativeH5Data)},getNativeH5DataByKey:function(e){return v.nativeH5Data[e]},getMsgList:function(){return v.msgList},getMsgListFirst:function(){var e=v.msgList[0];return e&&e.echatId?e:null},getMsgByFilter:function(e){return v.msgList.filter(e)},updateMsgList:function(e,t){t=t||"push";var n=o.default.isArray(e)?e.concat([]):[e];if("remove"!=t)for(var i=0;i<n.length;i++)n[i].echatId||n[i].bridgeMsgId&&n[i].sendStatus==a.default.sendStatus.sending||(n.splice(i,1),i--);if("replace"===t)v.msgList=n;else if("push"==t&&n.length)v.msgList=v.msgList.concat(n);else{if("remove"==t){var r=d.getMsgFromHistory(e.id);return r&&v.msgList.splice(r.index,1),r}"unshift"==t&&n.length&&(v.msgList=n.concat(v.msgList))}},clearMsgList:function(e){v.msgList[e]&&v.msgList.splice(e)},getStatusData:function(){return v.statusData},getStatusByKey:function(e){return v.statusData[e]},setStatusByKey:function(e,t){return v.statusData[e]=t},setStatusData:function(e){Object.assign(v.statusData,e)},getChatbox:function(){var e,t=v.statusData,n=t.chatStatus,o=t.talkType==a.default.talkTypeRobot,i=v.configs.config649;return 2==n&&o&&(e=i[a.default.chatboxRobotName]||i.robotPhoneChatBox),e||(e=i[a.default.chatboxName]||i.robotSdkChatBox),o&&e&&e.toolLog&&(e.toolLog=0),e},getStaff:function(e){e=e||v.statusData.staffId;var t=v.staffInfo[e]||{},n=v.configs.config649,i=n[a.default.chatboxName]||n[a.default.chatboxRobotName]||{};return v.staffInfo[e]||o.default.publish("sendMessage",{et:153,companyId:v.visitorInfo.companyId,staffIds:e+""}),{staffId:e,phone:t.staffPhone,img:t.staffHead||i.defaultStaffImg,name:t.staffNickName||lanRes.serviceStaff}},getVisitorImg:function(){var e=d.getChatbox();return v.configs.config600.photo||e.defaultVisitorImg},getRobotInfo:function(){var e=v.configs.config649,t=e.robotConfigInfo,n=e.robotExtInfo,o=e[a.default.chatboxRobotName];return t&&t.hasRobotDefImg&&(t.robotImg=o&&o.defaultStaffImg),{img:t&&t.robotImg||o&&o.defaultStaffImg,name:n&&n.nickName||""}},formatRouteList:function(){var e,t,n,o,a,i,r=v.configs.config695.routeEntranceInfo||v.configs.config695.routeEntranceInfoString,s=0,l={};if("string"==typeof r&&(r=JSON.parse(r),v.configs.config695.routeEntranceInfo=r),r&&2==r.routeEntranceType)return r;if(a="string"==typeof r.entranceDetails?JSON.parse(r.entranceDetails):r.entranceDetails,(i=r.routeStatusList)&&i.length)for(t=0;t<i.length;t++)l[i[t].routeId]=2!=i[t].routeStatus;for(e=0;e<a.length;e++)(o=a[e].routeId)&&(n=a[e],s++,l[o]?n.icon||(n.icon=n.offlineIcon):(n.icon=n.offlineIcon||n.icon,n.content=n.offlineContent||n.content));return!!s&&(r.entranceDetails=a,r)},getEntryInfo:function(e){var t;if(e=e||v.configs.config649,0==v.statusData.canChatNow)return(t=e.entranceInfo=e.entranceInfo||e.sdkEntranceInfo||e.mobileEntranceInfo)&&1==t.visitorInfoEnable&&(2!=v.statusData.status?1==t.enableOnline:1==t.enableOffline)&&t},getLeaveConfig:function(e){return(e=e||v.configs.config649).offlineBoxInfo||e.offlineSmallBoxInfo||e.mobileOfflineBoxInfo||e.sdkOfflineBoxInfo},getEvaluateAndLimit:function(){var e=v.configs.config649,t={limit:0,enable:!1,config:null},n=e.sdkEvaluateInfo||e.evaluateInfo||e.smallEvaluateInfo||e.mobileEvaluateInfo;return n?(t.enable="1"==n.enable,t.config=n,"1"==n.enableVisitorEvaluateLimit&&(t.limit=parseInt(n.allowEvaluateBaseWords||0)),t):t},checkMatchId:function(e,t){if(!t||!e)return!1;var n=e.data||e;return n.clientFileId==t||n.identityKey==t||n.fileIdentity==t||e.echatId==t||n.mid==t||n.id==t||n.bridgeMsgId==t||e.et&&e.id==t},getMsgFromHistory:function(e){var t,n,o,a=d.getMsgList();for(o=0;o<a.length;o++)if(d.checkMatchId(a[o],e)){t=a[o],n=o;break}return t?{index:n,msg:t.data||t,originData:t}:null},updateHistoryMsgExt:function(e,t,n){if(e&&t){var o,a=d.getMsgFromHistory(e);if(!a)return!1;(o=a.msg).allExtra?o.allExtra.h5Extra||(o.allExtra.h5Extra={}):o.allExtra={h5Extra:{}},o.allExtra.h5Extra[t]=n}},updateHistoryMsgNativeExt:function(e,t,n){if(e&&t){var o,a=d.getMsgFromHistory(e);if(!a)return!1;(o=a.msg).allExtra?o.allExtra.nativeExtra||(o.allExtra.nativeExtra={}):o.allExtra={nativeExtra:{}},o.allExtra.nativeExtra[t]=n}},updateMsgByIndetity:function(e,t){if(t&&e){var n=d.getMsgFromHistory(e);return!!n&&Object.assign(n.msg,t)}},getStatusConfig:function(e){var t=v.statusData,n=v.configs.config649;return 2!=t.chatStatus?void 0:t.talkType==a.default.talkTypeRobot?n.robotSdkChatBox:n.sdkChatBoxInfo},getApiDomain:function(){var e=v.visitorInfo;return e.apiServerDomain?"https://"+e.apiServerDomain:e.dataHost},getNextBridgeMsgId:function(){return g+ ++m}},function(){for(var e in d)e.match(/^get/)&&"getDataByName"!=e&&(d[e]=d[e].afterFilter((function(){var e=arguments[arguments.length-1];return"object"==c(e)&&e?o.default.isArray(e)?[].concat(e):l({},e):e})))}(),window.DataService=d;t.default=d}});